
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bare metal WAF &#8212; pydagogue 0.2 documentation</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/traditional.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Windows DLLs - information" href="windows_dll_links.html" />
    <link rel="prev" title="Developing on linux" href="develop_linux.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="windows_dll_links.html" title="Windows DLLs - information"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="develop_linux.html" title="Developing on linux"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pydagogue 0.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="computing.html" accesskey="U">General computing</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Bare metal WAF</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="bare-metal-waf">
<h1>Bare metal WAF<a class="headerlink" href="#bare-metal-waf" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="http://code.google.com/waf">waf</a> is a configure / build / install system.</p>
<p>It can do the jobs of <code class="docutils literal notranslate"><span class="pre">autotools</span></code> and <code class="docutils literal notranslate"><span class="pre">make</span></code>, so instead of typing (say):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">configure</span>
<span class="n">make</span>
<span class="n">make</span> <span class="n">install</span>
</pre></div>
</div>
<p>you can type (say):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">waf</span> <span class="n">configure</span>
<span class="o">./</span><span class="n">waf</span> <span class="n">build</span>
<span class="o">./</span><span class="n">waf</span> <span class="n">install</span>
</pre></div>
</div>
<p>You don’t need <code class="docutils literal notranslate"><span class="pre">autotools</span></code> or <code class="docutils literal notranslate"><span class="pre">make</span></code> installed.  The full <code class="docutils literal notranslate"><span class="pre">waf</span></code> binary is
90K and usually sits in your source code repository.</p>
<p>waf uses a Python configuration file so you can use Python code to define your
configure, build and install rules rather than the obscure <code class="docutils literal notranslate"><span class="pre">make</span></code> syntax and
funny variable names.</p>
<p>Among other projects, SAMBA uses waf for its entire configure / build / install system.</p>
<p>There is a comprehensive waf manual.</p>
<p>What’s the downside?  The waf build system (like - say - <code class="docutils literal notranslate"><span class="pre">make</span></code>) works at a
fairly high and abstract level, so it can be hard to understand the flow of
control.  It can sometimes be hard to find the part of waf that you want.</p>
<p>This page has notes to myself about how waf works.</p>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The heart of the waf process is of course the build.</p>
<p>We’re likely going to do this to build our project:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">waf</span> <span class="n">configure</span>
<span class="o">./</span><span class="n">waf</span> <span class="n">build</span>
</pre></div>
</div>
<p>We use the configure step to check for dependencies and set up any variables we
need to define for the build step.</p>
<p>The build step receives the result of the configure step, and sets up build
rules.  The build rules form a directed acyclic graph.  At the end of the build
step waf will execute the build steps using the dependency information from the
DAG to execute the build steps in an efficient order.</p>
</div>
<div class="section" id="a-taster">
<h2>A taster<a class="headerlink" href="#a-taster" title="Permalink to this headline">¶</a></h2>
<p>Let’s say you have a project <code class="docutils literal notranslate"><span class="pre">myproject</span></code>.  It’s a directory called
<code class="docutils literal notranslate"><span class="pre">myproject</span></code>.  It has a single C file <code class="docutils literal notranslate"><span class="pre">myprogram.c</span></code>.</p>
<p>Download the <code class="docutils literal notranslate"><span class="pre">waf</span></code> binary to the <code class="docutils literal notranslate"><span class="pre">myproject</span></code> from the <a class="reference external" href="http://code.google.com/waf">waf</a> site.</p>
<p>You invoke waf thus:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">myproject</span>
<span class="o">./</span><span class="n">waf</span>
</pre></div>
</div>
<p>and you’ll get this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Waf</span><span class="p">:</span> <span class="n">Run</span> <span class="kn">from</span> <span class="nn">a</span> <span class="n">directory</span> <span class="n">containing</span> <span class="n">a</span> <span class="n">file</span> <span class="n">named</span> <span class="s1">&#39;wscript&#39;</span>
</pre></div>
</div>
<ul class="simple">
<li><p>the <code class="docutils literal notranslate"><span class="pre">waf</span></code> program loads a configuration file called <code class="docutils literal notranslate"><span class="pre">wscript</span></code></p></li>
</ul>
<p>waf loads the wscript file, and executes the code inside in order to do stuff.</p>
<p>Let’s pretend our project creates a file called <code class="docutils literal notranslate"><span class="pre">foo</span></code> and then copies it to
<code class="docutils literal notranslate"><span class="pre">bar</span></code>.  The wscript might look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># the whole wscript</span>
<span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="n">conf_ctx</span><span class="p">):</span>
    <span class="c1"># Check we have &#39;touch&#39;</span>
    <span class="n">conf_ctx</span><span class="o">.</span><span class="n">find_program</span><span class="p">(</span><span class="s1">&#39;touch&#39;</span><span class="p">,</span> <span class="n">VAR</span><span class="o">=</span><span class="s1">&#39;TOUCH&#39;</span><span class="p">)</span>
    <span class="c1"># And &#39;cp&#39;</span>
    <span class="n">conf_ctx</span><span class="o">.</span><span class="n">find_program</span><span class="p">(</span><span class="s1">&#39;cp&#39;</span><span class="p">,</span> <span class="n">VAR</span><span class="o">=</span><span class="s1">&#39;CP&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="n">build_ctx</span><span class="p">):</span>
    <span class="c1"># Touch foo</span>
    <span class="n">build_ctx</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="s1">&#39;$</span><span class="si">{TOUCH}</span><span class="s1"> $</span><span class="si">{TGT}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
    <span class="c1"># Copy foo to bar</span>
    <span class="n">build_ctx</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="s1">&#39;$</span><span class="si">{CP}</span><span class="s1"> $</span><span class="si">{SRC}</span><span class="s1"> $</span><span class="si">{TGT}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We run the checks with <code class="docutils literal notranslate"><span class="pre">./waf</span> <span class="pre">configure</span></code>, and the build with <code class="docutils literal notranslate"><span class="pre">./waf</span> <span class="pre">build</span></code>.</p>
<p>It isn’t easy to see exactly how this works, and rest of this page will try to
do that.</p>
</div>
<div class="section" id="waf-commands">
<h2>waf commands<a class="headerlink" href="#waf-commands" title="Permalink to this headline">¶</a></h2>
<p>You execute a waf command with <code class="docutils literal notranslate"><span class="pre">.waf</span> <span class="pre">command-name</span> <span class="pre">[options]</span></code></p>
<p>You can define any command you like with something like this in the wscript
file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># the whole wscript file</span>
<span class="k">def</span> <span class="nf">mycommand</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;hello&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>and:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">waf</span> <span class="n">mycommand</span>
</pre></div>
</div>
<p>giving:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hello</span>
<span class="s1">&#39;mycommand&#39;</span> <span class="n">finished</span> <span class="n">successfully</span> <span class="p">(</span><span class="mf">0.000</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<p>What happened?  waf loaded the wscript file, looked for a callable object called
<code class="docutils literal notranslate"><span class="pre">mycommand</span></code>, created a <code class="docutils literal notranslate"><span class="pre">Context</span></code> instance <code class="docutils literal notranslate"><span class="pre">ctx</span></code>, and passed it to the
callable thing as the first and only argument.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ctx</span></code> instance contains information about the current waf run.
We investigate with a print in the wscript:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># the whole wscript file</span>
<span class="k">def</span> <span class="nf">mycommand</span><span class="p">(</span><span class="n">ctx</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
</pre></div>
</div>
<p>giving:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">waflib</span><span class="o">.</span><span class="n">Context</span><span class="o">.</span><span class="n">Context</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x1011b60d0</span><span class="o">&gt;</span>
<span class="s1">&#39;mycommand&#39;</span> <span class="n">finished</span> <span class="n">successfully</span> <span class="p">(</span><span class="mf">0.000</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="special-commands">
<h3>Special commands<a class="headerlink" href="#special-commands" title="Permalink to this headline">¶</a></h3>
<p>The following commands are special to waf:</p>
<ul class="simple">
<li><p>options</p></li>
<li><p>configure</p></li>
<li><p>distclean</p></li>
<li><p>clean</p></li>
<li><p>build</p></li>
<li><p>install</p></li>
<li><p>uninstall</p></li>
<li><p>dist</p></li>
<li><p>list</p></li>
<li><p>step</p></li>
</ul>
<p>(there may be others I don’t know).</p>
<p>If you define functions (callables) with these names, they have default and
specialized behavior.  For example, each of these commands receives its own
specialized Context object. We can show that for the the <code class="docutils literal notranslate"><span class="pre">options</span></code> command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># the whole wscript</span>
<span class="k">def</span> <span class="nf">options</span><span class="p">(</span><span class="n">opt_ctx</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">opt_ctx</span><span class="p">)</span>
</pre></div>
</div>
<p>gives:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ waf options
&lt;waflib.Options.OptionsContext object at 0x1011b53d0&gt;
</pre></div>
</div>
<p>Let’s make each of the commands print their context instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># the whole wscript</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>

<span class="k">for</span> <span class="n">command_name</span> <span class="ow">in</span> <span class="p">(</span>
    <span class="s1">&#39;options&#39;</span><span class="p">,</span>
    <span class="s1">&#39;configure&#39;</span><span class="p">,</span>
    <span class="s1">&#39;distclean&#39;</span><span class="p">,</span>
    <span class="s1">&#39;clean&#39;</span><span class="p">,</span>
    <span class="s1">&#39;build&#39;</span><span class="p">,</span>
    <span class="s1">&#39;install&#39;</span><span class="p">,</span>
    <span class="s1">&#39;uninstall&#39;</span><span class="p">,</span>
    <span class="s1">&#39;dist&#39;</span><span class="p">,</span>
    <span class="s1">&#39;list&#39;</span><span class="p">,</span>
    <span class="s1">&#39;step&#39;</span><span class="p">,</span>
    <span class="p">):</span>
    <span class="n">exec</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0}</span><span class="s1"> = lambda ctx : print(&quot;In: </span><span class="si">{0}</span><span class="s1"> with&quot;, ctx)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">command_name</span><span class="p">))</span>
</pre></div>
</div>
<p>Executing ‘options’ again:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ waf options
In: options with &lt;waflib.Options.OptionsContext object at 0x1011b55d0&gt;
</pre></div>
</div>
<p>We can execute all these command in order by concatenating them at the command
line to show they each get an instance of their own specialized Context:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ waf options configure distclean clean build install uninstall dist list step
In: options with &lt;waflib.Options.OptionsContext object at 0x1011b6750&gt;
Setting top to                           : /Users/mb312/dev_trees/myproject
Setting out to                           : /Users/mb312/dev_trees/myproject/build
In: configure with &lt;waflib.Configure.ConfigurationContext object at 0x1011b6a50&gt;
&#39;configure&#39; finished successfully (0.017s)
In: distclean with &lt;waflib.Context.Context object at 0x1011b6c10&gt;
&#39;distclean&#39; finished successfully (0.000s)
In: build with &lt;waflib.Build.CleanContext object at 0x1011b6d50&gt;
&#39;clean&#39; finished successfully (0.008s)
Waf: Entering directory `/Users/mb312/dev_trees/myproject/build&#39;
In: build with &lt;waflib.Build.BuildContext object at 0x1011b6f50&gt;
Waf: Leaving directory `/Users/mb312/dev_trees/myproject/build&#39;
&#39;build&#39; finished successfully (0.002s)
Waf: Entering directory `/Users/mb312/dev_trees/myproject/build&#39;
In: build with &lt;waflib.Build.InstallContext object at 0x1011c0210&gt;
Waf: Leaving directory `/Users/mb312/dev_trees/myproject/build&#39;
&#39;install&#39; finished successfully (0.002s)
Waf: Entering directory `/Users/mb312/dev_trees/myproject/build&#39;
In: build with &lt;waflib.Build.UninstallContext object at 0x1011c04d0&gt;
Waf: Leaving directory `/Users/mb312/dev_trees/myproject/build&#39;
&#39;uninstall&#39; finished successfully (0.013s)
In: dist with &lt;waflib.Scripting.Dist object at 0x1011c07d0&gt;
New archive created: noname-1.0.tar.bz2 (sha=&#39;38a85b35879a5b0703142c3c27e765bafb7fd4b6&#39;)
&#39;dist&#39; finished successfully (0.051s)
In: build with &lt;waflib.Build.ListContext object at 0x1011dcfd0&gt;
&#39;list&#39; finished successfully (0.003s)
Waf: Entering directory `/Users/mb312/dev_trees/myproject/build&#39;
In: build with &lt;waflib.Build.StepContext object at 0x1011e9550&gt;
Add a pattern for the debug build, for example &quot;waf step --files=main.c,app&quot;
Waf: Leaving directory `/Users/mb312/dev_trees/myproject/build&#39;
&#39;step&#39; finished successfully (0.002s)
</pre></div>
</div>
</div>
<div class="section" id="some-commands-use-the-build-callable-instead-of-their-own-callable">
<h3>Some commands use the build callable instead of their own callable<a class="headerlink" href="#some-commands-use-the-build-callable-instead-of-their-own-callable" title="Permalink to this headline">¶</a></h3>
<p>You can see from the printout above that all of (clean, build, install,
uninstall, list, step) end up executing the ‘build’ command not their own
commands.  If you want to specialize behavior of these commands, you’ll need to
put code in the <code class="docutils literal notranslate"><span class="pre">build</span></code> function (callable) to check the <code class="docutils literal notranslate"><span class="pre">cmd</span></code> attribute of
the build context to find which of these commands the <code class="docutils literal notranslate"><span class="pre">build</span></code> function is
running. See “More build commands” in the waf book for more detail.</p>
</div>
<div class="section" id="more-on-the-configure-command">
<h3>More on the configure command<a class="headerlink" href="#more-on-the-configure-command" title="Permalink to this headline">¶</a></h3>
<p>Executing the <code class="docutils literal notranslate"><span class="pre">configure</span></code> command will:</p>
<ul class="simple">
<li><p>call the options command</p></li>
<li><p>set some default path information</p></li>
</ul>
<p>This happens before your own <code class="docutils literal notranslate"><span class="pre">configure</span></code> command gets executed, and even if
there is no <code class="docutils literal notranslate"><span class="pre">configure</span></code> command defined.  For example, if wscript is an empty
file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ waf configure
&lt;waflib.Options.OptionsContext object at 0x1011b53d0&gt;
Setting top to                           : /Users/mb312/dev_trees/myproject
Setting out to                           : /Users/mb312/dev_trees/myproject/build
No function configure defined in /Users/mb312/dev_trees/myproject/wscript
</pre></div>
</div>
<p>The default configure machinery has set the default ‘source’ (<em>top</em>) directory
and the ‘build’ (<em>out</em>) directory.  <em>top</em> is (by default) the directory
containing the wscript file, and <em>out</em> is (by default) a subdirectory of <em>top</em>
called <code class="docutils literal notranslate"><span class="pre">build</span></code>.  You can customize these directories if you want, for example
by using the <code class="docutils literal notranslate"><span class="pre">top</span></code> and <code class="docutils literal notranslate"><span class="pre">out</span></code> global variables at the top of the wscript.</p>
</div>
</div>
<div class="section" id="how-the-build-gets-built">
<h2>How the build gets built<a class="headerlink" href="#how-the-build-gets-built" title="Permalink to this headline">¶</a></h2>
<p>See the waf book chapter called “Builds”.</p>
<p>A build consists of tasks.  Tasks are instances of subclasses of the
<code class="docutils literal notranslate"><span class="pre">waflib.Task.Task</span></code> class.  But - where is <code class="docutils literal notranslate"><span class="pre">waflib</span></code>?</p>
<div class="section" id="where-is-the-waf-code">
<h3>Where is the waf code?<a class="headerlink" href="#where-is-the-waf-code" title="Permalink to this headline">¶</a></h3>
<p>See “Local waflib folders” in the waf book.</p>
<p>The usual way to use waf is to download the <code class="docutils literal notranslate"><span class="pre">waf</span></code> binary to your source code
tree, maybe checking the binary into your source control.</p>
<p>In this case, executing the <code class="docutils literal notranslate"><span class="pre">./waf</span></code> binary will automatically unpack the waf
code from within the binary to a specially named folder in the same directory as
the binary, with a name beginning with <code class="docutils literal notranslate"><span class="pre">.waf-</span></code>. For example, after I have run
<code class="docutils literal notranslate"><span class="pre">./waf</span> <span class="pre">configure</span></code> in the test project folder I get:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ls -A1
.lock-waf_darwin_build
.waf-1.7.13-5a064c2686fe54de4e11018d22148cfc
build
waf
wscript
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">waflib</span></code> code is in this special <code class="docutils literal notranslate"><span class="pre">.waf-*</span></code> directory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ls .waf-1.7.13-5a064c2686fe54de4e11018d22148cfc/
waflib
</pre></div>
</div>
<p>As the waf book explains, it’s also possible to run waf with <code class="docutils literal notranslate"><span class="pre">waflib</span></code> as a
standard folder in the source tree or elsewhere.</p>
</div>
<div class="section" id="high-level-api-for-creating-tasks">
<h3>High level API for creating tasks<a class="headerlink" href="#high-level-api-for-creating-tasks" title="Permalink to this headline">¶</a></h3>
<p>Usually we create tasks using a high-level API called <em>task generators</em>.  You
already saw these in our first wscript towards the top of this page. The task
generator creates the task instances for us:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># the whole wscript</span>
<span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="n">conf_ctx</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="n">build_ctx</span><span class="p">):</span>
    <span class="n">build_ctx</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="s1">&#39;touch $</span><span class="si">{TGT}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="#variable-substitution"><span class="std std-ref">run_str Variable substitution</span></a> below for more on the <code class="docutils literal notranslate"><span class="pre">${TGT}</span></code> string
substitution form.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">rule</span></code> is a system command that we can run, and the <code class="docutils literal notranslate"><span class="pre">target</span></code> in this
case is a filename of a file we generate with the command.</p>
<p>From here on in, I’ll use the invocation <code class="docutils literal notranslate"><span class="pre">waf</span> <span class="pre">distclean</span> <span class="pre">configure</span> <span class="pre">build</span></code> to
run the waf build.  <code class="docutils literal notranslate"><span class="pre">distclean</span></code> deletes all the generated build targets,
clearing the outputs of any previous waf run.</p>
<p>So:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ waf distclean configure build
Setting top to                           : /Users/mb312/dev_trees/myproject
Setting out to                           : /Users/mb312/dev_trees/myproject/build
&#39;configure&#39; finished successfully (0.003s)
Waf: Entering directory `/Users/mb312/dev_trees/myproject/build&#39;
[1/1] foo:  -&gt; build/foo
Waf: Leaving directory `/Users/mb312/dev_trees/myproject/build&#39;
&#39;build&#39; finished successfully (0.024s)
</pre></div>
</div>
<p>The script generates an empty file <code class="docutils literal notranslate"><span class="pre">build/foo</span></code>.</p>
<p>The call to <code class="docutils literal notranslate"><span class="pre">build_ctx()</span></code> above is a very short piece of code that ends up
creating an instance of <code class="docutils literal notranslate"><span class="pre">waflib.TaskGen.task_gen</span></code>.  In due course this will
generate all the relevant <code class="docutils literal notranslate"><span class="pre">Task</span></code> instances.  Adpapting an example from the waf
book:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># the whole wscript</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>

<span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="n">conf_ctx</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="n">build_ctx</span><span class="p">):</span>
    <span class="n">tg</span> <span class="o">=</span> <span class="n">build_ctx</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="s1">&#39;touch $</span><span class="si">{TGT}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
    <span class="c1"># This will show that ``tg`` is a ``task_gen`` instance</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Type of tg is:&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">tg</span><span class="p">))</span>
    <span class="c1"># ``tg.tasks`` is empty because the generator has not run yet</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Task list before tg.post()&#39;</span><span class="p">,</span> <span class="n">tg</span><span class="o">.</span><span class="n">tasks</span><span class="p">)</span>
    <span class="c1"># ``tg.post()`` runs the generator and fills the task list</span>
    <span class="n">tg</span><span class="o">.</span><span class="n">post</span><span class="p">()</span>
    <span class="c1"># The task list now contains a single task</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Task list after tg.post()&#39;</span><span class="p">,</span> <span class="n">tg</span><span class="o">.</span><span class="n">tasks</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Type of tg.tasks[0] is:&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">tg</span><span class="o">.</span><span class="n">tasks</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
<p>so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ waf distclean configure build
&#39;distclean&#39; finished successfully (0.002s)
Setting top to                           : /Users/mb312/dev_trees/myproject
Setting out to                           : /Users/mb312/dev_trees/myproject/build
&#39;configure&#39; finished successfully (0.003s)
Waf: Entering directory `/Users/mb312/dev_trees/myproject/build&#39;
Type of tg is: &lt;class &#39;waflib.TaskGen.task_gen&#39;&gt;
Task list before tg.post() []
Task list after tg.post() [
    {task 4313537616: foo  -&gt; foo}]
Type of tg.tasks[0] is: &lt;class &#39;waflib.Task.foo&#39;&gt;
[1/1] foo:  -&gt; build/foo
Waf: Leaving directory `/Users/mb312/dev_trees/myproject/build&#39;
&#39;build&#39; finished successfully (0.019s)
</pre></div>
</div>
</div>
<div class="section" id="nodes">
<h3>Nodes<a class="headerlink" href="#nodes" title="Permalink to this headline">¶</a></h3>
<p>Before we do some low-level API examples, we need some explanation of the waf
concept of ‘nodes’.</p>
<p>‘nodes’ are waf objects representing files or directories on the filesystem.
The files or directories may or may not exist at the time you create the node.</p>
<p>The waf book has a chapter devoted to “Node objects”.</p>
<p>Two node objects get automatically created and attached to the ‘Context’ of
every command - ‘path’ and ‘root’.  Here we use a custom command <code class="docutils literal notranslate"><span class="pre">mycommand</span></code>.
Because it’s a custom command (not one of the defined waf commands above), the
command  receives an instance of the base <code class="docutils literal notranslate"><span class="pre">Context</span></code> class.  All command
contexts will have these node objects:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># the whole wscript</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>

<span class="k">def</span> <span class="nf">mycommand</span><span class="p">(</span><span class="n">base_ctx</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">base_ctx</span><span class="o">.</span><span class="n">path</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">base_ctx</span><span class="o">.</span><span class="n">path</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">base_ctx</span><span class="o">.</span><span class="n">root</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">base_ctx</span><span class="o">.</span><span class="n">root</span><span class="p">))</span>
</pre></div>
</div>
<p>giving:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ waf mycommand
&lt;class &#39;waflib.Node.Nod3&#39;&gt; /Users/mb312/dev_trees/myproject
&lt;class &#39;waflib.Node.Nod3&#39;&gt; /
&#39;mycommand&#39; finished successfully (0.000s)
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">base_ctx.path</span></code> is a node pointing to the directory containing the executed
wscript file. <code class="docutils literal notranslate"><span class="pre">base_ctx.root</span></code> is a node pointing to the root directory of the
filesystem containing the wscript.</p>
<p>Node objects contain various useful methods:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># the whole wscript</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>

<span class="k">def</span> <span class="nf">mycommand</span><span class="p">(</span><span class="n">base_ctx</span><span class="p">):</span>
    <span class="c1"># Show the attributes that are not private</span>
    <span class="nb">print</span><span class="p">([</span><span class="n">attr</span> <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="n">base_ctx</span><span class="o">.</span><span class="n">path</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">attr</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)])</span>
</pre></div>
</div>
<p>gives:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ waf mycommand
[&#39;abspath&#39;, &#39;ant_glob&#39;, &#39;ant_iter&#39;, &#39;bld_base&#39;, &#39;bld_dir&#39;, &#39;bldpath&#39;,
&#39;cache_abspath&#39;, &#39;cache_isdir&#39;, &#39;cache_sig&#39;, &#39;change_ext&#39;, &#39;children&#39;,
&#39;chmod&#39;, &#39;ctx&#39;, &#39;delete&#39;, &#39;evict&#39;, &#39;find_dir&#39;, &#39;find_node&#39;,
&#39;find_or_declare&#39;, &#39;find_resource&#39;, &#39;get_bld&#39;, &#39;get_bld_sig&#39;, &#39;get_src&#39;,
&#39;height&#39;, &#39;is_bld&#39;, &#39;is_child_of&#39;, &#39;is_src&#39;, &#39;listdir&#39;, &#39;make_node&#39;,
&#39;mkdir&#39;, &#39;name&#39;, &#39;nice_path&#39;, &#39;parent&#39;, &#39;path_from&#39;, &#39;read&#39;, &#39;relpath&#39;,
&#39;search&#39;, &#39;search_node&#39;, &#39;sig&#39;, &#39;srcpath&#39;, &#39;suffix&#39;, &#39;write&#39;]
&#39;mycommand&#39; finished successfully (0.001s)
</pre></div>
</div>
<p>The waf book goes into more detail about these methods.</p>
<p>One interesting method is <code class="docutils literal notranslate"><span class="pre">abspath()</span></code>.  It gives the absolute path to the
node as a string:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># the whole wscript</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>

<span class="k">def</span> <span class="nf">mycommand</span><span class="p">(</span><span class="n">base_ctx</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">base_ctx</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">())</span>
</pre></div>
</div>
<p>for output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ waf mycommand
/Users/mb312/dev_trees/myproject
&#39;mycommand&#39; finished successfully (0.000s)
</pre></div>
</div>
</div>
<div class="section" id="creating-nodes">
<h3>Creating nodes<a class="headerlink" href="#creating-nodes" title="Permalink to this headline">¶</a></h3>
<p>Here are some useful ordinary methods for creating nodes.  By ‘ordinary’ I mean
methods that work for all command contexts (base <code class="docutils literal notranslate"><span class="pre">Context</span></code>, <code class="docutils literal notranslate"><span class="pre">BuildContext</span></code>,
<code class="docutils literal notranslate"><span class="pre">OptionContext</span></code> etc).</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">.search(path)</span></code> : search for an already-created node for <code class="docutils literal notranslate"><span class="pre">path</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.find_node(path)</span></code> : create a node for <code class="docutils literal notranslate"><span class="pre">path</span></code> if it exists on the
filesystem, return None otherwise</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.make_node(path)</span></code> : create a node for <code class="docutils literal notranslate"><span class="pre">path</span></code> whether <code class="docutils literal notranslate"><span class="pre">path</span></code>
exists on the filesystem or not.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.find_dir(dirname)</span></code>: create a node for <code class="docutils literal notranslate"><span class="pre">dirname</span></code> if it exists on the
filesystem and is a directory, return None otherwise. This is just
<code class="docutils literal notranslate"><span class="pre">.find_node(path)</span></code> with an extra check that <code class="docutils literal notranslate"><span class="pre">path</span></code> is in fact a
directory.</p></li>
</ul>
</div>
<div class="section" id="waf-creates-some-nodes-automatically-but-not-many">
<h3>waf creates some nodes automatically, but not many<a class="headerlink" href="#waf-creates-some-nodes-automatically-but-not-many" title="Permalink to this headline">¶</a></h3>
<p>When waf creates <code class="docutils literal notranslate"><span class="pre">path</span></code> and <code class="docutils literal notranslate"><span class="pre">root</span></code> nodes, it also creates some nodes for
other parts of the system file tree, but not all. This is in order not to waste
time reading the file system for nodes that may not be needed.  Call this lazy
node creation.</p>
<p>Lazy node creation may come up in two situations.  The first is when using
<code class="docutils literal notranslate"><span class="pre">.search(path)</span></code> (above).  This will only find nodes that are already
defined.  For example, if you do <code class="docutils literal notranslate"><span class="pre">build_ctx.path.search('waf')</span></code> at the
beginning of your build command, you will usually get None, even if the file
<code class="docutils literal notranslate"><span class="pre">waf</span></code> does exist in the folder referred to by the <code class="docutils literal notranslate"><span class="pre">path</span></code> node.  You probably
want <code class="docutils literal notranslate"><span class="pre">.find_node(path)</span></code> instead, which will read the filesystem and create
a node if the file exists.</p>
<p>Another place where lazy node creation is relevant is interpreting the
<code class="docutils literal notranslate"><span class="pre">children</span></code> attribute of a directory node. <code class="docutils literal notranslate"><span class="pre">children</span></code> is a dictionary giving
nodes corresponding to the contents of a directory. For efficiency, waf doesn’t
always read the filesystem to fill this structure, so you may need to create
nodes manually if they have not been read from the filesystem already:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># the whole wscript</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>

<span class="kn">import</span> <span class="nn">os</span>

<span class="k">def</span> <span class="nf">mycommand</span><span class="p">(</span><span class="n">base_ctx</span><span class="p">):</span>
    <span class="c1"># The children of the root directory</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;root node children&#39;</span><span class="p">,</span> <span class="n">base_ctx</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">children</span><span class="p">)</span>
    <span class="c1"># There are many more directories than found in the children</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ls of root directory&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>This gives:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ waf mycommand
root node children {&#39;Users&#39;: /Users}
ls of root directory [&#39;.dbfseventsd&#39;, &#39;.DS_Store&#39;, &#39;.file&#39;, &#39;.fseventsd&#39;,
&#39;.hotfiles.btree&#39;, &#39;.Spotlight-V100&#39;, &#39;.Trashes&#39;, &#39;.vol&#39;, &#39;Applications&#39;,
&#39;bin&#39;, &#39;cores&#39;, &#39;dev&#39;, &#39;Developer&#39;, &#39;etc&#39;, &#39;home&#39;, &#39;Library&#39;, &#39;mach_kernel&#39;,
&#39;net&#39;, &#39;Network&#39;, &#39;opt&#39;, &#39;private&#39;, &#39;sbin&#39;, &#39;System&#39;, &#39;tmp&#39;, &#39;User Guides
And Information&#39;, &#39;Users&#39;, &#39;usr&#39;, &#39;var&#39;, &#39;Volumes&#39;]
&#39;mycommand&#39; finished successfully (0.000s)
</pre></div>
</div>
</div>
<div class="section" id="specialized-noding-for-builds">
<h3>Specialized noding for builds<a class="headerlink" href="#specialized-noding-for-builds" title="Permalink to this headline">¶</a></h3>
<p>This describes node stuff that only applies to the <code class="docutils literal notranslate"><span class="pre">BuildContext</span></code> - the
context object passed to a <code class="docutils literal notranslate"><span class="pre">build</span></code> command.</p>
<div class="section" id="build-and-source-nodes">
<h4>build and source nodes<a class="headerlink" href="#build-and-source-nodes" title="Permalink to this headline">¶</a></h4>
<p>The build context is a special context passed to the <code class="docutils literal notranslate"><span class="pre">build</span></code> command.</p>
<p>The build also needs to know about the location of the directory containing the
source files, and the output directory to put the target files. To solve this,
the build context contains two extra nodes, <code class="docutils literal notranslate"><span class="pre">bldnode</span></code> and <code class="docutils literal notranslate"><span class="pre">srcnode</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># the whole wscript</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>

<span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="n">conf_ctx</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="n">build_ctx</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;build_ctx.path&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">path</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">path</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;build_ctx.root&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">root</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">root</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;build_ctx.srcnode&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">srcnode</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">srcnode</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;build_ctx.bldnode&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">bldnode</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">bldnode</span><span class="p">))</span>
</pre></div>
</div>
<p>so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ waf distclean configure build
&#39;distclean&#39; finished successfully (0.001s)
Setting top to                           : /Users/mb312/dev_trees/myproject
Setting out to                           : /Users/mb312/dev_trees/myproject/build
&#39;configure&#39; finished successfully (0.009s)
Waf: Entering directory `/Users/mb312/dev_trees/myproject/build&#39;
build_ctx.path &lt;class &#39;waflib.Node.Nod3&#39;&gt; /Users/mb312/dev_trees/myproject
build_ctx.root &lt;class &#39;waflib.Node.Nod3&#39;&gt; /
build_ctx.srcnode &lt;class &#39;waflib.Node.Nod3&#39;&gt; /Users/mb312/dev_trees/myproject
build_ctx.bldnode &lt;class &#39;waflib.Node.Nod3&#39;&gt; /Users/mb312/dev_trees/myproject/build
Waf: Leaving directory `/Users/mb312/dev_trees/myproject/build&#39;
&#39;build&#39; finished successfully (0.003s)
</pre></div>
</div>
<p>The source node path may differ from the ‘path’ if you’ve customized the <em>top</em>
or <em>out</em> directories:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># the whole wscript</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>

<span class="n">top</span> <span class="o">=</span> <span class="s1">&#39;tmp2&#39;</span>
<span class="n">out</span> <span class="o">=</span> <span class="s1">&#39;tmp2/build2&#39;</span>

<span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="n">conf_ctx</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="n">build_ctx</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;build_ctx.path&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">path</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">path</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;build_ctx.root&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">root</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">root</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;build_ctx.srcnode&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">srcnode</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">srcnode</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;build_ctx.bldnode&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">bldnode</span><span class="p">),</span> <span class="nb">repr</span><span class="p">(</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">bldnode</span><span class="p">))</span>
</pre></div>
</div>
<p>We need to create the <code class="docutils literal notranslate"><span class="pre">tmp2</span></code> directory in the project directory in order for
this not to raise an error:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="n">tmp2</span>
</pre></div>
</div>
<p>then:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ waf distclean configure build
&#39;distclean&#39; finished successfully (0.000s)
Setting top to                           : /Users/mb312/dev_trees/myproject/tmp2
Setting out to                           : /Users/mb312/dev_trees/myproject/tmp2/build2
Are you certain that you do not want to set top=&quot;.&quot; ?
&#39;configure&#39; finished successfully (0.002s)
Waf: Entering directory `/Users/mb312/dev_trees/myproject/tmp2/build2&#39;
build_ctx.path &lt;class &#39;waflib.Node.Nod3&#39;&gt; /Users/mb312/dev_trees/myproject
build_ctx.root &lt;class &#39;waflib.Node.Nod3&#39;&gt; /
build_ctx.srcnode &lt;class &#39;waflib.Node.Nod3&#39;&gt; /Users/mb312/dev_trees/myproject/tmp2
build_ctx.bldnode &lt;class &#39;waflib.Node.Nod3&#39;&gt; /Users/mb312/dev_trees/myproject/tmp2/build2
Waf: Leaving directory `/Users/mb312/dev_trees/myproject/tmp2/build2&#39;
&#39;build&#39; finished successfully (0.010s)
</pre></div>
</div>
<p>Iff you have a build context <code class="docutils literal notranslate"><span class="pre">bldnode</span></code>, you can get the source node with
<code class="docutils literal notranslate"><span class="pre">get_src</span></code>; if you have the build context <code class="docutils literal notranslate"><span class="pre">srcnode</span></code> you can get the build
node with <code class="docutils literal notranslate"><span class="pre">get_bld</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># the whole wscript</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>

<span class="n">top</span> <span class="o">=</span> <span class="s1">&#39;tmp2&#39;</span>
<span class="n">out</span> <span class="o">=</span> <span class="s1">&#39;tmp2/build2&#39;</span>

<span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="n">conf_ctx</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="n">build_ctx</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">srcnode</span><span class="o">.</span><span class="n">get_bld</span><span class="p">()))</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">bldnode</span><span class="o">.</span><span class="n">get_src</span><span class="p">()))</span>
</pre></div>
</div>
<p>Output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ waf distclean configure build
&#39;distclean&#39; finished successfully (0.002s)
Setting top to                           : /Users/mb312/dev_trees/myproject/tmp2
Setting out to                           : /Users/mb312/dev_trees/myproject/tmp2/build2
Are you certain that you do not want to set top=&quot;.&quot; ?
&#39;configure&#39; finished successfully (0.003s)
Waf: Entering directory `/Users/mb312/dev_trees/myproject/tmp2/build2&#39;
/Users/mb312/dev_trees/myproject/tmp2/build2
/Users/mb312/dev_trees/myproject/tmp2
Waf: Leaving directory `/Users/mb312/dev_trees/myproject/tmp2/build2&#39;
&#39;build&#39; finished successfully (0.005s)
</pre></div>
</div>
<p>Careful with these methods - if you call them on nodes other than <code class="docutils literal notranslate"><span class="pre">bldnode</span></code> or
<code class="docutils literal notranslate"><span class="pre">srcnode</span></code>, you may well not get what you expect.</p>
</div>
<div class="section" id="where-s-my-node-build-or-source">
<h4>Where’s my node - build or source?<a class="headerlink" href="#where-s-my-node-build-or-source" title="Permalink to this headline">¶</a></h4>
<p>During the build, we may want to create nodes that might refer to the build
tree <em>or</em> to the source tree.  For example you could imagine a command
<code class="docutils literal notranslate"><span class="pre">my_find_node_build_source(path)</span></code> which would look for <code class="docutils literal notranslate"><span class="pre">path</span></code> in the
build tree, then in the source tree.  There are a couple of node methods that
look both in the build tree and the source tree.  These both only work for build
contexts:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">.find_resource(path)</span></code>:</p>
<ol class="arabic simple">
<li><p>look for an existing file node in the build node tree. Return that node if
it exists.</p></li>
<li><p>look for corresponding file path in the source tree, make a node for the
path and return it if the path exists.</p></li>
<li><p>Otherwise return None</p></li>
</ol>
<p>The routine also returns None if <code class="docutils literal notranslate"><span class="pre">path</span></code> is a directory.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">.find_or_declare(path)</span></code>:</p>
<ol class="arabic simple">
<li><p>look for an existing node in the build node tree. Return that node if it
exists.</p></li>
<li><p>look for corresponding path in the source tree, make a node for the path
and return it if the path exists.</p></li>
<li><p>Make a new node in the build node tree for this path and return that node.</p></li>
</ol>
<p><code class="docutils literal notranslate"><span class="pre">find_or_declare</span></code> will return a node for a directory.</p>
</li>
</ul>
</div>
</div>
<div class="section" id="low-level-api-for-tasks">
<h3>Low-level API for tasks<a class="headerlink" href="#low-level-api-for-tasks" title="Permalink to this headline">¶</a></h3>
<p>As we saw above, the high-level API generates ‘task’ instances.</p>
<p>The low-level API creates task instances directly.</p>
<p>See the “Direct task declaration” in the waf book for details.</p>
<p>Here’s an example of the high level interface.  Then we’ll do the same with the
low-level interface:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># the whole wscript</span>
<span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="n">conf_ctx</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="n">build_ctx</span><span class="p">):</span>
    <span class="c1"># create empty &#39;foo&#39; file</span>
    <span class="n">build_ctx</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="s1">&#39;touch $</span><span class="si">{TGT}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
    <span class="c1"># copy &#39;foo&#39; to &#39;bar&#39;</span>
    <span class="n">build_ctx</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="s1">&#39;cp $</span><span class="si">{SRC}</span><span class="s1"> $</span><span class="si">{TGT}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Thence:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ waf distclean configure build
&#39;distclean&#39; finished successfully (0.002s)
Setting top to                           : /Users/mb312/dev_trees/myproject
Setting out to                           : /Users/mb312/dev_trees/myproject/build
&#39;configure&#39; finished successfully (0.003s)
Waf: Entering directory `/Users/mb312/dev_trees/myproject/build&#39;
[1/2] foo:  -&gt; build/foo
[2/2] bar: build/foo -&gt; build/bar
Waf: Leaving directory `/Users/mb312/dev_trees/myproject/build&#39;
&#39;build&#39; finished successfully (0.035s)
</pre></div>
</div>
<p>The low level interface defines the tasks and dependencies directly:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># the whole wscript</span>
<span class="kn">from</span> <span class="nn">waflib.Task</span> <span class="kn">import</span> <span class="n">Task</span>

<span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="n">conf_ctx</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="n">build_ctx</span><span class="p">):</span>
    <span class="c1"># Declare the tasks</span>
    <span class="k">class</span> <span class="nc">TouchFile</span><span class="p">(</span><span class="n">Task</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">ret_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exec_command</span><span class="p">(</span>
                <span class="s1">&#39;touch </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">abspath</span><span class="p">()))</span>
            <span class="k">return</span> <span class="n">ret_code</span>

    <span class="k">class</span> <span class="nc">CopyFile</span><span class="p">(</span><span class="n">Task</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">ret_code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exec_command</span><span class="p">(</span>
                <span class="s1">&#39;cp </span><span class="si">{0}</span><span class="s1"> </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">abspath</span><span class="p">(),</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">abspath</span><span class="p">()))</span>
            <span class="k">return</span> <span class="n">ret_code</span>
    <span class="c1"># Instantiate tasks</span>
    <span class="n">touch_task</span> <span class="o">=</span> <span class="n">TouchFile</span><span class="p">(</span><span class="n">env</span><span class="o">=</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">env</span><span class="p">)</span>
    <span class="n">touch_task</span><span class="o">.</span><span class="n">set_outputs</span><span class="p">(</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">find_or_declare</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">))</span>
    <span class="n">cp_task</span> <span class="o">=</span> <span class="n">CopyFile</span><span class="p">(</span><span class="n">env</span><span class="o">=</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">env</span><span class="p">)</span>
    <span class="n">cp_task</span><span class="o">.</span><span class="n">set_inputs</span><span class="p">(</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">find_resource</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">))</span>
    <span class="n">cp_task</span><span class="o">.</span><span class="n">set_outputs</span><span class="p">(</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">find_or_declare</span><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">))</span>
    <span class="c1"># Add them to a run group to schedule them</span>
    <span class="n">build_ctx</span><span class="o">.</span><span class="n">add_to_group</span><span class="p">(</span><span class="n">touch_task</span><span class="p">)</span>
    <span class="n">build_ctx</span><span class="o">.</span><span class="n">add_to_group</span><span class="p">(</span><span class="n">cp_task</span><span class="p">)</span>
    <span class="c1"># Build machinery will submit and run these defined tasks</span>
</pre></div>
</div>
<p>giving output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ waf distclean configure build
&#39;distclean&#39; finished successfully (0.002s)
Setting top to                           : /Users/mb312/dev_trees/myproject
Setting out to                           : /Users/mb312/dev_trees/myproject/build
&#39;configure&#39; finished successfully (0.003s)
Waf: Entering directory `/Users/mb312/dev_trees/myproject/build&#39;
[1/2] TouchFile:  -&gt; build/foo
[2/2] CopyFile: build/foo -&gt; build/bar
Waf: Leaving directory `/Users/mb312/dev_trees/myproject/build&#39;
&#39;build&#39; finished successfully (0.040s)
</pre></div>
</div>
<p>We can also define tasks using the slightly higher-level <code class="docutils literal notranslate"><span class="pre">run_str</span></code> attribute
instead of the <code class="docutils literal notranslate"><span class="pre">run</span></code> method.  waf translates the <code class="docutils literal notranslate"><span class="pre">run_str</span></code> attribute to a
<code class="docutils literal notranslate"><span class="pre">run</span></code> method automatically on execution, to give the same result:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># the whole wscript</span>
<span class="kn">from</span> <span class="nn">waflib.Task</span> <span class="kn">import</span> <span class="n">Task</span>

<span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="n">conf_ctx</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="n">build_ctx</span><span class="p">):</span>
    <span class="c1"># Declare the tasks</span>
    <span class="k">class</span> <span class="nc">TouchFile</span><span class="p">(</span><span class="n">Task</span><span class="p">):</span>
        <span class="n">run_str</span> <span class="o">=</span> <span class="s1">&#39;touch $</span><span class="si">{TGT}</span><span class="s1">&#39;</span>

    <span class="k">class</span> <span class="nc">CopyFile</span><span class="p">(</span><span class="n">Task</span><span class="p">):</span>
        <span class="n">run_str</span> <span class="o">=</span> <span class="s1">&#39;cp $</span><span class="si">{SRC}</span><span class="s1"> $</span><span class="si">{TGT}</span><span class="s1">&#39;</span>

    <span class="c1"># Instantiate tasks</span>
    <span class="n">touch_task</span> <span class="o">=</span> <span class="n">TouchFile</span><span class="p">(</span><span class="n">env</span><span class="o">=</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">env</span><span class="p">)</span>
    <span class="n">touch_task</span><span class="o">.</span><span class="n">set_outputs</span><span class="p">(</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">find_or_declare</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">))</span>
    <span class="n">cp_task</span> <span class="o">=</span> <span class="n">CopyFile</span><span class="p">(</span><span class="n">env</span><span class="o">=</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">env</span><span class="p">)</span>
    <span class="n">cp_task</span><span class="o">.</span><span class="n">set_inputs</span><span class="p">(</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">find_resource</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">))</span>
    <span class="n">cp_task</span><span class="o">.</span><span class="n">set_outputs</span><span class="p">(</span><span class="n">build_ctx</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">find_or_declare</span><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">))</span>
    <span class="c1"># Add them to a run group to schedule them</span>
    <span class="n">build_ctx</span><span class="o">.</span><span class="n">add_to_group</span><span class="p">(</span><span class="n">touch_task</span><span class="p">)</span>
    <span class="n">build_ctx</span><span class="o">.</span><span class="n">add_to_group</span><span class="p">(</span><span class="n">cp_task</span><span class="p">)</span>
    <span class="c1"># Build machinery will submit and run these defined tasks</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="run-str-variable-substitution">
<span id="variable-substitution"></span><h2>run_str Variable substitution<a class="headerlink" href="#run-str-variable-substitution" title="Permalink to this headline">¶</a></h2>
<p>As we’ve seen, a Task can define a system command by defining a <code class="docutils literal notranslate"><span class="pre">run</span></code> method,
or a <code class="docutils literal notranslate"><span class="pre">run_str</span></code>, which will be compiled into a <code class="docutils literal notranslate"><span class="pre">run</span></code> method.</p>
<p>If you pass a string using the <code class="docutils literal notranslate"><span class="pre">rule=</span></code> keyword argument to the high-level API,
this also becomes the <code class="docutils literal notranslate"><span class="pre">run_str</span></code> of the task.</p>
<p>As you can see from the examples above, the run_str has some extra rules of
variable substitution.</p>
<p>For example, <code class="docutils literal notranslate"><span class="pre">${SRC}</span></code> and <code class="docutils literal notranslate"><span class="pre">${TGT}</span></code> get substituted for the <code class="docutils literal notranslate"><span class="pre">source</span></code> and
<code class="docutils literal notranslate"><span class="pre">target</span></code> filenames.  Other variable names that work in this mode
(<code class="docutils literal notranslate"><span class="pre">${VARIABLE_NAME}</span></code>) are any attribute of <code class="docutils literal notranslate"><span class="pre">build_ctx.env</span></code>.</p>
<p>See <em>Scriptlet expressions</em> in the waf book for more substitutions. Here I’ve
copied from the book:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span> <span class="n">If</span> <span class="n">the</span> <span class="n">value</span> <span class="n">starts</span> <span class="n">by</span> <span class="n">env</span><span class="p">,</span> <span class="n">gen</span><span class="p">,</span> <span class="n">bld</span> <span class="ow">or</span> <span class="n">tsk</span><span class="p">,</span> <span class="n">a</span> <span class="n">method</span> <span class="n">call</span> <span class="n">will</span> <span class="n">be</span> <span class="n">made</span>
<span class="mf">2.</span> <span class="n">If</span> <span class="n">the</span> <span class="n">value</span> <span class="n">starts</span> <span class="n">by</span> <span class="n">SRC</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="ow">or</span> <span class="n">TGT</span><span class="p">[</span><span class="n">n</span><span class="p">],</span> <span class="n">a</span> <span class="n">method</span> <span class="n">call</span> <span class="n">to</span> <span class="n">the</span>
   <span class="nb">input</span><span class="o">/</span><span class="n">output</span> <span class="n">node</span> <span class="n">n</span> <span class="n">will</span> <span class="n">be</span> <span class="n">made</span>
<span class="mf">3.</span> <span class="n">SRC</span> <span class="n">represents</span> <span class="n">the</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">task</span> <span class="n">inputs</span> <span class="n">seen</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">root</span> <span class="n">of</span> <span class="n">the</span> <span class="n">build</span> <span class="n">directory</span>
<span class="mf">4.</span> <span class="n">TGT</span> <span class="n">represents</span> <span class="n">the</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">task</span> <span class="n">outputs</span> <span class="n">seen</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">root</span> <span class="n">of</span> <span class="n">the</span> <span class="n">build</span> <span class="n">directory</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># whole wscript</span>
<span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="n">conf_ctx</span><span class="p">):</span>
    <span class="n">conf_ctx</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">MYVAR</span> <span class="o">=</span> <span class="s1">&#39;my variable&#39;</span>

<span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="n">build_ctx</span><span class="p">):</span>
    <span class="n">build_ctx</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="s1">&#39;echo $</span><span class="si">{MYVAR}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">always</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">build_ctx</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="s1">&#39;echo ${bld.bldnode.abspath()}&#39;</span><span class="p">,</span> <span class="n">always</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">build_ctx</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="s1">&#39;echo ${bld.srcnode.abspath()}&#39;</span><span class="p">,</span> <span class="n">always</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>gives:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ waf configure build
Setting top to                           : /Users/mb312/dev_trees/myproject
Setting out to                           : /Users/mb312/dev_trees/myproject/build
&#39;configure&#39; finished successfully (0.003s)
Waf: Entering directory `/Users/mb312/dev_trees/myproject/build&#39;
[2/3] echo ${MYVAR}:
[2/3] echo ${bld.bldnode.abspath()}:
my variable
[3/3] echo ${bld.srcnode.abspath()}:
/Users/mb312/dev_trees/myproject/build
/Users/mb312/dev_trees/myproject
Waf: Leaving directory `/Users/mb312/dev_trees/myproject/build&#39;
&#39;build&#39; finished successfully (0.030s)
</pre></div>
</div>
</div>
<div class="section" id="ipython-debugging-in-waf">
<h2>IPython debugging in waf<a class="headerlink" href="#ipython-debugging-in-waf" title="Permalink to this headline">¶</a></h2>
<p>As of the IPython development tree of Christmas 2013, this works to drop you
into the IPython shell from waf:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># the whole wscript</span>
<span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="n">conf_ctx</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="n">build_ctx</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">IPython</span> <span class="kn">import</span> <span class="n">embed</span>
    <span class="kn">from</span> <span class="nn">IPython.core.interactiveshell</span> <span class="kn">import</span> <span class="n">DummyMod</span>
    <span class="n">wscript_module</span> <span class="o">=</span> <span class="n">DummyMod</span><span class="p">()</span>
    <span class="n">wscript_module</span><span class="o">.</span><span class="vm">__dict__</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
    <span class="n">wscript_module</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">=</span> <span class="s1">&#39;wscript&#39;</span>
    <span class="n">embed</span><span class="p">(</span><span class="n">user_module</span><span class="o">=</span><span class="n">wscript_module</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Bare metal WAF</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#a-taster">A taster</a></li>
<li><a class="reference internal" href="#waf-commands">waf commands</a><ul>
<li><a class="reference internal" href="#special-commands">Special commands</a></li>
<li><a class="reference internal" href="#some-commands-use-the-build-callable-instead-of-their-own-callable">Some commands use the build callable instead of their own callable</a></li>
<li><a class="reference internal" href="#more-on-the-configure-command">More on the configure command</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-the-build-gets-built">How the build gets built</a><ul>
<li><a class="reference internal" href="#where-is-the-waf-code">Where is the waf code?</a></li>
<li><a class="reference internal" href="#high-level-api-for-creating-tasks">High level API for creating tasks</a></li>
<li><a class="reference internal" href="#nodes">Nodes</a></li>
<li><a class="reference internal" href="#creating-nodes">Creating nodes</a></li>
<li><a class="reference internal" href="#waf-creates-some-nodes-automatically-but-not-many">waf creates some nodes automatically, but not many</a></li>
<li><a class="reference internal" href="#specialized-noding-for-builds">Specialized noding for builds</a><ul>
<li><a class="reference internal" href="#build-and-source-nodes">build and source nodes</a></li>
<li><a class="reference internal" href="#where-s-my-node-build-or-source">Where’s my node - build or source?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#low-level-api-for-tasks">Low-level API for tasks</a></li>
</ul>
</li>
<li><a class="reference internal" href="#run-str-variable-substitution">run_str Variable substitution</a></li>
<li><a class="reference internal" href="#ipython-debugging-in-waf">IPython debugging in waf</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="develop_linux.html"
                        title="previous chapter">Developing on linux</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="windows_dll_links.html"
                        title="next chapter">Windows DLLs - information</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/bare_metal_waf.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="windows_dll_links.html" title="Windows DLLs - information"
             >next</a> |</li>
        <li class="right" >
          <a href="develop_linux.html" title="Developing on linux"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pydagogue 0.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="computing.html" >General computing</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Bare metal WAF</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2009-2016 - Matthew Brett.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.5.3.
    </div>
  </body>
</html>