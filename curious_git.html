<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The curious coder’s guide to git &mdash; pydagogue 0.2 documentation</title>
    
    <link rel="stylesheet" href="_static/traditional.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="pydagogue 0.2 documentation" href="index.html" />
    <link rel="up" title="Notes and tutorials on git" href="git.html" />
    <link rel="next" title="git remotes - working with other people, making backups" href="curious_remotes.html" />
    <link rel="prev" title="Notes and tutorials on git" href="git.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="curious_remotes.html" title="git remotes - working with other people, making backups"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="git.html" title="Notes and tutorials on git"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pydagogue 0.2 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="git.html" accesskey="U">Notes and tutorials on git</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="the-curious-coder-s-guide-to-git">
<h1>The curious coder&#8217;s guide to git<a class="headerlink" href="#the-curious-coder-s-guide-to-git" title="Permalink to this headline">¶</a></h1>
<div class="section" id="git-love-hate">
<h2>git - love - hate<a class="headerlink" href="#git-love-hate" title="Permalink to this headline">¶</a></h2>
<p>I&#8217;ve used git now for a long time.  I think it is a masterpiece of design, I
use it all day every day and I just can&#8217;t imagine what it would be like not to
use it. So, no question, I <em>love</em> git.</p>
<p>As y&#8217;all may know, <a class="reference external" href="http://git-scm.com/book/en/Getting-Started-A-Short-History-of-Git">Linus Torvalds wrote git from scratch</a>.  He
loves it too.  <a class="reference external" href="http://www.youtube.com/watch?v=MShbP3OpASA#t=2288">Here is Linus talking about git</a> in a question and answer
session:</p>
<blockquote>
<div>Actually I&#8217;m proud of git. I want to say this. The fact that I had to
write git was accidental, but Linux, the design came from a great mind,
and that great mind was not mine. I mean you have to give credit for the
design of Linux to Kernighan and Ritchie and Thompson. I mean there&#8217;s a
reason I like Unix and I wanted to redo it. I do want to say that git is a
design that is mine and unique, and I&#8217;m proud of the fact that I can damn
well also do good design from scratch.</div></blockquote>
<p>But some people hate git.  Really <em>hate</em> it. They find it confusing and
error prone and it makes them angry.  Why are there such different views?</p>
<p>I think the reason some people hate git, is because they don&#8217;t yet understand
it.  I reason I can say this without being patronizing is because I went
through something similar myself.</p>
<p>When I first started using git, I found it uncomfortable.  I could see it was
very powerful, but I sometimes got lost and stuck and had to Google for a set
of magic commands to get me out of trouble.  I once accidentally made a huge
mess of our project&#8217;s main repository by running a command I didn&#8217;t
understand. Git often made me feel stupid.  It felt like a prototype race car
with a badly designed dashboard that I couldn&#8217;t control, and that was about to
take me off the road, possibly at very high speed.</p>
<p>Then, one day, I read the <a class="reference external" href="http://practical-neuroimaging.github.io/git_parable.html">git parable</a>.  The git parable is a little story
about a developer trying to work out how to make a version control system.  It
gradually builds up from copying whole directories of files to something very
much like git.  I didn&#8217;t understand it all right away, but as soon as I read
that page, the light-bulb went on – I got git.  At once I started to feel
comfortable.  I knew that I could work out why git worked the way it did.  I
could see that it must be possible to do complicated and powerful things, and
I could work out how to do them.</p>
<p>Reading the git parable took me about 45 minutes, but those 45 minutes changed
me from an unhappy git user to someone who uses git often every day, but,
happily, knowing that I have the right tool for the job.</p>
<p>So, my experience tells me that to use git – yes <em>use</em> git – you need to
spend the short amount of time it takes to <em>understand</em> git.  You don&#8217;t
believe me, or you think that I&#8217;m a strange kind of person not like you who
probably likes writing their own operating systems. Not so - the insight I&#8217;m
describing comes up over and over. From the <a class="reference external" href="http://practical-neuroimaging.github.io/git_parable.html">git parable</a>:</p>
<blockquote>
<div>Most people try to teach Git by demonstrating a few dozen commands and
then yelling “tadaaaaa.” I believe this method is flawed. Such a treatment
may leave you with the ability to use Git to perform simple tasks, but the
Git commands will still feel like magical incantations. Doing anything out
of the ordinary will be terrifying. Until you understand the concepts upon
which Git is built, you’ll feel like a stranger in a foreign land.</div></blockquote>
<p>From <a class="reference external" href="http://www.sbf5.com/~cduan/technical/git">understanding git conceptually</a>:</p>
<blockquote>
<div>When I first started using Git, I read plenty of tutorials, as well as the
user manual. Though I picked up the basic usage patterns and commands, I
never felt like I grasped what was going on “under the hood,” so to speak.
Frequently this resulted in cryptic error messages, caused by my random
guessing at the right command to use at a given time. These difficulties
worsened as I began to need more advanced (and less well documented)
features.</div></blockquote>
<p>Here&#8217;s a quote from the <a class="reference external" href="http://git-scm.com/book">pro git book</a> by Scott
Chacon.  The git book is a standard reference that is hosted on the main git
website.</p>
<blockquote>
<div><p>Chapter 9: Git Internals</p>
<p>You may have skipped to this chapter from a previous chapter, or you may
have gotten here after reading the rest of the book – in either case,
this is where you’ll go over the inner workings and implementation of Git.
I found that learning this information was fundamentally important to
understanding how useful and powerful Git is, but others have argued to me
that it can be confusing and unnecessarily complex for beginners. Thus,
I&#8217;ve made this discussion the last chapter in the book so you could read
it early or later in your learning process. I leave it up to you to
decide.</p>
</div></blockquote>
<p>So – have no truck with people who try and tell you that you can just use
git and that you don&#8217;t need the <a class="reference external" href="http://rogerdudler.github.io/git-guide">deep shit</a>. You <em>do</em> need the deep shit, but
the deep shit isn&#8217;t that deep, and it will take you an hour of your time to
get all of it.  Then I&#8217;m betting that you&#8217;ll see that the alchemist has
succeeded at last, and the – er – lead has finally turned into gold.</p>
<p>So – please – invest an hour and a half of your life to understand this
stuff.  Concentrate, go slowly, make sure you get it. In return for 90 minutes
you will get many happy years for which git will appear in its true form, both
beautiful and useful.</p>
<div class="section" id="the-one-thing-about-git-you-really-need-to-understand">
<h3>The one thing about git you really need to understand<a class="headerlink" href="#the-one-thing-about-git-you-really-need-to-understand" title="Permalink to this headline">¶</a></h3>
<p>git is not really a &#8220;Version Control System&#8221;. It is better described
as a &#8220;Content Management System&#8221;, that turns out to be really good for
version control.</p>
<p>I&#8217;ll say that again.  Git is a content management system.  To quote from the
<a class="reference external" href="http://git-scm.com/docs/git.html">root page of the git manual</a>: &#8220;git - the
stupid content tracker&#8221;.</p>
<p>The reason that this is important is that git thinks in a very simple way
about files and directories.  You will ask git to keep snapshots of files in a
directory, and it does just this; it stores snapshots of the files, so you can
go back to them later.</p>
<p>Here is a story where we develop a very simple system for storing file
snapshots.  We soon find it starts to look just like git.</p>
</div>
</div>
<div class="section" id="a-familiar-story">
<h2>A familiar story<a class="headerlink" href="#a-familiar-story" title="Permalink to this headline">¶</a></h2>
<p>To understand why git does what it does, we first need to think about what a
content manager should do, and why we would want one.</p>
<p>If you&#8217;ve read the <a class="reference external" href="http://practical-neuroimaging.github.io/git_parable.html">git parable</a> (please do), then you&#8217;ll recognize many of
the ideas.  Why?  Because they are good ideas, worthy of re-use.</p>
<p>As in the <a class="reference external" href="http://practical-neuroimaging.github.io/git_parable.html">git parable</a>, we will try and design our own content manager, and
then see what git has to say.</p>
<p>(If you don&#8217;t mind reading some Python code, and more jokes, then also try my
<a class="reference internal" href="foundation.html"><em>Git foundations</em></a> page).</p>
<p>While we are designing our own content management system, we will do a lot of
stuff longhand, to show how things work.  When we get to git, we will find it
does these tasks for us.</p>
<div class="section" id="the-story-so-far">
<h3>The story so far...<a class="headerlink" href="#the-story-so-far" title="Permalink to this headline">¶</a></h3>
<p>You are writing a breakthrough paper showing that you can explain how the
brain works by careful processing of some interesting data.  You&#8217;ve got the
analysis script, the data file and a figure for the paper.  These are all in a
directory modestly named <code class="docutils literal"><span class="pre">nobel_prize</span></code>.</p>
<p>You can get this, the first draft, by downloading and unzipping
<a class="reference download internal" href="_downloads/nobel_prize.zip"><code class="xref download docutils literal"><span class="pre">nobel_prize</span></code></a>.</p>
<p>Here&#8217;s the current contents of our <code class="docutils literal"><span class="pre">nobel_prize</span></code> directory:</p>
<div class="highlight-none"><div class="highlight"><pre>nobel_prize
├── clever_analysis.py [618B]
├── expensive_data.csv [244K]
└── fancy_figure.png [183K]
</pre></div>
</div>
</div>
<div class="section" id="the-dog-ate-my-results">
<h3>The dog ate my results<a class="headerlink" href="#the-dog-ate-my-results" title="Permalink to this headline">¶</a></h3>
<p>You&#8217;ve been working on this study for a while.</p>
<p>At first, you were very excited with the results. You ran the script, made the
figure, and the figure looked good.  That&#8217;s the figure you currently have in
<code class="docutils literal"><span class="pre">nobel_prize</span></code> directory. You took this figure to your advisor, Josephine.
She was excited too. You get ready to publish in Science.</p>
<p>You&#8217;ve done a few changes to the script and figure since then.  Today you
finished cleaning up for the Science paper, and reran the analysis, and it
doesn&#8217;t quite the same. You go to see Josephine. She says &#8220;It used to look
better than that&#8221;. That&#8217;s what you think too. But:</p>
<ul class="simple">
<li><strong>Did it really look different before?</strong></li>
<li>If it did, <strong>what caused the change in the figure?</strong></li>
</ul>
</div>
<div class="section" id="deja-vu-all-over-again">
<h3>Deja vu all over again<a class="headerlink" href="#deja-vu-all-over-again" title="Permalink to this headline">¶</a></h3>
<p>Given you are so clever and you have discovered how the brain works, it is
really easy for you to leap in your time machine, and go back two weeks to
start again.</p>
<p>What are you going to do differently this time?</p>
</div>
<div class="section" id="gitwards-1-make-regular-snapshots">
<h3>Gitwards 1: make regular snapshots<a class="headerlink" href="#gitwards-1-make-regular-snapshots" title="Permalink to this headline">¶</a></h3>
<p>You decide to make your own content management system.  It&#8217;s the simplest
thing that could possibly work, so you call it the &#8220;Simple As Possible&#8221;
system, or SAP for short.</p>
<p>Every time you finish doing some work on your paper, you make a snapshot
of the analysis directory.</p>
<p>The snapshot is a copy of all the files in the working directory.</p>
<p>First you make a directory called <code class="docutils literal"><span class="pre">working</span></code>, and move your files to that
directory:</p>
<div class="highlight-none"><div class="highlight"><pre>nobel_prize
└── working
    ├── clever_analysis.py [618B]
    ├── expensive_data.csv [244K]
    └── fancy_figure.png [183K]
</pre></div>
</div>
<p>When you&#8217;ve finished work for the day, you make a snapshot of the directory
containing the files you are working on.  The snapshot is just a copy of your
working directory:</p>
<div class="highlight-none"><div class="highlight"><pre>nobel_prize
├── working
│   ├── clever_analysis.py [618B]
│   ├── expensive_data.csv [244K]
│   └── fancy_figure.png [183K]
└── snapshot_1
    ├── clever_analysis.py [618B]
    ├── expensive_data.csv [244K]
    └── fancy_figure.png [183K]
</pre></div>
</div>
<p>You are going to do this every day you work on the project.</p>
<p>On the second day, you add your first draft of the paper, <code class="docutils literal"><span class="pre">nobel_prize.md</span></code>.
You can download this ground-breaking work at <a class="reference download internal" href="_downloads/nobel_prize.md"><code class="xref download docutils literal"><span class="pre">nobel_prize.md</span></code></a>.</p>
<div class="highlight-none"><div class="highlight"><pre>nobel_prize
├── working
│   ├── clever_analysis.py [618B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [183K]
│   └── nobel_prize.md [730B]
└── snapshot_1
    ├── clever_analysis.py [618B]
    ├── expensive_data.csv [244K]
    └── fancy_figure.png [183K]
</pre></div>
</div>
<p>At the end of the day you make your second snapshot:</p>
<div class="highlight-none"><div class="highlight"><pre>nobel_prize
├── working
│   ├── clever_analysis.py [618B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [183K]
│   └── nobel_prize.md [730B]
├── snapshot_2
│   ├── clever_analysis.py [618B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [183K]
│   └── nobel_prize.md [730B]
└── snapshot_1
    ├── clever_analysis.py [618B]
    ├── expensive_data.csv [244K]
    └── fancy_figure.png [183K]
</pre></div>
</div>
<p>On the third day, you did some edits to the analysis script, and refreshed the
figure by running the script.  You did a third snapshot.</p>
<div class="highlight-none"><div class="highlight"><pre>nobel_prize
├── working
│   ├── clever_analysis.py [716B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [239K]
│   └── nobel_prize.md [730B]
├── snapshot_3
│   ├── clever_analysis.py [716B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [239K]
│   └── nobel_prize.md [730B]
├── snapshot_2
│   ├── clever_analysis.py [618B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [183K]
│   └── nobel_prize.md [730B]
└── snapshot_1
    ├── clever_analysis.py [618B]
    ├── expensive_data.csv [244K]
    └── fancy_figure.png [183K]
</pre></div>
</div>
<p>To make the directory listing more compact, I&#8217;ll sometimes show only the
number of files / directories in a subdirectory.  For example, here&#8217;s a
listing of the three snapshots, but only showing the contents of the third
snapshot:</p>
<div class="highlight-none"><div class="highlight"><pre>nobel_prize
├── working
│   ├── clever_analysis.py [716B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [239K]
│   └── nobel_prize.md [730B]
├── snapshot_3
│   ├── clever_analysis.py [716B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [239K]
│   └── nobel_prize.md [730B]
├── snapshot_2
│   (4 files)
└── snapshot_1
    (3 files)
</pre></div>
</div>
<p>Finally, on the fourth day, you make some more edits to the script, and you
add some references for the paper.</p>
<div class="highlight-none"><div class="highlight"><pre>nobel_prize
├── working
│   ├── clever_analysis.py [752B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [251K]
│   ├── nobel_prize.md [730B]
│   └── references.bib [244B]
├── snapshot_4
│   ├── clever_analysis.py [752B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [251K]
│   ├── nobel_prize.md [730B]
│   └── references.bib [244B]
├── snapshot_3
│   (4 files)
├── snapshot_2
│   (4 files)
└── snapshot_1
    (3 files)
</pre></div>
</div>
<p>You are ready for your fateful meeting with Josephine.  Again she notices that
the figure is different from the first time you showed her.  This time you can
go and look in <code class="docutils literal"><span class="pre">nobel_prize/snapshot_1</span></code> to see if the figure really is
different.  Then you can go through the snapshots to see where the figure
changed.</p>
<p>You&#8217;ve already got a useful content management system, but you are going to
make it better.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>We are already at the stage where we can define some <a class="reference external" href="https://www.kernel.org/pub/software/scm/git/docs/gitglossary.html">terms</a> that
apply to our system and that will later apply to git:</p>
<dl class="last docutils">
<dt>Commit</dt>
<dd>A completed snapshot. For example, <code class="docutils literal"><span class="pre">snapshot_1</span></code> contains one commit.</dd>
<dt>Working tree</dt>
<dd>The files you are working on in <code class="docutils literal"><span class="pre">nobel_prize/working</span></code>.</dd>
</dl>
</div>
</div>
<div class="section" id="gitwards-2-reminding-yourself-of-what-you-did">
<h3>Gitwards 2: reminding yourself of what you did<a class="headerlink" href="#gitwards-2-reminding-yourself-of-what-you-did" title="Permalink to this headline">¶</a></h3>
<p>Your experience tracking down the change in the figure makes you think that it
would be good to save a message with each snapshot (commit) to record the
commit date and something about what changes you made.  Next time you need
to track down when and why something changed, you can look at the message to
give yourself an idea of the changes in the commit.  That might save you
time when you want to narrow down where to look for problems.</p>
<p>So, for each commit, you write write a file called <code class="docutils literal"><span class="pre">message.txt</span></code>. The
message for the first commit looks like this:</p>
<div class="admonition">
<em class="first">Contents of </em><code class="docutils literal"><span class="pre">snapshot_1/message.txt</span></code><div class="last highlight-none"><div class="highlight"><pre>Date: April 1 2012, 14.30
Author: I. M. Awesome
Notes: First backup of my amazing idea
</pre></div>
</div>
</div>
<p>There is a similar <code class="docutils literal"><span class="pre">messsage.txt</span></code> file for each commit. For example,
here&#8217;s the message for the third commit:</p>
<div class="admonition">
<em class="first">Contents of </em><code class="docutils literal"><span class="pre">snapshot_3/message.txt</span></code><div class="last highlight-none"><div class="highlight"><pre>Date: April 3 2012, 11.20
Author: I. M. Awesome
Notes: Add another fudge factor
</pre></div>
</div>
</div>
<p>This third message is useful because it gives you a hint that this was where
you made the important change to the script and figure.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<dl class="last docutils">
<dt>Commit message</dt>
<dd>Information about a commit, including the author, date, time, and some
information about the changes in the commit, compared to the previous
commits.</dd>
</dl>
</div>
</div>
<div class="section" id="gitwards-3-breaking-up-work-into-chunks">
<h3>Gitwards 3: breaking up work into chunks<a class="headerlink" href="#gitwards-3-breaking-up-work-into-chunks" title="Permalink to this headline">¶</a></h3>
<p>Now you are used to having the commit messages in <code class="docutils literal"><span class="pre">message.txt</span></code>, you aren&#8217;t
so pleased with your fourth commit.  You now prefer to break your changes up
into self-contained chunks of work, with a matching commit message.  But,
looking at your fourth commit, it looks like you included two separate chunks
of work:</p>
<p>You decide to break this commit into two separate commits:</p>
<ul class="simple">
<li>A commit with the changes to the analysis script and figure, but without
the references;</li>
<li>Another commit to add the references.</li>
</ul>
<p>To do this kind of thing, you adapt the workflow. Each time you have done a
commit, you copy the contents of the commit to new directory called
<code class="docutils literal"><span class="pre">staging</span></code>. This directory will become the contents for your next commit.
You can add changes from your working tree by copying the changed file into
<code class="docutils literal"><span class="pre">staging</span></code>.  When <code class="docutils literal"><span class="pre">staging</span></code> contains the changes you want, you make the
commit by copying <code class="docutils literal"><span class="pre">staging</span></code> into its own commit directory.</p>
<p>To get started, first you delete the old <code class="docutils literal"><span class="pre">snapshot_4</span></code>.  Next you replace the
contents of <code class="docutils literal"><span class="pre">staging</span></code> with the contents of <code class="docutils literal"><span class="pre">snapshot_3</span></code>.  You already have
the two sets of changes ready to stage in <code class="docutils literal"><span class="pre">working</span></code>.</p>
<div class="highlight-none"><div class="highlight"><pre>nobel_prize
├── working
│   ├── clever_analysis.py [752B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [251K]
│   ├── nobel_prize.md [730B]
│   └── references.bib [244B]
├── staging
│   ├── clever_analysis.py [716B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [239K]
│   └── nobel_prize.md [730B]
├── snapshot_3
│   ├── clever_analysis.py [716B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [239K]
│   ├── nobel_prize.md [730B]
│   └── message.txt [80B]
...
</pre></div>
</div>
<p>Call the <code class="docutils literal"><span class="pre">staging</span></code> directory – the <strong>staging area</strong>.  Your new sequence
for making a commit is:</p>
<ul class="simple">
<li>Make sure the contents of the last commit are in the staging area;</li>
<li>Copy any changes for the next commit from the working tree to the staging
area;</li>
<li>Make the commit by taking a snapshot of the staging area.</li>
</ul>
<p>You are doing this by hand, but later git will make this much more automatic.</p>
<p>First you copy the changes you want from the working tree to the staging area:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>cp working/clever_analysis.py staging
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>cp working/fancy_figure.png staging
</pre></div>
</div>
<p>The staging directory (staging area) now contains the right files for the
first of your two commits.</p>
<p>Next you make a commit by copying the staging area to <code class="docutils literal"><span class="pre">snapshot_4</span></code> and
adding a message:</p>
<div class="admonition">
<em class="first">Contents of </em><code class="docutils literal"><span class="pre">snapshot_4/message.txt</span></code><div class="last highlight-none"><div class="highlight"><pre>Date: April 4 2012, 01.40
Author: I. M. Awesome
Notes: Change parameters of analysis
</pre></div>
</div>
</div>
<p>This gives:</p>
<div class="highlight-none"><div class="highlight"><pre>nobel_prize
├── working
│   ├── clever_analysis.py [752B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [251K]
│   ├── nobel_prize.md [730B]
│   └── references.bib [244B]
├── staging
│   ├── clever_analysis.py [752B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [251K]
│   └── nobel_prize.md [730B]
├── snapshot_4
│   ├── clever_analysis.py [752B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [251K]
│   ├── nobel_prize.md [730B]
│   └── message.txt [85B]
...
</pre></div>
</div>
<p>To finish, you make the second of the two commits.  Remember the sequence:</p>
<ul class="simple">
<li>Make sure the contents of the last commit are in the staging area;</li>
<li>Copy any changes for the next commit from the working tree to the staging
area;</li>
<li>Make the commit by taking a snapshot of the staging area.</li>
</ul>
<p>The staging area already contains the contents of the last commit (now
<code class="docutils literal"><span class="pre">snapshot_4</span></code>).  You copy the rest of the changes to the staging area:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>cp working/references.bib staging
</pre></div>
</div>
<p>Finally, you do the commit by copying <code class="docutils literal"><span class="pre">staging</span></code> to <code class="docutils literal"><span class="pre">snapshot_5</span></code>, and
adding a commit message:</p>
<div class="admonition">
<em class="first">Contents of </em><code class="docutils literal"><span class="pre">snapshot_5/message.txt</span></code><div class="last highlight-none"><div class="highlight"><pre>Date: April 4 2012, 02.10
Author: I. M. Awesome
Notes: Add references
</pre></div>
</div>
</div>
<p>Now you have:</p>
<div class="highlight-none"><div class="highlight"><pre>nobel_prize
├── working
│   ├── clever_analysis.py [752B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [251K]
│   ├── nobel_prize.md [730B]
│   └── references.bib [244B]
├── staging
│   ├── clever_analysis.py [752B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [251K]
│   ├── nobel_prize.md [730B]
│   └── references.bib [244B]
├── snapshot_5
│   ├── clever_analysis.py [752B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [251K]
│   ├── nobel_prize.md [730B]
│   ├── references.bib [244B]
│   └── message.txt [70B]
...
</pre></div>
</div>
<p>Now we can add a new term to our vocabulary:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<dl class="last docutils">
<dt>Staging area</dt>
<dd>Temporary area that contains the contents of the next commit.  We copy
changes from the working tree to the staging area to <strong>stage</strong> those
changes.  We make the new <strong>commit</strong> from the contents of the
<strong>staging area</strong>.</dd>
</dl>
</div>
</div>
<div class="section" id="gitwards-4-getting-files-from-previous-commits">
<h3>Gitwards 4: getting files from previous commits<a class="headerlink" href="#gitwards-4-getting-files-from-previous-commits" title="Permalink to this headline">¶</a></h3>
<p>Remember that you found the figure had changed?</p>
<p>You also found that the problem was in the third commit.</p>
<p>Now you look back over the commits, you realize that your first draft of the
analysis script was correct, and you decide to restore that.</p>
<p>To do that, you will <strong>checkout</strong> the script from the first commit
(<code class="docutils literal"><span class="pre">snapshot_1</span></code>).  You also want to checkout the generated figure.</p>
<p>Following our new standard staging workflow, that means:</p>
<ul class="simple">
<li>Get the files you want from the old commit into the working directory, and
the staging area;</li>
<li>Make a new commit from the staging area.</li>
</ul>
<p>For our simple SAP system, that looks like this:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span><span class="c"># Copy files from old commit to working tree</span>
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>cp snapshot_1/clever_analysis.py working
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>cp snapshot_1/fancy_figure.png working
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span><span class="c"># Copy files from working tree to staging area</span>
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>cp working/clever_analysis.py staging
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>cp working/fancy_figure.png staging
</pre></div>
</div>
<p>Then do the commit by copying <code class="docutils literal"><span class="pre">staging</span></code>, and add a message:</p>
<div class="admonition">
<em class="first">Contents of </em><code class="docutils literal"><span class="pre">snapshot_6/message.txt</span></code><div class="last highlight-none"><div class="highlight"><pre>Date: April 5 2012, 18.40
Author: I. M. Awesome
Notes: Revert to original script &amp; figure
</pre></div>
</div>
</div>
<p>This gives:</p>
<div class="highlight-none"><div class="highlight"><pre>nobel_prize
├── working
│   ├── clever_analysis.py [618B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [183K]
│   ├── nobel_prize.md [730B]
│   └── references.bib [244B]
├── staging
│   ├── clever_analysis.py [618B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [183K]
│   ├── nobel_prize.md [730B]
│   └── references.bib [244B]
├── snapshot_6
│   ├── clever_analysis.py [618B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [183K]
│   ├── nobel_prize.md [730B]
│   ├── references.bib [244B]
│   └── message.txt [90B]
├── snapshot_5
│   (6 files)
├── snapshot_4
│   (5 files)
├── snapshot_3
│   (5 files)
├── snapshot_2
│   (5 files)
└── snapshot_1
    ├── clever_analysis.py [618B]
    ├── expensive_data.csv [244K]
    ├── fancy_figure.png [183K]
    └── message.txt [87B]
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<dl class="last docutils">
<dt>Checkout (a file)</dt>
<dd>To <strong>checkout</strong> a file is to restore the copy of a file as stored in a
particular commit.</dd>
</dl>
</div>
</div>
<div class="section" id="gitwards-5-two-people-working-at-the-same-time">
<h3>Gitwards 5: two people working at the same time<a class="headerlink" href="#gitwards-5-two-people-working-at-the-same-time" title="Permalink to this headline">¶</a></h3>
<p>One reason that git is so powerful is that it works very well when more than
one person is working on the files in parallel.</p>
<p>Josephine is impressed with your SAP content management system, and wants to
use it to make some edits to the paper.  She takes a copy of your
<code class="docutils literal"><span class="pre">nobel_prize</span></code> directory to put on her laptop.</p>
<p>She goes away for a conference.</p>
<p>While she is away, you do some work on the analysis script, and regenerate the
figure, to make <code class="docutils literal"><span class="pre">shapshot_7</span></code>:</p>
<div class="highlight-none"><div class="highlight"><pre>nobel_prize
├── working
│   ├── clever_analysis.py [692B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [279K]
│   ├── nobel_prize.md [730B]
│   └── references.bib [244B]
├── staging
│   (5 files)
├── snapshot_7
│   ├── clever_analysis.py [692B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [279K]
│   ├── nobel_prize.md [730B]
│   ├── references.bib [244B]
│   └── message.txt [75B]
...
</pre></div>
</div>
<p>Meanwhile, Josephine decides to work on the paper.  Following your procedure,
she makes a commit herself.</p>
<p>What should Josephine&#8217;s commit directory be called?</p>
<p>She could call it <code class="docutils literal"><span class="pre">snapshot_7</span></code>, but then, when she gets back to the lab, and
gives you her <code class="docutils literal"><span class="pre">nobel_prize</span></code> directory, her copy of <code class="docutils literal"><span class="pre">nobel_prize</span></code> and yours
will both have a <code class="docutils literal"><span class="pre">snapshot_7</span></code> directory, but they will be different.  It
would be easy to copy Josephine&#8217;s directory over yours or yours over
Josephine&#8217;s, and lose the work.</p>
<p>For the moment, you decide that Josephine will attach her name to the commit
directory, to make it clear this is her snapshot.  So, she makes her commit
into the directory <code class="docutils literal"><span class="pre">snapshot_7_josephine</span></code>.  When she comes back from the
conference, you copy her <code class="docutils literal"><span class="pre">snapshot_7_josephine</span></code> into your <code class="docutils literal"><span class="pre">nobel_prize</span></code>
directory:</p>
<div class="highlight-none"><div class="highlight"><pre>nobel_prize
├── working
│   ├── clever_analysis.py [692B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [279K]
│   ├── nobel_prize.md [730B]
│   └── references.bib [244B]
├── staging
│   (5 files)
├── snapshot_7_josephine
│   ├── clever_analysis.py [618B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [183K]
│   ├── nobel_prize.md [979B]
│   ├── references.bib [244B]
│   └── message.txt [80B]
├── snapshot_7
│   ├── clever_analysis.py [692B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [279K]
│   ├── nobel_prize.md [730B]
│   ├── references.bib [244B]
│   └── message.txt [75B]
...
</pre></div>
</div>
<p>After the copy, you still have your own copy of the working tree, without
Josephine&#8217;s changes to the paper. You want to combine your changes with her
changes.  To do this you do a <strong>merge</strong> by copying her changes to the paper
into the working directory.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span><span class="c"># Get Josephine&#39;s changes to the paper</span>
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>cp snapshot_7_josephine/nobel_prize.md working
</pre></div>
</div>
<p>Now you do a commit with these merged changes, by copying them into the
staging area, and thence to <code class="docutils literal"><span class="pre">snapshot_8</span></code>, with a suitable message:</p>
<div class="highlight-none"><div class="highlight"><pre>nobel_prize
├── working
│   ├── clever_analysis.py [692B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [279K]
│   ├── nobel_prize.md [979B]
│   └── references.bib [244B]
├── staging
│   ├── clever_analysis.py [692B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [279K]
│   ├── nobel_prize.md [979B]
│   └── references.bib [244B]
├── snapshot_8
│   ├── clever_analysis.py [692B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [279K]
│   ├── nobel_prize.md [979B]
│   ├── references.bib [244B]
│   └── message.txt [82B]
├── snapshot_7_josephine
│   ├── clever_analysis.py [618B]
│   ├── expensive_data.csv [244K]
│   ├── fancy_figure.png [183K]
│   ├── nobel_prize.md [979B]
│   ├── references.bib [244B]
│   └── message.txt [80B]
...
</pre></div>
</div>
<p>This new commit is the result of a merge, and therefore it is a <strong>merge
commit</strong>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<dl class="last docutils">
<dt>Merge</dt>
<dd>To make a new <strong>merge commit</strong> by combining changes from two (or
more) commits.</dd>
</dl>
</div>
</div>
<div class="section" id="gitwards-6-how-should-you-name-your-commit-directories">
<h3>Gitwards 6: how should you name your commit directories?<a class="headerlink" href="#gitwards-6-how-should-you-name-your-commit-directories" title="Permalink to this headline">¶</a></h3>
<p>You like your new system, and so does Josephine, but you don&#8217;t much like your
solution of adding Josephine&#8217;s name to the commit directory – as in
<code class="docutils literal"><span class="pre">snapshot_7_josephine</span></code>.  There might be lots of people working on this
paper.  With your naming system, you have to give out a unique name to each
person working on <code class="docutils literal"><span class="pre">nobel_prize</span></code>.  As you think about this problem, you begin
to realize that what you want is a system for giving each commit directory a
unique name, that comes from the contents of the commit.  This is where you
starting thinking about <strong>hashes</strong>.</p>
</div>
<div class="section" id="a-diversion-on-cryptographic-hashes">
<h3>A diversion on cryptographic hashes<a class="headerlink" href="#a-diversion-on-cryptographic-hashes" title="Permalink to this headline">¶</a></h3>
<p>This section describes &#8220;Cryptographic hashes&#8221;. These will give us an excellent
way to name our snapshots.  Later we will see that they are central to the way
that git works.</p>
<p>See : <a class="reference external" href="http://en.wikipedia.org/wiki/Cryptographic_hash_function">Wikipedia on hash
functions</a>.</p>
<p>A <em>hash</em> is the result of running a <em>hash function</em> over a block of
data. The hash is a fixed length string that is the characteristic
<em>fingerprint</em> of that exact block of data.  One common hash function is called
SHA1.  Let&#8217;s run this via the command line:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span><span class="c"># Make a file with a single line of text</span>
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">&quot;git is a rude word in UK English&quot;</span> &gt; git_is_rude
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span><span class="c"># Show the SHA1 hash</span>
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>shasum git_is_rude
30ad6c360a692c1fe66335bb00d00e0528346be5  git_is_rude
</pre></div>
</div>
<p>Not too exciting so far. However, the rather magical nature of this string is
not yet apparent. This SHA1 hash is a <em>cryptographic</em> hash because:</p>
<ul class="simple">
<li>the hash value is (almost) unique to this exact file contents, and</li>
<li>it is (almost) impossible to find some other file contents with the same
hash.</li>
</ul>
<p>By &#8220;almost impossible&#8221; I mean that finding a file with the same hash is
roughly the same level of difficulty as trying something like <span class="math">\(16^{40}\)</span>
different files (where 16 is the number of different hexadecimal digits, and
40 is the length of the SHA1 string).</p>
<p>In other words, there is no practical way for you to find another file with
different contents that will give the same hash.</p>
<p>For example, a tiny change in the string makes the hash completely different.
Here I&#8217;ve just added a full stop at the end:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span><span class="nb">echo</span> <span class="s2">&quot;git is a rude word in UK English.&quot;</span> &gt; git_is_rude_stop
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>shasum git_is_rude_stop
23d97b00299c250b43049be67c97cf2e5ffc2428  git_is_rude_stop
</pre></div>
</div>
<p>So, if you give me some data, and I calculate the SHA1 hash value, and it
comes out as <code class="docutils literal"><span class="pre">30ad6c360a692c1fe66335bb00d00e0528346be5</span></code>, then I can be very
sure that the data you gave me was exactly the ASCII string &#8220;git is a rude
word in UK English&#8221;.</p>
</div>
<div class="section" id="gitwards-7-naming-commits-from-hashes">
<span id="naming-from-hashes"></span><h3>Gitwards 7: naming commits from hashes<a class="headerlink" href="#gitwards-7-naming-commits-from-hashes" title="Permalink to this headline">¶</a></h3>
<p>Now you have hashing under your belt, maybe it would be a good way of making a
unique name for the commits.  You could take the SHA1 hash for the
<code class="docutils literal"><span class="pre">message.txt</span></code> for each commit, and use that SHA1 hash as the name for the
commit directory.  Because each message has the date and time and author and
notes, it&#8217;s very unlikely that any two <code class="docutils literal"><span class="pre">message.txt</span></code> files will be the same.
Here are the hashes for the current <code class="docutils literal"><span class="pre">message.txt</span></code> files:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span><span class="c"># Show the SHA1 hash values for each message.txt</span>
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>shasum snapshot*/message.txt
99b52473039acea4427e13e42b96c78776e2baf5  snapshot_1/message.txt
d396475cc691c8ac7ba7a318726f220c924cf60b  snapshot_2/message.txt
6a04028960ead9e8db180dd6ebc108e1fc52891d  snapshot_3/message.txt
1bae5edb2785ae73353ae8a691cdb45d182db0c6  snapshot_4/message.txt
2bef6ebeef1dee1610f6581e42fa1a74045042c2  snapshot_5/message.txt
5709c1f836244dc039f05e5d3b0c31267ee785c5  snapshot_6/message.txt
62f0c997a4ddbfe07d6d2524d23883a3ac6ac051  snapshot_7/message.txt
4063178db6bf986c679bfc2c4dde01092146d197  snapshot_7_josephine/message.txt
df3e787c2a89ac991b1c89b39fb014c1f049a939  snapshot_8/message.txt
</pre></div>
</div>
<p>For example you could rename the <code class="docutils literal"><span class="pre">snapshot_1</span></code> directory to <code class="docutils literal"><span class="pre">99b52473039acea4427e13e42b96c78776e2baf5</span></code>,
then rename <code class="docutils literal"><span class="pre">snapshot_2</span></code> to <code class="docutils literal"><span class="pre">d396475cc691c8ac7ba7a318726f220c924cf60b</span></code> and so on.</p>
<div class="highlight-none"><div class="highlight"><pre>nobel_prize
├── working
│   (5 files)
├── staging
│   (5 files)
├── df3e787c2a89ac991b1c89b39fb014c1f049a939
│   (6 files)
├── 4063178db6bf986c679bfc2c4dde01092146d197
│   (6 files)
├── 62f0c997a4ddbfe07d6d2524d23883a3ac6ac051
│   (6 files)
├── 5709c1f836244dc039f05e5d3b0c31267ee785c5
│   (6 files)
├── 2bef6ebeef1dee1610f6581e42fa1a74045042c2
│   (6 files)
├── 1bae5edb2785ae73353ae8a691cdb45d182db0c6
│   (5 files)
├── 6a04028960ead9e8db180dd6ebc108e1fc52891d
│   (5 files)
├── d396475cc691c8ac7ba7a318726f220c924cf60b
│   (5 files)
└── 99b52473039acea4427e13e42b96c78776e2baf5
    (4 files)
</pre></div>
</div>
<p>The problem you have now is that the directory names no longer tell you the
sequence of the commits, so you can&#8217;t tell that <code class="docutils literal"><span class="pre">snapshot_2</span></code> (now
<code class="docutils literal"><span class="pre">d396475cc691c8ac7ba7a318726f220c924cf60b</span></code>) follows <code class="docutils literal"><span class="pre">snapshot_1</span></code> (now <code class="docutils literal"><span class="pre">99b52473039acea4427e13e42b96c78776e2baf5</span></code>).</p>
<p>OK – you scratch the renaming for now while you have a rethink.</p>
<div class="highlight-none"><div class="highlight"><pre>nobel_prize
├── working
│   (5 files)
├── staging
│   (5 files)
├── snapshot_8
│   (6 files)
├── snapshot_7_josephine
│   (6 files)
├── snapshot_7
│   (6 files)
├── snapshot_6
│   (6 files)
├── snapshot_5
│   (6 files)
├── snapshot_4
│   (5 files)
├── snapshot_3
│   (5 files)
├── snapshot_2
│   (5 files)
└── snapshot_1
    (4 files)
</pre></div>
</div>
<p>You still want to rename the commit directories, from the <code class="docutils literal"><span class="pre">message.txt</span></code>
hashes, but you need a way to store the sequence of commits, after you have
done this.</p>
<p>After some thought, you come up with a quite brilliant idea.  Each
<code class="docutils literal"><span class="pre">message.txt</span></code> will point back to the previous commit in the sequence.  You
add a new field to <code class="docutils literal"><span class="pre">messsage.txt</span></code> called <code class="docutils literal"><span class="pre">Parents</span></code>.
<code class="docutils literal"><span class="pre">snapshot_1/message.txt</span></code> stays the same, because it has no parents:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>cat snapshot_1/message.txt
Date: April <span class="m">1</span> 2012, 14.30
Author: I. M. Awesome
Notes: First backup of my amazing idea
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">snapshot_2/message.txt</span></code> does change, because it now points back to
<code class="docutils literal"><span class="pre">snapshot_1</span></code>.  But, you&#8217;re going to rename the snapshot directories, so you
want <code class="docutils literal"><span class="pre">snapshot_2/message.txt</span></code> to point back to the hash for
<code class="docutils literal"><span class="pre">snapshot_1/message.txt</span></code>, which you know is <code class="docutils literal"><span class="pre">99b52473039acea4427e13e42b96c78776e2baf5</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>cat snapshot_2/message.txt
Date: April <span class="m">2</span> 2012, 18.03
Author: I. M. Awesome
Notes: Add first draft of paper
Parents: 99b52473039acea4427e13e42b96c78776e2baf5
</pre></div>
</div>
<p>Now we&#8217;ve changed the contents and therefore the hash for
<code class="docutils literal"><span class="pre">snapshot_2/message.txt</span></code>.  The hash was <code class="docutils literal"><span class="pre">d396475cc691c8ac7ba7a318726f220c924cf60b</span></code>, but now it
is:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>shasum snapshot_2/message.txt
9bf4cdd8847feeb49fe94cb96298acf7986a587d  snapshot_2/message.txt
</pre></div>
</div>
<p>You keep doing this procedure, for all the commits, modifying <code class="docutils literal"><span class="pre">message.txt</span></code>
and recalculating the hash, until you come to <code class="docutils literal"><span class="pre">snapshot_8</span></code>, the merge
commit.  This commit is the result of merging two commits: <code class="docutils literal"><span class="pre">snapshot_7</span></code> and
<code class="docutils literal"><span class="pre">snapshot_7_josephine</span></code>.  You can record this information by putting <em>two</em>
parents into the <code class="docutils literal"><span class="pre">Parents</span></code> field of <code class="docutils literal"><span class="pre">snapshot_8/message.txt</span></code>, being the
new hashes for <code class="docutils literal"><span class="pre">snapshot_7/message.txt</span></code> and
<code class="docutils literal"><span class="pre">snapshot_7_josephine/message.txt</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>shasum snapshot_7/message.txt
bee09a3b1c11456c6e1bc6784319954f40fef24b  snapshot_7/message.txt
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>shasum snapshot_7_josephine/message.txt
905376d349af193c367217712bc231186f17fca7  snapshot_7_josephine/message.txt
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre>[desktop]$ cat snapshot_8/message.txt
Date: April 7 2012, 15.03
Author: I. M. Awesome
Notes: Merged Josephine&#39;s changes
Parents: bee09a3b1c11456c6e1bc6784319954f40fef24b 905376d349af193c367217712bc231186f17fca7
</pre></div>
</div>
<p>With the new <code class="docutils literal"><span class="pre">Parents</span></code> field, you have new hashes for all the
<code class="docutils literal"><span class="pre">message.txt</span></code> files, except <code class="docutils literal"><span class="pre">snapshot_1</span></code> (that has no parent):</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>shasum snapshot_*/message.txt
99b52473039acea4427e13e42b96c78776e2baf5  snapshot_1/message.txt
9bf4cdd8847feeb49fe94cb96298acf7986a587d  snapshot_2/message.txt
d9accd0a27c78b4333d70ee1a9d7dca0bcc3e682  snapshot_3/message.txt
00d03e9d1bf4ebaea380da3c62e9226189e39ff4  snapshot_4/message.txt
c203516a49d48389826b041f4d7bd2d39bdf4a57  snapshot_5/message.txt
9920fff7b55370a2c4c7566011de8aa2a263171f  snapshot_6/message.txt
bee09a3b1c11456c6e1bc6784319954f40fef24b  snapshot_7/message.txt
905376d349af193c367217712bc231186f17fca7  snapshot_7_josephine/message.txt
bd9dc5fb9aacf208536fad1fad22696c9a79e277  snapshot_8/message.txt
</pre></div>
</div>
<p>You can now rename your snapshot directories with the hash values, safe in the
knowledge that the <code class="docutils literal"><span class="pre">message.txt</span></code> files have the information about the commit
sequence.</p>
<div class="highlight-none"><div class="highlight"><pre>nobel_prize
├── working
│   (5 files)
├── staging
│   (5 files)
├── bd9dc5fb9aacf208536fad1fad22696c9a79e277
│   (6 files)
├── 905376d349af193c367217712bc231186f17fca7
│   (6 files)
├── bee09a3b1c11456c6e1bc6784319954f40fef24b
│   (6 files)
├── 9920fff7b55370a2c4c7566011de8aa2a263171f
│   (6 files)
├── c203516a49d48389826b041f4d7bd2d39bdf4a57
│   (6 files)
├── 00d03e9d1bf4ebaea380da3c62e9226189e39ff4
│   (5 files)
├── d9accd0a27c78b4333d70ee1a9d7dca0bcc3e682
│   (5 files)
├── 9bf4cdd8847feeb49fe94cb96298acf7986a587d
│   (5 files)
└── 99b52473039acea4427e13e42b96c78776e2baf5
    (4 files)
</pre></div>
</div>
<p>Now the commit directories are hash names, it is harder to see which commit is
which, so here&#8217;s the directory listing where the commit directories have a
label from the <code class="docutils literal"><span class="pre">Notes:</span></code> field in <code class="docutils literal"><span class="pre">message.txt</span></code>:</p>
<div class="highlight-none"><div class="highlight"><pre>nobel_prize
├── working
│   (5 files)
├── staging
│   (5 files)
├── bd9dc5fb9aacf208536fad1fad22696c9a79e277    &quot;Merged Josephine&#39;s changes&quot;
│   (6 files)
├── 905376d349af193c367217712bc231186f17fca7    &quot;Expand the introduction&quot;
│   (6 files)
├── bee09a3b1c11456c6e1bc6784319954f40fef24b    &quot;More fun with fudge&quot;
│   (6 files)
├── 9920fff7b55370a2c4c7566011de8aa2a263171f    &quot;Revert to original script &amp; figure&quot;
│   (6 files)
├── c203516a49d48389826b041f4d7bd2d39bdf4a57    &quot;Add references&quot;
│   (6 files)
├── 00d03e9d1bf4ebaea380da3c62e9226189e39ff4    &quot;Change parameters of analysis&quot;
│   (5 files)
├── d9accd0a27c78b4333d70ee1a9d7dca0bcc3e682    &quot;Add another fudge factor&quot;
│   (5 files)
├── 9bf4cdd8847feeb49fe94cb96298acf7986a587d    &quot;Add first draft of paper&quot;
│   (5 files)
└── 99b52473039acea4427e13e42b96c78776e2baf5    &quot;First backup of my amazing idea&quot;
    (4 files)
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<dl class="last docutils">
<dt>Commit hash</dt>
<dd>The hash value for the file containing the <strong>commit message</strong>.</dd>
</dl>
</div>
</div>
<div class="section" id="gitwards-8-the-development-history-is-a-graph">
<h3>Gitwards 8: the development history is a graph<a class="headerlink" href="#gitwards-8-the-development-history-is-a-graph" title="Permalink to this headline">¶</a></h3>
<p>The commits are linked by the &#8220;Parents&#8221; field in the <code class="docutils literal"><span class="pre">message.txt</span></code> file.  We
can think of the commits in a graph, where the commits are the nodes, and the
links between the nodes come from the hashes in the &#8220;Parents&#8221; field.</p>
<div class="figure" id="id4">
<img alt="_images/snapshot_graph1.png" src="_images/snapshot_graph1.png" />
<p class="caption"><span class="caption-text">Graph of development history for your SAP content management system.  The
most recent commit is at the top, the first commit is at the bottom.  Your
commits are in blue, Josephine&#8217;s are in pink.  Each commit label has the
hash for the commit message, and the note in the <code class="docutils literal"><span class="pre">message.txt</span></code> file.</span></p>
</div>
</div>
<div class="section" id="gitwards-9-saving-space-with-file-hashes">
<h3>Gitwards 9: saving space with file hashes<a class="headerlink" href="#gitwards-9-saving-space-with-file-hashes" title="Permalink to this headline">¶</a></h3>
<p>While you&#8217;ve been working on your system, you&#8217;ve noticed that your snapshots
are not efficient on disk space.  For example, every commit / snapshot has an
identical copy of the data <code class="docutils literal"><span class="pre">expensive_data.csv</span></code>.  If you had bigger files or
a longer development history, this could be a problem.</p>
<p>Likewise, <code class="docutils literal"><span class="pre">fancy_figure.png</span></code> and <code class="docutils literal"><span class="pre">clever_analysis.py</span></code> are the same for the
first two commits, and then again when you reverted to that copy in
<code class="docutils literal"><span class="pre">snapshot_6</span></code> (that is now commit <code class="docutils literal"><span class="pre">9920fff7b55370a2c4c7566011de8aa2a263171f</span></code>).</p>
<p>You can show these files are the same by checking their hash strings.  If
their hash strings are different, the files must be different.  All copies of
<code class="docutils literal"><span class="pre">expensive_data.csv</span></code> have the same hash, and are therefore identical:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>shasum */expensive_data.csv
bf2c7158afc60b244cba860fb0b2c04bb6481daf  00d03e9d1bf4ebaea380da3c62e9226189e39ff4/expensive_data.csv
bf2c7158afc60b244cba860fb0b2c04bb6481daf  905376d349af193c367217712bc231186f17fca7/expensive_data.csv
bf2c7158afc60b244cba860fb0b2c04bb6481daf  9920fff7b55370a2c4c7566011de8aa2a263171f/expensive_data.csv
bf2c7158afc60b244cba860fb0b2c04bb6481daf  99b52473039acea4427e13e42b96c78776e2baf5/expensive_data.csv
bf2c7158afc60b244cba860fb0b2c04bb6481daf  9bf4cdd8847feeb49fe94cb96298acf7986a587d/expensive_data.csv
bf2c7158afc60b244cba860fb0b2c04bb6481daf  bd9dc5fb9aacf208536fad1fad22696c9a79e277/expensive_data.csv
bf2c7158afc60b244cba860fb0b2c04bb6481daf  bee09a3b1c11456c6e1bc6784319954f40fef24b/expensive_data.csv
bf2c7158afc60b244cba860fb0b2c04bb6481daf  c203516a49d48389826b041f4d7bd2d39bdf4a57/expensive_data.csv
bf2c7158afc60b244cba860fb0b2c04bb6481daf  d9accd0a27c78b4333d70ee1a9d7dca0bcc3e682/expensive_data.csv
bf2c7158afc60b244cba860fb0b2c04bb6481daf  staging/expensive_data.csv
bf2c7158afc60b244cba860fb0b2c04bb6481daf  working/expensive_data.csv
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">fancy_figure.png</span></code> is the same for the first two commits, changes for the
third commit, and reverts back to the same contents at the 6th commit:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span><span class="c"># First commit</span>
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>shasum 99b52473039acea4427e13e42b96c78776e2baf5/fancy_figure.png
e8fe49b1faf23b428865d0315c4763c6ec459897  99b52473039acea4427e13e42b96c78776e2baf5/fancy_figure.png
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span><span class="c"># Second commit</span>
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>shasum 9bf4cdd8847feeb49fe94cb96298acf7986a587d/fancy_figure.png
e8fe49b1faf23b428865d0315c4763c6ec459897  9bf4cdd8847feeb49fe94cb96298acf7986a587d/fancy_figure.png
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span><span class="c"># Third commit</span>
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>shasum d9accd0a27c78b4333d70ee1a9d7dca0bcc3e682/fancy_figure.png
863cf24c03c6ab1eb33c1022d6fc8f7a2876875a  d9accd0a27c78b4333d70ee1a9d7dca0bcc3e682/fancy_figure.png
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span><span class="c"># Sixth commit</span>
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>shasum 9920fff7b55370a2c4c7566011de8aa2a263171f/fancy_figure.png
e8fe49b1faf23b428865d0315c4763c6ec459897  9920fff7b55370a2c4c7566011de8aa2a263171f/fancy_figure.png
</pre></div>
</div>
<p>You wonder if there is a way to store each unique version of the file just
once, and make the commits point to the matching version.</p>
<p>First you make a new directory to store files generated from your commits:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>mkdir repo
</pre></div>
</div>
<p>Next you make a sub-directory to store the unique copies of the files in
commits:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>mkdir repo/objects
</pre></div>
</div>
<p>You play with the idea of calling these unique versions something like
<code class="docutils literal"><span class="pre">repo/objects/fancy_figure.png.v1</span></code>, <code class="docutils literal"><span class="pre">repo/objects/fancy_figure.png.v2</span></code> and
so on.  You would then need something like a text file called
<code class="docutils literal"><span class="pre">directory_listing.txt</span></code> in the first commit directory to say that the file
<code class="docutils literal"><span class="pre">fancy_figure.png</span></code> for this commit is available at
<code class="docutils literal"><span class="pre">repo/objects/fancy_figure.png.v1</span></code>.  This could be something like:</p>
<div class="highlight-python"><div class="highlight"><pre># directory_listing.txt in first commit
fancy_figure.png -&gt; repo/objects/fancy_figure.png.v1
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">directory_listing.txt</span></code> for the second commit would point to the same file,
but the third commit would have something like:</p>
<div class="highlight-python"><div class="highlight"><pre># directory_listing.txt in third commit
fancy_figure.png -&gt; repo/objects/fancy_figure.png.v2
</pre></div>
</div>
<p>You quickly realize this is going to get messy when you are working with other
people, because you may store <code class="docutils literal"><span class="pre">repo/objects/fancy_figure.png.v3</span></code> while
Josephine is also working on the figure, and is storing her own
<code class="docutils literal"><span class="pre">repo/objects/fancy_figure.png.v3</span></code>.  You need a unique file name for each
version of the file.</p>
<p>Now you have your second quite brilliant hashing idea.  Why not use the
<strong>hash</strong> of the file to make a unique file name?</p>
<p>For example, here are the hash values for the files in the first commit:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>shasum 99b52473039acea4427e13e42b96c78776e2baf5/*
c25a0bd91a7e8eb574b17296a25111233eac94b5  99b52473039acea4427e13e42b96c78776e2baf5/clever_analysis.py
bf2c7158afc60b244cba860fb0b2c04bb6481daf  99b52473039acea4427e13e42b96c78776e2baf5/expensive_data.csv
e8fe49b1faf23b428865d0315c4763c6ec459897  99b52473039acea4427e13e42b96c78776e2baf5/fancy_figure.png
99b52473039acea4427e13e42b96c78776e2baf5  99b52473039acea4427e13e42b96c78776e2baf5/message.txt
</pre></div>
</div>
<p>To store the unique copies, you copy each file in the first commit to
<code class="docutils literal"><span class="pre">repo/objects</span></code> with a unique file name.  <strong>The file name is the hash of the
file contents</strong>.  For example, the hash for <code class="docutils literal"><span class="pre">fancy_figure.png</span></code> is
<code class="docutils literal"><span class="pre">e8fe49b1faf23b428865d0315c4763c6ec459897</span></code>.  So, you do:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>cp 99b52473039acea4427e13e42b96c78776e2baf5/fancy_figure.png repo/objects/e8fe49b1faf23b428865d0315c4763c6ec459897
</pre></div>
</div>
<p>The hash values for <code class="docutils literal"><span class="pre">clever_analysis.py</span></code> and <code class="docutils literal"><span class="pre">expensive_data.csv</span></code> are
<code class="docutils literal"><span class="pre">c25a0bd91a7e8eb574b17296a25111233eac94b5</span></code> and <code class="docutils literal"><span class="pre">bf2c7158afc60b244cba860fb0b2c04bb6481daf</span></code> respectively, so:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>cp 99b52473039acea4427e13e42b96c78776e2baf5/clever_analysis.py repo/objects/c25a0bd91a7e8eb574b17296a25111233eac94b5
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>cp 99b52473039acea4427e13e42b96c78776e2baf5/expensive_data.csv repo/objects/bf2c7158afc60b244cba860fb0b2c04bb6481daf
</pre></div>
</div>
<p>These hash values become the <code class="docutils literal"><span class="pre">directory_listing.txt</span></code> for the first commit:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>cat 99b52473039acea4427e13e42b96c78776e2baf5/directory_listing.txt
c25a0bd91a7e8eb574b17296a25111233eac94b5  clever_analysis.py
bf2c7158afc60b244cba860fb0b2c04bb6481daf  expensive_data.csv
e8fe49b1faf23b428865d0315c4763c6ec459897  fancy_figure.png
</pre></div>
</div>
<p>Finally, you can delete <code class="docutils literal"><span class="pre">fancy_figure.png</span></code>, <code class="docutils literal"><span class="pre">clever_analysis.py</span></code> and
<code class="docutils literal"><span class="pre">expensive_data.csv</span></code> in the first commit directory, because you have them
backed up in <code class="docutils literal"><span class="pre">repo/objects</span></code>.</p>
<p>So far you haven&#8217;t gained anything much except some odd-looking filenames.
The payoff comes when you apply the same procedure to the second commit.  Here
are the hashes for the files in the second commit:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>shasum 9bf4cdd8847feeb49fe94cb96298acf7986a587d/*
c25a0bd91a7e8eb574b17296a25111233eac94b5  9bf4cdd8847feeb49fe94cb96298acf7986a587d/clever_analysis.py
bf2c7158afc60b244cba860fb0b2c04bb6481daf  9bf4cdd8847feeb49fe94cb96298acf7986a587d/expensive_data.csv
e8fe49b1faf23b428865d0315c4763c6ec459897  9bf4cdd8847feeb49fe94cb96298acf7986a587d/fancy_figure.png
9bf4cdd8847feeb49fe94cb96298acf7986a587d  9bf4cdd8847feeb49fe94cb96298acf7986a587d/message.txt
47eef829586738a0855060dc83f8e0781fbcac2c  9bf4cdd8847feeb49fe94cb96298acf7986a587d/nobel_prize.md
</pre></div>
</div>
<p>Remember that, in the second commit, all you did was add the first draft of
the paper as <code class="docutils literal"><span class="pre">nobel_prize.md</span></code>.  So, all the other files in the second commit
(apart from <code class="docutils literal"><span class="pre">message.txt</span></code> that you are not storing) are the same as for the
first commit, and therefore have the same hash.  You already have these files
backed up in <code class="docutils literal"><span class="pre">repo/objects</span></code> so all you need to do is point
<code class="docutils literal"><span class="pre">directory_listing.txt</span></code> at the original copies in <code class="docutils literal"><span class="pre">repo/objects</span></code>.</p>
<p>For example, the hash for <code class="docutils literal"><span class="pre">fancy_figure.png</span></code> in the second commit is
<code class="docutils literal"><span class="pre">e8fe49b1faf23b428865d0315c4763c6ec459897</span></code>.  When you are storing the files for the second commit
in <code class="docutils literal"><span class="pre">repo/objects</span></code>, you notice that you already have a file
named <code class="docutils literal"><span class="pre">e8fe49b1faf23b428865d0315c4763c6ec459897</span></code> in <code class="docutils literal"><span class="pre">repo/objects</span></code>, so you do not copy it a
second time.  By checking the hashes for each file in the commit, you find
that the only file you are missing is the new file <code class="docutils literal"><span class="pre">nobel_prize.md</span></code>.  This
has hash <code class="docutils literal"><span class="pre">47eef829586738a0855060dc83f8e0781fbcac2c</span></code>, so you do a single copy to <code class="docutils literal"><span class="pre">repo/objects</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span><span class="c"># Only one copy needed to store files in second commit</span>
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>cp 9bf4cdd8847feeb49fe94cb96298acf7986a587d/nobel_prize.md repo/objects/47eef829586738a0855060dc83f8e0781fbcac2c
</pre></div>
</div>
<p>As before, you can make <code class="docutils literal"><span class="pre">directory_listing.txt</span></code> for the second commit by
recording the hashes of the files:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>cat 9bf4cdd8847feeb49fe94cb96298acf7986a587d/directory_listing.txt
c25a0bd91a7e8eb574b17296a25111233eac94b5  clever_analysis.py
bf2c7158afc60b244cba860fb0b2c04bb6481daf  expensive_data.csv
e8fe49b1faf23b428865d0315c4763c6ec459897  fancy_figure.png
47eef829586738a0855060dc83f8e0781fbcac2c  nobel_prize.md
</pre></div>
</div>
<p>Before you start this procedure of moving the unique copies into
<code class="docutils literal"><span class="pre">repo/objects</span></code>, your whole <code class="docutils literal"><span class="pre">nobel_prize</span></code> directory is size:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span><span class="c"># Size of the contents of nobel_prize before moving to repo/objects</span>
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>du -hs .
5.4M	.
</pre></div>
</div>
<p>When you run the procedure above on every commit, moving files to
<code class="docutils literal"><span class="pre">repo/objects</span></code>, you have this:</p>
<div class="highlight-none"><div class="highlight"><pre>nobel_prize
├── working
│   (5 files)
├── staging
│   (5 files)
├── repo
│   └── objects
│       ├── 18e92be4df9036826fc983c42e2e4fb5c6fed1cb [692B]
│       ├── 27e85e8f524a26a3a77f1c7ea631d6b2ad2b018a [251K]
│       ├── 47eef829586738a0855060dc83f8e0781fbcac2c [730B]
│       ├── 4e3c43a5c0d530fa0ba4305b3c52a9f7a4cb9140 [244B]
│       ├── 5840cded1e61d0a22c0e9f7d62de8c43ff47a402 [716B]
│       ├── 71892a8d170f113b778a9458cd6930abb387328f [238B]
│       ├── 80bf412d6273626674658862caebb131c2df8ddc [979B]
│       ├── 815bbcf64edacb6791cc2ebdc3afeb09797c9347 [181B]
│       ├── 863cf24c03c6ab1eb33c1022d6fc8f7a2876875a [239K]
│       ├── bf2c7158afc60b244cba860fb0b2c04bb6481daf [244K]
│       ├── c25a0bd91a7e8eb574b17296a25111233eac94b5 [618B]
│       ├── e8fe49b1faf23b428865d0315c4763c6ec459897 [183K]
│       ├── efb5308cc0f74a2515ce668adf237b28527fd2bc [279K]
│       └── f2e5e8c8122533fbc1da0684abe7e43471fe1674 [752B]
├── bd9dc5fb9aacf208536fad1fad22696c9a79e277    &quot;Merged Josephine&#39;s changes&quot;
│   ├── directory_listing.txt [290B]
│   └── message.txt [173B]
├── 905376d349af193c367217712bc231186f17fca7    &quot;Expand the introduction&quot;
│   ├── directory_listing.txt [290B]
│   └── message.txt [130B]
├── bee09a3b1c11456c6e1bc6784319954f40fef24b    &quot;More fun with fudge&quot;
│   ├── directory_listing.txt [290B]
│   └── message.txt [125B]
├── 9920fff7b55370a2c4c7566011de8aa2a263171f    &quot;Revert to original script &amp; figure&quot;
│   ├── directory_listing.txt [290B]
│   └── message.txt [140B]
├── c203516a49d48389826b041f4d7bd2d39bdf4a57    &quot;Add references&quot;
│   ├── directory_listing.txt [290B]
│   └── message.txt [120B]
├── 00d03e9d1bf4ebaea380da3c62e9226189e39ff4    &quot;Change parameters of analysis&quot;
│   ├── directory_listing.txt [234B]
│   └── message.txt [135B]
├── d9accd0a27c78b4333d70ee1a9d7dca0bcc3e682    &quot;Add another fudge factor&quot;
│   ├── directory_listing.txt [234B]
│   └── message.txt [130B]
├── 9bf4cdd8847feeb49fe94cb96298acf7986a587d    &quot;Add first draft of paper&quot;
│   ├── directory_listing.txt [297B]
│   └── message.txt [130B]
└── 99b52473039acea4427e13e42b96c78776e2baf5    &quot;First backup of my amazing idea&quot;
    ├── directory_listing.txt [241B]
    └── message.txt [87B]
</pre></div>
</div>
<p>The whole <code class="docutils literal"><span class="pre">nobel_prize</span></code> directory is now smaller because you have no
duplicated files:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span><span class="c"># Size of the contents of nobel_prize after moving to repo/objects</span>
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>du -hs .
2.3M	.
</pre></div>
</div>
<p>The advantage in size gets larger as your system grows, and you have more
duplicated files.</p>
</div>
<div class="section" id="gitwards-10-making-the-commits-unique">
<h3>Gitwards 10: making the commits unique<a class="headerlink" href="#gitwards-10-making-the-commits-unique" title="Permalink to this headline">¶</a></h3>
<p>Up in <a class="reference internal" href="#naming-from-hashes"><span>Gitwards 7: naming commits from hashes</span></a> you used the hash of <code class="docutils literal"><span class="pre">message.txt</span></code> as a
nearly unique directory name for the commit.  Your thinking was that it was
very unlikely that any two commits would have the same author, date, time, and
note.  You have since added the <code class="docutils literal"><span class="pre">Parents</span></code> field to <code class="docutils literal"><span class="pre">message.txt</span></code> to make
it even more unlikely.  But – it could still happen.  You might be careless
and make another commit very quickly after the previous, and without a note.
You could even point back to the same parent.</p>
<p>You would like to be even more confident that the commit message is unique to
the commit, including the contents of the files in the commit.</p>
<p>You now have a way of doing this.   The <code class="docutils literal"><span class="pre">directory_listing.txt</span></code> files
contain a list of hashes and corresponding file names for this commit
(snapshot).  For example, here is <code class="docutils literal"><span class="pre">directory_listing.txt</span></code> for the first
commit:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>cat 99b52473039acea4427e13e42b96c78776e2baf5/directory_listing.txt
c25a0bd91a7e8eb574b17296a25111233eac94b5 clever_analysis.py
815bbcf64edacb6791cc2ebdc3afeb09797c9347 directory_listing.txt
bf2c7158afc60b244cba860fb0b2c04bb6481daf expensive_data.csv
e8fe49b1faf23b428865d0315c4763c6ec459897 fancy_figure.png
</pre></div>
</div>
<p>The contents of this file are (very nearly) unique to the contents of the
files in the snapshot.  If any of the files changed, then the hash of the file
would change and the corresponding line in <code class="docutils literal"><span class="pre">directory_listing.txt</span></code> would
change.  If you renamed the file, the name of the file would change and the
corresponding line in <code class="docutils literal"><span class="pre">directory_listing.txt</span></code> would change.</p>
<p>Now you know what to do.  You take a hash of the <code class="docutils literal"><span class="pre">directory_listing.txt</span></code>
file:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>shasum 99b52473039acea4427e13e42b96c78776e2baf5/directory_listing.txt
85d49d8555aeb254d1d4acd377034772944a35fe  99b52473039acea4427e13e42b96c78776e2baf5/directory_listing.txt
</pre></div>
</div>
<p>You put this has into a new field in <code class="docutils literal"><span class="pre">message.txt</span></code> called <code class="docutils literal"><span class="pre">Directory</span>
<span class="pre">hash:</span></code>:</p>
<div class="highlight-none"><div class="highlight"><pre>Date: April 1 2012, 14.30
Author: I. M. Awesome
Notes: First backup of my amazing idea
Directory hash: 85d49d8555aeb254d1d4acd377034772944a35fe
</pre></div>
</div>
<p>Now, if any file in the commit changes, <code class="docutils literal"><span class="pre">directory_listing.txt</span></code> will change,
and so its hash will change, and so <code class="docutils literal"><span class="pre">message.txt</span></code> will change.</p>
<p>Now you&#8217;ve added the <code class="docutils literal"><span class="pre">Directory</span> <span class="pre">hash</span></code> field to <code class="docutils literal"><span class="pre">messsage.txt</span></code> you have
also changed the hash values of the <code class="docutils literal"><span class="pre">message.txt</span></code> files.  Because you&#8217;ve
changed the hashes of the <code class="docutils literal"><span class="pre">message.txt</span></code> files, you go back through your
commits updating the parent hashes to the new ones, and renaming the commit
directories with the new hashes.  You end up with this:</p>
<div class="highlight-none"><div class="highlight"><pre>nobel_prize
├── working
│   (5 files)
├── staging
│   (5 files)
├── repo
│   (1 directory)
├── f46773cff294d07a331a6aa0ee32b3615cb009b8    &quot;Merged Josephine&#39;s changes&quot;
│   (2 files)
├── 505228057403295fdc16888bed49515a7c1d80a1    &quot;Expand the introduction&quot;
│   (2 files)
├── 5bdbf9b8ac9e998a95495e2d7ae370242c267c52    &quot;More fun with fudge&quot;
│   (2 files)
├── 41234bea0657aecaa234cee2b146051f90062078    &quot;Revert to original script &amp; figure&quot;
│   (2 files)
├── c1072adf649f3ec439e6925af01251b9ccd91410    &quot;Add references&quot;
│   (2 files)
├── 917fb4cfe6c5d13bd4efbac1b54b26ae2967c839    &quot;Change parameters of analysis&quot;
│   (2 files)
├── 2eb0b1ea04d70129e4a4e219e8d51e10effdb8fe    &quot;Add another fudge factor&quot;
│   (2 files)
├── 117e7de8e27a54104f7a08d0f75b9ca214eaccb3    &quot;Add first draft of paper&quot;
│   (2 files)
└── 9c0b782981cc2ee322ec4b595dc472799f8808bd    &quot;First backup of my amazing idea&quot;
    (2 files)
</pre></div>
</div>
<p>With your new system, if any two commits have the same <code class="docutils literal"><span class="pre">message.txt</span></code> then
they also have the same date, author, note, parents and file contents.  They
are therefore exactly the same commit.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The commit message is unique to the contents of the files in the snapshot
(because of the directory hash) and unique to its previous history
(because of the parent hash(es)).</p>
</div>
</div>
<div class="section" id="gitwards-11-away-with-the-snapshot-directories">
<h3>Gitwards 11: away with the snapshot directories<a class="headerlink" href="#gitwards-11-away-with-the-snapshot-directories" title="Permalink to this headline">¶</a></h3>
<p>You are reflecting on your idea about hashing the directory listing, and your
eye falls idly on the current directory tree of <code class="docutils literal"><span class="pre">nobel_prize</span></code>:</p>
<div class="highlight-none"><div class="highlight"><pre>nobel_prize
├── working
│   (5 files)
├── staging
│   (5 files)
├── repo
│   └── objects
│       (14 files)
├── f46773cff294d07a331a6aa0ee32b3615cb009b8    &quot;Merged Josephine&#39;s changes&quot;
│   ├── directory_listing.txt [290B]
│   └── message.txt [230B]
├── 505228057403295fdc16888bed49515a7c1d80a1    &quot;Expand the introduction&quot;
│   ├── directory_listing.txt [290B]
│   └── message.txt [187B]
├── 5bdbf9b8ac9e998a95495e2d7ae370242c267c52    &quot;More fun with fudge&quot;
│   ├── directory_listing.txt [290B]
│   └── message.txt [182B]
├── 41234bea0657aecaa234cee2b146051f90062078    &quot;Revert to original script &amp; figure&quot;
│   ├── directory_listing.txt [290B]
│   └── message.txt [197B]
├── c1072adf649f3ec439e6925af01251b9ccd91410    &quot;Add references&quot;
│   ├── directory_listing.txt [290B]
│   └── message.txt [177B]
├── 917fb4cfe6c5d13bd4efbac1b54b26ae2967c839    &quot;Change parameters of analysis&quot;
│   ├── directory_listing.txt [234B]
│   └── message.txt [192B]
├── 2eb0b1ea04d70129e4a4e219e8d51e10effdb8fe    &quot;Add another fudge factor&quot;
│   ├── directory_listing.txt [234B]
│   └── message.txt [187B]
├── 117e7de8e27a54104f7a08d0f75b9ca214eaccb3    &quot;Add first draft of paper&quot;
│   ├── directory_listing.txt [297B]
│   └── message.txt [187B]
└── 9c0b782981cc2ee322ec4b595dc472799f8808bd    &quot;First backup of my amazing idea&quot;
    ├── directory_listing.txt [241B]
    └── message.txt [144B]
</pre></div>
</div>
<p>It occurs to you that you can move the <code class="docutils literal"><span class="pre">directory_listing.txt</span></code> and
<code class="docutils literal"><span class="pre">message.txt</span></code> files into your <code class="docutils literal"><span class="pre">repo/objects</span></code> directory.  When you have
done that, you can get rid of the commit directories entirely.</p>
<p>First you take the hash of each <code class="docutils literal"><span class="pre">directory_listing.txt</span></code> and move it into the
<code class="docutils literal"><span class="pre">repo/objects</span></code> directory as you did for the other files:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>shasum 9c0b782981cc2ee322ec4b595dc472799f8808bd/directory_listing.txt
85d49d8555aeb254d1d4acd377034772944a35fe  9c0b782981cc2ee322ec4b595dc472799f8808bd/directory_listing.txt
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>cp 9c0b782981cc2ee322ec4b595dc472799f8808bd/directory_listing.txt repo/objects/85d49d8555aeb254d1d4acd377034772944a35fe
</pre></div>
</div>
<p>Then you do the same for the <code class="docutils literal"><span class="pre">message.txt</span></code> file:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>cp 9c0b782981cc2ee322ec4b595dc472799f8808bd/message.txt repo/objects/9c0b782981cc2ee322ec4b595dc472799f8808bd
</pre></div>
</div>
<p>There are 9 commits, so there are 9 x 2 new files with
hash filenames in <code class="docutils literal"><span class="pre">repo/objects</span></code> (a hashed copy of <code class="docutils literal"><span class="pre">directory_listing.txt</span></code>
and <code class="docutils literal"><span class="pre">message.txt</span></code> for each commit).</p>
<p>Now you don&#8217;t need the snapshot directories at all, because the hashed files
in <code class="docutils literal"><span class="pre">repo/objects</span></code> have all the information about the snapshots.</p>
<div class="highlight-none"><div class="highlight"><pre>nobel_prize
├── working
│   (5 files)
├── staging
│   (5 files)
└── repo
    └── objects
        (32 files)
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In git as in your SAP content management system, a <strong>repository
directory</strong> stores all the data from the snapshots.  In your case that
directory is <code class="docutils literal"><span class="pre">repo</span></code>.  For git, it will be a directory called <code class="docutils literal"><span class="pre">.git</span></code>.</p>
</div>
</div>
<div class="section" id="gitwards-12-where-am-i">
<h3>Gitwards 12: where am I?<a class="headerlink" href="#gitwards-12-where-am-i" title="Permalink to this headline">¶</a></h3>
<p>You have one last problem to face – where is your latest commit?</p>
<p>When your snapshot directory names had numbers, like <code class="docutils literal"><span class="pre">snapshot_8</span></code>, you could
use the numbers to find the most recent commit.  Now all you have is a
directory called <code class="docutils literal"><span class="pre">repo/objects</span></code> with unhelpful file names made from hashes.
Which of these files has your latest commit?</p>
<p>You could write down the latest commit hash on a piece of paper, after you
make the commit, but this sounds like a job better done by a computer.</p>
<p>So, when you make a new commit, you store the hash for that commit in a file
called <code class="docutils literal"><span class="pre">repo/my_bookmark</span></code>.  It is a text file with the hash string as
contents.  Your last commit was <code class="docutils literal"><span class="pre">f46773cff294d07a331a6aa0ee32b3615cb009b8</span></code>, so
<code class="docutils literal"><span class="pre">repo/my_bookmark</span></code> has contents:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>cat repo/my_bookmark
f46773cff294d07a331a6aa0ee32b3615cb009b8
</pre></div>
</div>
<p>You can imagine that, when Josephine is working on the same set of files, she
might want her own bookmark, maybe in a file called <code class="docutils literal"><span class="pre">josephines-bookmark</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You keep track of the latest commit in a particular sequence by storing
the latest <strong>commit hash</strong> in a bookmark file.  In git this bookmark is
called a <strong>branch</strong>.</p>
</div>
</div>
</div>
<div class="section" id="from-gitwards-to-gitworld">
<h2>From gitwards to gitworld<a class="headerlink" href="#from-gitwards-to-gitworld" title="Permalink to this headline">¶</a></h2>
<p>Now you have built your own content management system, you know how git works
– because it works in exactly the same way.  You will recognize hashes for
files, directories and commits, commits linked by reference to their parents,
the staging area, the <code class="docutils literal"><span class="pre">objects</span></code> directory, and bookmarks (branches).</p>
<p>Armed with this <a class="reference external" href="http://rogerdudler.github.io/git-guide">deep</a> understanding, we retrace our steps to do the same
content management tasks in git.</p>
<div class="section" id="basic-configuration">
<h3>Basic configuration<a class="headerlink" href="#basic-configuration" title="Permalink to this headline">¶</a></h3>
<p>We need to tell git our name and email address before we start.</p>
<p>Git will use this information to fill in the author information in each
<strong>commit message</strong>, so we don&#8217;t have to type it out every time.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git config --global user.name <span class="s2">&quot;Matthew Brett&quot;</span>
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git config --global user.email <span class="s2">&quot;matthew.brett@gmail.com&quot;</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">--global</span></code> flag tells git to store this information in its default
configuration file for your user account.  On Unix (e.g. OSX and Linux) this
file is <code class="docutils literal"><span class="pre">.gitconfig</span></code> in your home directory.  Without the <code class="docutils literal"><span class="pre">--global</span></code> flag,
git only applies the configuration to the particular <strong>repository</strong> you are
working in.</p>
<p>Every time we make a commit, we need to type a commit message.  Git will open
our text editor for us to type the message, but first it needs to know what
text editor we prefer.  Set your own preferred text editor here:</p>
<div class="highlight-python"><div class="highlight"><pre># gedit is a reasonable choice for Linux
# &quot;vi&quot; is the default.
git config --global core.editor gedit
</pre></div>
</div>
<p>We also turn on the use of color, which is very helpful in making the
output of git easier to read:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git config --global color.ui <span class="s2">&quot;auto&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="getting-help">
<h3>Getting help<a class="headerlink" href="#getting-help" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git <span class="nb">help</span>
usage: git <span class="o">[</span>--version<span class="o">]</span> <span class="o">[</span>--help<span class="o">]</span> <span class="o">[</span>-C &lt;path&gt;<span class="o">]</span> <span class="o">[</span>-c <span class="nv">name</span><span class="o">=</span>value<span class="o">]</span>
           <span class="o">[</span>--exec-path<span class="o">[=</span>&lt;path&gt;<span class="o">]]</span> <span class="o">[</span>--html-path<span class="o">]</span> <span class="o">[</span>--man-path<span class="o">]</span> <span class="o">[</span>--info-path<span class="o">]</span>
           <span class="o">[</span>-p<span class="p">|</span>--paginate<span class="p">|</span>--no-pager<span class="o">]</span> <span class="o">[</span>--no-replace-objects<span class="o">]</span> <span class="o">[</span>--bare<span class="o">]</span>
           <span class="o">[</span>--git-dir<span class="o">=</span>&lt;path&gt;<span class="o">]</span> <span class="o">[</span>--work-tree<span class="o">=</span>&lt;path&gt;<span class="o">]</span> <span class="o">[</span>--namespace<span class="o">=</span>&lt;name&gt;<span class="o">]</span>
           &lt;<span class="nb">command</span>&gt; <span class="o">[</span>&lt;args&gt;<span class="o">]</span>

The most commonly used git commands are:
   add        Add file contents to the index
   bisect     Find by binary search the change that introduced a bug
   branch     List, create, or delete branches
   checkout   Checkout a branch or paths to the working tree
   clone      Clone a repository into a new directory
   commit     Record changes to the repository
   diff       Show changes between commits, commit and working tree, etc
   fetch      Download objects and refs from another repository
   grep       Print lines matching a pattern
   init       Create an empty Git repository or reinitialize an existing one
   log        Show commit logs
   merge      Join two or more development histories together
   mv         Move or rename a file, a directory, or a symlink
   pull       Fetch from and integrate with another repository or a <span class="nb">local </span>branch
   push       Update remote refs along with associated objects
   rebase     Forward-port <span class="nb">local </span>commits to the updated upstream head
   reset      Reset current HEAD to the specified state
   rm         Remove files from the working tree and from the index
   show       Show various types of objects
   status     Show the working tree status
   tag        Create, list, delete or verify a tag object signed with GPG

<span class="s1">&#39;git help -a&#39;</span> and <span class="s1">&#39;git help -g&#39;</span> lists available subcommands and some
concept guides. See <span class="s1">&#39;git help &lt;command&gt;&#39;</span> or <span class="s1">&#39;git help &lt;concept&gt;&#39;</span>
to <span class="nb">read </span>about a specific subcommand or concept.
</pre></div>
</div>
<p>Try <code class="docutils literal"><span class="pre">git</span> <span class="pre">help</span> <span class="pre">add</span></code> for an example.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The git help pages are famously hard to read if you don&#8217;t know how git
works. One purpose of this tutorial is to explain git in such a way that
it will be easier to understand the help pages.</p>
</div>
</div>
<div class="section" id="initializing-the-repository-directory">
<h3>Initializing the repository directory<a class="headerlink" href="#initializing-the-repository-directory" title="Permalink to this headline">¶</a></h3>
<p>We first set this <code class="docutils literal"><span class="pre">nobel_prize</span></code> directory to be version controlled with git.
We start off the working tree with the original files for the paper:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">I highly recommend you type along.  Why not download
<a class="reference download internal" href="_downloads/nobel_prize.zip"><code class="xref download docutils literal"><span class="pre">nobel_prize.zip</span></code></a> and unzip the
files to make the same <code class="docutils literal"><span class="pre">nobel_prize</span></code> directory as I have here?</p>
</div>
<div class="highlight-none"><div class="highlight"><pre>nobel_prize
├── clever_analysis.py [618B]
├── expensive_data.csv [244K]
└── fancy_figure.png [183K]
</pre></div>
</div>
<p>To get started with git, create the git <strong>repository directory</strong> with <code class="docutils literal"><span class="pre">git</span>
<span class="pre">init</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span><span class="nb">cd </span>nobel_prize
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git init
Initialized empty Git repository in /Users/mb312/dev_trees/pydagogue/working/nobel_prize/.git/
</pre></div>
</div>
<p>What happened when we did <code class="docutils literal"><span class="pre">git</span> <span class="pre">init</span></code>? Just what we were expecting; we have a
new repository directory in <code class="docutils literal"><span class="pre">nobel_prize</span></code> called <code class="docutils literal"><span class="pre">.git</span></code></p>
<div class="highlight-none"><div class="highlight"><pre>.git
├── refs
│   ├── tags
│   └── heads
├── objects
│   ├── pack
│   └── info
├── info
│   └── exclude [240B]
├── hooks
│   (9 files)
├── branches
├── HEAD [23B]
├── config [137B]
└── description [73B]
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">objects</span></code> directory looks familiar.  It has exactly the same purpose as
it did for your SAP system.  At the moment it contains a couple of empty
directories, because we have not added any objects yet.</p>
</div>
<div class="section" id="updating-terms-for-git">
<h3>Updating terms for git<a class="headerlink" href="#updating-terms-for-git" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>Working directory</dt>
<dd>The directory containing the files you are working on.  In our case this
is <code class="docutils literal"><span class="pre">nobel_prize</span></code>.  It contains the <strong>repository directory</strong>, named
<code class="docutils literal"><span class="pre">.git</span></code>.</dd>
<dt>Repository directory</dt>
<dd>Directory containing all previous commits (snapshots) and git private
files for working with commits.  The directory has name <code class="docutils literal"><span class="pre">.git</span></code> by
default, and almost always in practice.</dd>
</dl>
</div>
<div class="section" id="git-add-put-stuff-into-the-staging-area">
<span id="git-add"></span><h3>git add – put stuff into the staging area<a class="headerlink" href="#git-add-put-stuff-into-the-staging-area" title="Permalink to this headline">¶</a></h3>
<p>In the next few sections, we will do our first commit (snapshot).</p>
<p>First we will put the files for the commit into the staging area.</p>
<p>The command to put files into the staging area is <code class="docutils literal"><span class="pre">git</span> <span class="pre">add</span></code>.</p>
<p>First, we show ourselves that the <strong>staging area</strong> is empty. We haven&#8217;t yet
discussed the git implementation of the staging area, but this command shows
us which files are in the staging area.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git ls-files --stage
</pre></div>
</div>
<p>As expected, there are no files in the staging area yet.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><code class="docutils literal"><span class="pre">git</span> <span class="pre">ls-files</span></code> is a specialized command that you will not often need in
your daily git life.  I&#8217;m using it here to show you how git works.</p>
</div>
<p>Now we do our add:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git add clever_analysis.py
</pre></div>
</div>
</div>
<div class="section" id="the-git-staging-area">
<h3>The git staging area<a class="headerlink" href="#the-git-staging-area" title="Permalink to this headline">¶</a></h3>
<p>It is time to think about what the staging area is, in git.  In your SAP
system, the staging area was a directory.  You also started off by using
directories to store commits (snapshots).  Later you found you could do
without the commit directories, because you could store the directory
structure in <code class="docutils literal"><span class="pre">directory_listing.txt</span></code> text files, and then copy these into
your <code class="docutils literal"><span class="pre">repo/objects</span></code> directory.</p>
<p>In git, the staging area is a single file called <code class="docutils literal"><span class="pre">.git/index</span></code>.  This file
contains a directory listing that is the equivalent of the <code class="docutils literal"><span class="pre">staging</span></code>
directory in SAP.  When we add a file to the staging area, git backs up the
file with its hash to <code class="docutils literal"><span class="pre">.git/objects</span></code>, and then changes the directory listing
inside <code class="docutils literal"><span class="pre">.git/index</span></code> to point to this backup copy.</p>
<p>Now we have done the <code class="docutils literal"><span class="pre">git</span> <span class="pre">add</span></code>, we expect that the new file will show up in
the staging area:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git ls-files --stage
<span class="m">100755</span> 6560135a5943c0509608fee6d900b775e3041197 0	clever_analysis.py
</pre></div>
</div>
<p>The output shows the hash of the backed up copy of <code class="docutils literal"><span class="pre">clever_analysis.py</span></code>.</p>
<p>We can see this hashed backup file in <code class="docutils literal"><span class="pre">.git/objects</span></code>:</p>
<div class="highlight-none"><div class="highlight"><pre>objects
├── pack
├── info
└── 65
    └── 60135a5943c0509608fee6d900b775e3041197 [335B]
</pre></div>
</div>
<p>The filename of the new file comes from the hash recorded in the staging area.
The first two digits of the hash form the directory name and the rest of the
digits are the filename <a class="footnote-reference" href="#git-object-dir" id="id1">[4]</a>.</p>
</div>
<div class="section" id="git-objects">
<h3>Git objects<a class="headerlink" href="#git-objects" title="Permalink to this headline">¶</a></h3>
<p>Git objects are nearly as simple as the objects you were writing in your SAP.
The hash is not the hash of the raw file, but the raw file prepended with a
short housekeeping string.  See <a class="reference internal" href="reading_git_objects.html"><em>Reading git objects</em></a> for details.</p>
<p>We can see the contents of objects with the command <code class="docutils literal"><span class="pre">git</span> <span class="pre">cat-file</span> <span class="pre">-p</span></code>.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git cat-file -p 6560135a5943c0509608fee6d900b775e3041197
<span class="c"># The brain analysis script</span>
import numpy as np

import matplotlib.pyplot as plt

<span class="nv">FUDGE</span> <span class="o">=</span> 42

<span class="c"># Load data from the brain</span>
<span class="nv">data</span> <span class="o">=</span> np.loadtxt<span class="o">(</span><span class="s1">&#39;expensive_data.csv&#39;</span>, <span class="nv">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="o">)</span>

<span class="c"># First column is something from world, second is something from brain</span>
from_world, <span class="nv">from_brain</span> <span class="o">=</span> data.T

<span class="c"># Process data</span>
<span class="nv">from_brain_processed</span> <span class="o">=</span> np.log<span class="o">(</span>from_brain<span class="o">)</span> * FUDGE * np.e ** np.pi

<span class="c"># Make plot</span>
plt.plot<span class="o">(</span>from_world, from_brain_processed, <span class="s1">&#39;r:&#39;</span><span class="o">)</span>
plt.plot<span class="o">(</span>from_world, from_brain_processed, <span class="s1">&#39;bx&#39;</span><span class="o">)</span>
plt.xlabel<span class="o">(</span><span class="s1">&#39;Data from the outside world&#39;</span><span class="o">)</span>
plt.ylabel<span class="o">(</span><span class="s1">&#39;Data from inside the brain&#39;</span><span class="o">)</span>
plt.title<span class="o">(</span><span class="s1">&#39;Important finding&#39;</span><span class="o">)</span>
plt.savefig<span class="o">(</span><span class="s1">&#39;fancy_figure.png&#39;</span><span class="o">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">I will use <code class="docutils literal"><span class="pre">git</span> <span class="pre">cat-file</span> <span class="pre">-p</span></code> to display the content of nearly raw git
objects, to show the simplicity of git&#8217;s internal model, but <code class="docutils literal"><span class="pre">cat-file</span></code>
is a specialized command that you won&#8217;t use much in daily work.</p>
</div>
<p>Just as we expected, it is the current contents of the
<code class="docutils literal"><span class="pre">clever_analysis.py</span></code>.</p>
<p>The <code class="docutils literal"><span class="pre">6560135a5943c0509608fee6d900b775e3041197</span></code> object is hashed, stored raw file.  Because the object
is a stored file rather than a stored directory listing text file or commit
message text file, git calls this type of object a <strong>blob</strong> – for Binary
Large Object.  You can see the object from the object hash with the <code class="docutils literal"><span class="pre">-t</span></code>
flag to <code class="docutils literal"><span class="pre">git</span> <span class="pre">cat-file</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git cat-file -t 6560135a5943c0509608fee6d900b775e3041197
blob
</pre></div>
</div>
</div>
<div class="section" id="hash-values-can-usually-be-abbreviated-to-seven-characters">
<h3>Hash values can usually be abbreviated to seven characters<a class="headerlink" href="#hash-values-can-usually-be-abbreviated-to-seven-characters" title="Permalink to this headline">¶</a></h3>
<p>We only need to give git enough hash digits for git to identify the object
uniquely.  7 digits is nearly always enough, as in:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git cat-file -p 6560135
<span class="c"># The brain analysis script</span>
import numpy as np

import matplotlib.pyplot as plt

<span class="nv">FUDGE</span> <span class="o">=</span> 42

<span class="c"># Load data from the brain</span>
<span class="nv">data</span> <span class="o">=</span> np.loadtxt<span class="o">(</span><span class="s1">&#39;expensive_data.csv&#39;</span>, <span class="nv">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="o">)</span>

<span class="c"># First column is something from world, second is something from brain</span>
from_world, <span class="nv">from_brain</span> <span class="o">=</span> data.T

<span class="c"># Process data</span>
<span class="nv">from_brain_processed</span> <span class="o">=</span> np.log<span class="o">(</span>from_brain<span class="o">)</span> * FUDGE * np.e ** np.pi

<span class="c"># Make plot</span>
plt.plot<span class="o">(</span>from_world, from_brain_processed, <span class="s1">&#39;r:&#39;</span><span class="o">)</span>
plt.plot<span class="o">(</span>from_world, from_brain_processed, <span class="s1">&#39;bx&#39;</span><span class="o">)</span>
plt.xlabel<span class="o">(</span><span class="s1">&#39;Data from the outside world&#39;</span><span class="o">)</span>
plt.ylabel<span class="o">(</span><span class="s1">&#39;Data from inside the brain&#39;</span><span class="o">)</span>
plt.title<span class="o">(</span><span class="s1">&#39;Important finding&#39;</span><span class="o">)</span>
plt.savefig<span class="o">(</span><span class="s1">&#39;fancy_figure.png&#39;</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="section" id="git-status-showing-the-status-of-files-in-the-working-tree">
<h3>git status – showing the status of files in the working tree<a class="headerlink" href="#git-status-showing-the-status-of-files-in-the-working-tree" title="Permalink to this headline">¶</a></h3>
<p>The working tree is the contents of the <code class="docutils literal"><span class="pre">nobel_prize</span></code> directory, excluding
the <code class="docutils literal"><span class="pre">.git</span></code> repository directory.</p>
<p><code class="docutils literal"><span class="pre">git</span> <span class="pre">status</span></code> tells us about the relationship of the files in the working
tree to the repository and staging area.</p>
<p>We have done a <code class="docutils literal"><span class="pre">git</span> <span class="pre">add</span></code> on <code class="docutils literal"><span class="pre">clever_analysis.py</span></code>, and that added the file
to the staging area.  We can see that this happened with <code class="docutils literal"><span class="pre">git</span> <span class="pre">status</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git status
On branch master

Initial commit

Changes to be committed:
  <span class="o">(</span>use <span class="s2">&quot;git rm --cached &lt;file&gt;...&quot;</span> to unstage<span class="o">)</span>

	new file:   clever_analysis.py

Untracked files:
  <span class="o">(</span>use <span class="s2">&quot;git add &lt;file&gt;...&quot;</span> to include in what will be committed<span class="o">)</span>

	expensive_data.csv
	fancy_figure.png
</pre></div>
</div>
<p>Sure enough, the output tells that <code class="docutils literal"><span class="pre">new</span> <span class="pre">file:</span> <span class="pre">clever_analysis.py</span></code> is in
the <code class="docutils literal"><span class="pre">changes</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">committed</span></code>.  It also tells us that the other two files in
the working directory are <code class="docutils literal"><span class="pre">untracked</span></code>.</p>
<p>An untracked file is a file with a filename that has never been added to the
repository with <code class="docutils literal"><span class="pre">git</span> <span class="pre">add</span></code>.  Until you run <code class="docutils literal"><span class="pre">git</span> <span class="pre">add</span></code> on an untracked file,
git will ignore these files and assume you don&#8217;t want to keep track of them.</p>
</div>
<div class="section" id="staging-the-other-files-with-git-add">
<h3>Staging the other files with git add<a class="headerlink" href="#staging-the-other-files-with-git-add" title="Permalink to this headline">¶</a></h3>
<p>We do want to keep track of the other files, so we stage them:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git add fancy_figure.png
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git add expensive_data.csv
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git status
On branch master

Initial commit

Changes to be committed:
  <span class="o">(</span>use <span class="s2">&quot;git rm --cached &lt;file&gt;...&quot;</span> to unstage<span class="o">)</span>

	new file:   clever_analysis.py
	new file:   expensive_data.csv
	new file:   fancy_figure.png
</pre></div>
</div>
<p>We have staged all three of our files.  We have three objects in
<code class="docutils literal"><span class="pre">.git/objects</span></code>:</p>
<div class="highlight-none"><div class="highlight"><pre>objects
├── pack
├── info
├── 7b
│   └── 37886351b3df2463fd29c87bc5184b637f0926 [119K]
├── 65
│   └── 60135a5943c0509608fee6d900b775e3041197 [335B]
└── 1e
    └── d447c15c125991b8a292bdb433aaf19998a3e9 [179K]
</pre></div>
</div>
</div>
<div class="section" id="git-commit-making-the-snapshot">
<h3>git commit – making the snapshot<a class="headerlink" href="#git-commit-making-the-snapshot" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git commit -m <span class="s2">&quot;First backup of my amazing idea&quot;</span>
<span class="o">[</span>master <span class="o">(</span>root-commit<span class="o">)</span> adbb65e<span class="o">]</span> First backup of my amazing idea
 <span class="m">3</span> files changed, <span class="m">5023</span> insertions<span class="o">(</span>+<span class="o">)</span>
 create mode <span class="m">100755</span> clever_analysis.py
 create mode <span class="m">100644</span> expensive_data.csv
 create mode <span class="m">100644</span> fancy_figure.png
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In the line above, I used the <code class="docutils literal"><span class="pre">-m</span></code> flag to specify a message at the
command line. If I had not done that, git would open the editor I
specified in the <code class="docutils literal"><span class="pre">git</span> <span class="pre">config</span></code> step above and ask me to enter a message.
I&#8217;m using the <code class="docutils literal"><span class="pre">-m</span></code> flag so the commit command runs without interaction
in this tutorial, but in ordinary use, I virtually never use <code class="docutils literal"><span class="pre">-m</span></code>, and I
suggest you don&#8217;t either.  Using the editor for the commit message allows
you to write a more complete commit message, and gives feedback about the
<code class="docutils literal"><span class="pre">git</span> <span class="pre">status</span></code> of the commit to remind you what you are about to do.</p>
</div>
<p>Following the logic of your SAP system, we expect that the action of making
the commit will generate two new files in <code class="docutils literal"><span class="pre">.git/objects</span></code>, one for the
directory listing text file, and another for the commit message:</p>
<div class="highlight-none"><div class="highlight"><pre>objects
├── pack
├── info
├── ff
│   └── c871b48a6b9df8dc4a13e8e5da99ccf2ce458d [150B]
├── ad
│   └── bb65e29e881a8e62d4326d66a82a8334fab0ea [148B]
├── 7b
│   └── 37886351b3df2463fd29c87bc5184b637f0926 [119K]
├── 65
│   └── 60135a5943c0509608fee6d900b775e3041197 [335B]
└── 1e
    └── d447c15c125991b8a292bdb433aaf19998a3e9 [179K]
</pre></div>
</div>
<p>Here is the contents of the commit message text file for the new commit.  Git
calls this a <strong>commit object</strong>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git cat-file -p adbb65e29e881a8e62d4326d66a82a8334fab0ea
tree ffc871b48a6b9df8dc4a13e8e5da99ccf2ce458d
author Matthew Brett &lt;matthew.brett@gmail.com&gt; <span class="m">1333315813</span> -0700
committer Matthew Brett &lt;matthew.brett@gmail.com&gt; <span class="m">1333315813</span> -0700

First backup of my amazing idea
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span><span class="c"># What type of git object is this?</span>
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git cat-file -t adbb65e29e881a8e62d4326d66a82a8334fab0ea
commit
</pre></div>
</div>
<p>As for SAP, the commit message file contains the hash for the directory tree
file (<code class="docutils literal"><span class="pre">tree</span></code>), the hash of the parent (<code class="docutils literal"><span class="pre">parent</span></code>) (but this commit has no
parents), the author, date and time, and the note.</p>
<p>Here&#8217;s the contents of the directory listing text file for the new commit.
Git calls this  a <strong>tree</strong> object.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git cat-file -p ffc871b48a6b9df8dc4a13e8e5da99ccf2ce458d
<span class="m">100755</span> blob 6560135a5943c0509608fee6d900b775e3041197	clever_analysis.py
<span class="m">100644</span> blob 7b37886351b3df2463fd29c87bc5184b637f0926	expensive_data.csv
<span class="m">100644</span> blob 1ed447c15c125991b8a292bdb433aaf19998a3e9	fancy_figure.png
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git cat-file -t ffc871b48a6b9df8dc4a13e8e5da99ccf2ce458d
tree
</pre></div>
</div>
<p>Each line in the directory listing give the file permissions, the type of the
entry in the directory (where &#8220;tree&#8221; means a sub-directory, and &#8220;blob&#8221; means a
file), the file hash, and the file name (see <a class="reference internal" href="git_object_types.html#git-object-types"><span>Types of git objects</span></a>).</p>
</div>
<div class="section" id="git-log-what-are-the-commits-so-far">
<h3>git log – what are the commits so far?<a class="headerlink" href="#git-log-what-are-the-commits-so-far" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git log
commit adbb65e29e881a8e62d4326d66a82a8334fab0ea
Author: Matthew Brett &lt;matthew.brett@gmail.com&gt;
Date:   Sun Apr <span class="m">1</span> 14:30:13 <span class="m">2012</span> -0700

    First backup of my amazing idea
</pre></div>
</div>
<p>Notice that git log identifies each commit with its hash.  As we saw above,
the hash for our commit was <code class="docutils literal"><span class="pre">adbb65e29e881a8e62d4326d66a82a8334fab0ea</span></code>.</p>
<p>We can also ask to the see the parents of each commit in the log:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git log --parents
commit adbb65e29e881a8e62d4326d66a82a8334fab0ea
Author: Matthew Brett &lt;matthew.brett@gmail.com&gt;
Date:   Sun Apr <span class="m">1</span> 14:30:13 <span class="m">2012</span> -0700

    First backup of my amazing idea
</pre></div>
</div>
<p>Why are the output of <code class="docutils literal"><span class="pre">git</span> <span class="pre">log</span></code> and <code class="docutils literal"><span class="pre">git</span> <span class="pre">log</span> <span class="pre">--parents</span></code> the same in this
case? (answer <a class="footnote-reference" href="#no-parents" id="id2">[3]</a>).</p>
</div>
<div class="section" id="git-branch-which-branch-are-we-on">
<h3>git branch - which branch are we on?<a class="headerlink" href="#git-branch-which-branch-are-we-on" title="Permalink to this headline">¶</a></h3>
<p>Branches are bookmarks. They associate a name (like &#8220;my_bookmark&#8221; or &#8220;master&#8221;)
with a commit (such as <code class="docutils literal"><span class="pre">adbb65e29e881a8e62d4326d66a82a8334fab0ea</span></code>).</p>
<p>The default branch (bookmark) for git is called <code class="docutils literal"><span class="pre">master</span></code>. Git creates it
automatically when we do our first commit.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git branch
* master
</pre></div>
</div>
<p>Asking for more verbose detail shows us that the branch is pointing to a
particular commit (where the commit is given by a hash):</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git branch -v
* master adbb65e First backup of my amazing idea
</pre></div>
</div>
<p>In this case git abbreviated the 40 character hash to the first 7 digits,
because these are enough to uniquely identify the commit.</p>
<p>A branch is nothing but a name that points to a commit.  In fact, git stores
branches as we did in SAP, as tiny text files, where the filename is the name
of the branch, and the contents is the hash of the commit that it points to:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>ls .git/refs/heads
master
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>cat .git/refs/heads/master
adbb65e29e881a8e62d4326d66a82a8334fab0ea
</pre></div>
</div>
<p>We will soon see that, if we are working on a branch, and we do a commit, then
git will update the branch to point to the new commit.</p>
</div>
<div class="section" id="a-second-commit">
<h3>A second commit<a class="headerlink" href="#a-second-commit" title="Permalink to this headline">¶</a></h3>
<p>In our second commit, we will add the first draft of the Nobel prize paper.
As before, you can download this from
<a class="reference download internal" href="_downloads/nobel_prize.md"><code class="xref download docutils literal"><span class="pre">nobel_prize.md</span></code></a>.  If you are
typing along, download <code class="docutils literal"><span class="pre">nobel_prize.md</span></code> to the <code class="docutils literal"><span class="pre">nobel_prize</span></code> directory.</p>
<p>This git repository has not seen the filename <code class="docutils literal"><span class="pre">nobel_prize.md</span></code> before, so
<code class="docutils literal"><span class="pre">git</span> <span class="pre">status</span></code> identifies this file as <strong>untracked</strong>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git status
On branch master
Untracked files:
  <span class="o">(</span>use <span class="s2">&quot;git add &lt;file&gt;...&quot;</span> to include in what will be committed<span class="o">)</span>

	nobel_prize.md

nothing added to commit but untracked files present <span class="o">(</span>use <span class="s2">&quot;git add&quot;</span> to track<span class="o">)</span>
</pre></div>
</div>
<p>We add the file to the staging area with <code class="docutils literal"><span class="pre">git</span> <span class="pre">add</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git add nobel_prize.md
</pre></div>
</div>
<p>Now <code class="docutils literal"><span class="pre">git</span> <span class="pre">status</span></code> records this file being in the staging area, by listing it
under &#8220;changes to be committed&#8221;:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git status
On branch master
Changes to be committed:
  <span class="o">(</span>use <span class="s2">&quot;git reset HEAD &lt;file&gt;...&quot;</span> to unstage<span class="o">)</span>

	new file:   nobel_prize.md
</pre></div>
</div>
<p>Finally we move the changes from the staging area into a commit with <code class="docutils literal"><span class="pre">git</span>
<span class="pre">commit</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git commit -m <span class="s2">&quot;Add first draft of paper&quot;</span>
<span class="o">[</span>master de82e02<span class="o">]</span> Add first draft of paper
 <span class="m">1</span> file changed, <span class="m">29</span> insertions<span class="o">(</span>+<span class="o">)</span>
 create mode <span class="m">100644</span> nobel_prize.md
</pre></div>
</div>
<p>Git shows us the first 7 digits of the new commit hash in the output from
<code class="docutils literal"><span class="pre">git</span> <span class="pre">commit</span></code> – these are <code class="docutils literal"><span class="pre">de82e02</span></code>.</p>
<p>Notice that the position of the current <code class="docutils literal"><span class="pre">master</span></code> branch is now this last
commit:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git branch -v
* master de82e02 Add first draft of paper
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>cat .git/refs/heads/master
de82e02cc7d8b51e84b30aa029c3b31d3d4f84e6
</pre></div>
</div>
<p>We use <code class="docutils literal"><span class="pre">git</span> <span class="pre">log</span></code> to look at our short history.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git log
commit de82e02cc7d8b51e84b30aa029c3b31d3d4f84e6
Author: Matthew Brett &lt;matthew.brett@gmail.com&gt;
Date:   Mon Apr <span class="m">2</span> 18:03:00 <span class="m">2012</span> -0700

    Add first draft of paper

commit adbb65e29e881a8e62d4326d66a82a8334fab0ea
Author: Matthew Brett &lt;matthew.brett@gmail.com&gt;
Date:   Sun Apr <span class="m">1</span> 14:30:13 <span class="m">2012</span> -0700

    First backup of my amazing idea
</pre></div>
</div>
<p>We add the <code class="docutils literal"><span class="pre">--parents</span></code> flag to show that the second commit points back to
the first via its hash.  Git lists the parent hash after the commit hash:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git log --parents
commit de82e02cc7d8b51e84b30aa029c3b31d3d4f84e6 adbb65e29e881a8e62d4326d66a82a8334fab0ea
Author: Matthew Brett &lt;matthew.brett@gmail.com&gt;
Date:   Mon Apr <span class="m">2</span> 18:03:00 <span class="m">2012</span> -0700

    Add first draft of paper

commit adbb65e29e881a8e62d4326d66a82a8334fab0ea
Author: Matthew Brett &lt;matthew.brett@gmail.com&gt;
Date:   Sun Apr <span class="m">1</span> 14:30:13 <span class="m">2012</span> -0700

    First backup of my amazing idea
</pre></div>
</div>
</div>
<div class="section" id="git-diff-what-has-changed">
<h3>git diff – what has changed?<a class="headerlink" href="#git-diff-what-has-changed" title="Permalink to this headline">¶</a></h3>
<p>Our next commit will have edits to the <code class="docutils literal"><span class="pre">clever_analysis.py</span></code> script.  We will
also refresh the figure with the result of running the script.</p>
<p>I open the <code class="docutils literal"><span class="pre">clever_analysis.py</span></code> file in text editor and adjust the fudge
factor, add a new fudge factor, and apply the new factor to the data.</p>
<p>Now I&#8217;ve done these edits, I can ask <code class="docutils literal"><span class="pre">git</span> <span class="pre">diff</span></code> to show me how the files in
my working tree differ from the files in the staging area.</p>
<p>Remember, the files the staging area knows about so far are the files as of
the last commit.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git diff
diff --git a/clever_analysis.py b/clever_analysis.py
index 6560135..99cd07b 100755
--- a/clever_analysis.py
+++ b/clever_analysis.py
@@ -3,7 +3,8 @@ import numpy as np
 
 import matplotlib.pyplot as plt
 
-FUDGE <span class="o">=</span> 42
+FUDGE <span class="o">=</span> 106
+MORE_FUDGE <span class="o">=</span> 2.0
 
 <span class="c"># Load data from the brain</span>
 <span class="nv">data</span> <span class="o">=</span> np.loadtxt<span class="o">(</span><span class="s1">&#39;expensive_data.csv&#39;</span>, <span class="nv">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="o">)</span>
@@ -13,6 +14,8 @@ from_world, <span class="nv">from_brain</span> <span class="o">=</span> data.T
 
 <span class="c"># Process data</span>
 <span class="nv">from_brain_processed</span> <span class="o">=</span> np.log<span class="o">(</span>from_brain<span class="o">)</span> * FUDGE * np.e ** np.pi
+# Apply the new factor
+from_brain_processed <span class="o">=</span> from_brain_processed / MORE_FUDGE
 
 <span class="c"># Make plot</span>
 plt.plot<span class="o">(</span>from_world, from_brain_processed, <span class="s1">&#39;r:&#39;</span><span class="o">)</span>
</pre></div>
</div>
<p>A <code class="docutils literal"><span class="pre">-</span></code> at the beginning of the <code class="docutils literal"><span class="pre">git</span> <span class="pre">diff</span></code> output means I have removed this
line.  A <code class="docutils literal"><span class="pre">+</span></code> at the beginning means I have added this line.  As you see I
have edited one line in this file, and added three more.</p>
<p>Open your text editor and edit <code class="docutils literal"><span class="pre">clever_analysis.py</span></code>.  See if you can
replicate my changes by editing the file, and checking with <code class="docutils literal"><span class="pre">git</span> <span class="pre">diff</span></code>.</p>
<p>Now check the status of <code class="docutils literal"><span class="pre">clever_analysis.py</span></code> with:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git status
On branch master
Changes not staged <span class="k">for</span> commit:
  <span class="o">(</span>use <span class="s2">&quot;git add &lt;file&gt;...&quot;</span> to update what will be committed<span class="o">)</span>
  <span class="o">(</span>use <span class="s2">&quot;git checkout -- &lt;file&gt;...&quot;</span> to discard changes in working directory<span class="o">)</span>

	modified:   clever_analysis.py

no changes added to commit <span class="o">(</span>use <span class="s2">&quot;git add&quot;</span> and/or <span class="s2">&quot;git commit -a&quot;</span><span class="o">)</span>
</pre></div>
</div>
</div>
<div class="section" id="you-need-to-git-add-a-file-to-put-it-into-the-staging-area">
<h3>You need to <code class="docutils literal"><span class="pre">git</span> <span class="pre">add</span></code> a file to put it into the staging area<a class="headerlink" href="#you-need-to-git-add-a-file-to-put-it-into-the-staging-area" title="Permalink to this headline">¶</a></h3>
<p>Remember that git only commits stuff that you have added to the staging area.</p>
<p><code class="docutils literal"><span class="pre">git</span> <span class="pre">status</span></code> tells us that <code class="docutils literal"><span class="pre">clever_analysis.py</span></code> has been &#8220;modified&#8221;, and
that these changes are &#8220;not staged for commit&#8221;.</p>
<p>There is a version of <code class="docutils literal"><span class="pre">clever_analysis.py</span></code> in the staging area, but it is
the version of the file as of the last commit, and so that version is
different from the version we have in the working tree.</p>
<p>If we try to do a commit, git will tell us there is nothing to commit, because
there is nothing new in the staging area:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git commit
On branch master
Changes not staged <span class="k">for</span> commit:
	modified:   clever_analysis.py

no changes added to commit
</pre></div>
</div>
<p>To stage this version of <code class="docutils literal"><span class="pre">clever_analysis.py</span></code> we use <code class="docutils literal"><span class="pre">git</span> <span class="pre">add</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git add clever_analysis.py
</pre></div>
</div>
<p>Git status now shows these changes as &#8220;Changes to be committed&#8221;.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git status
On branch master
Changes to be committed:
  <span class="o">(</span>use <span class="s2">&quot;git reset HEAD &lt;file&gt;...&quot;</span> to unstage<span class="o">)</span>

	modified:   clever_analysis.py
</pre></div>
</div>
<p>We can update the figure by running the <code class="docutils literal"><span class="pre">analysis_script.py</span></code> script.  The
script analyzes the data and writes the figure to the current directory.  If
you have Python installed, with the <code class="docutils literal"><span class="pre">numpy</span></code> and <code class="docutils literal"><span class="pre">matplotlib</span></code> packages, you
can run the analysis yourself with:</p>
<div class="highlight-python"><div class="highlight"><pre>python clever_analysis.py
</pre></div>
</div>
<p>If not, you can download a <a class="reference download internal" href="_downloads/fancy_figure.png"><code class="xref download docutils literal"><span class="pre">version</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">figure</span> <span class="pre">I</span> <span class="pre">generated</span>
<span class="pre">earlier</span></code></a>.  After you have generated or
downloaded the figure:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git add fancy_figure.png
</pre></div>
</div>
<p>Do a final check with <code class="docutils literal"><span class="pre">git</span> <span class="pre">status</span></code>, then make the commit with:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git commit -m <span class="s2">&quot;Add another fudge factor&quot;</span>
<span class="o">[</span>master f253e97<span class="o">]</span> Add another fudge factor
 <span class="m">2</span> files changed, <span class="m">4</span> insertions<span class="o">(</span>+<span class="o">)</span>, <span class="m">1</span> deletion<span class="o">(</span>-<span class="o">)</span>
 rewrite fancy_figure.png <span class="o">(</span>96%<span class="o">)</span>
</pre></div>
</div>
<p>The branch bookmark has moved again:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git branch -v
* master f253e97 Add another fudge factor
</pre></div>
</div>
</div>
<div class="section" id="an-ordinary-day-in-gitworld">
<h3>An ordinary day in gitworld<a class="headerlink" href="#an-ordinary-day-in-gitworld" title="Permalink to this headline">¶</a></h3>
<p>We now have the main commands for daily work with git;</p>
<ul class="simple">
<li>Make some changes in the working tree;</li>
<li>Check what has changed with <code class="docutils literal"><span class="pre">git</span> <span class="pre">status</span></code>;</li>
<li>Review the changes with <code class="docutils literal"><span class="pre">git</span> <span class="pre">diff</span></code>;</li>
<li>Add changes to the staging area with <code class="docutils literal"><span class="pre">git</span> <span class="pre">add</span></code>;</li>
<li>Make the commit with <code class="docutils literal"><span class="pre">git</span> <span class="pre">commit</span></code>.</li>
</ul>
</div>
<div class="section" id="commit-four">
<h3>Commit four<a class="headerlink" href="#commit-four" title="Permalink to this headline">¶</a></h3>
<p>For our next commit, we will add some more changes to the analysis script and
figure, and add a new file, <code class="docutils literal"><span class="pre">references.bib</span></code>.</p>
<p>To follow along, first download <a class="reference download internal" href="_downloads/references.bib"><code class="xref download docutils literal"><span class="pre">references.bib</span></code></a>.</p>
<p>Next, edit <code class="docutils literal"><span class="pre">clever_analysis.py</span></code> again, to make these changes:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git diff
diff --git a/clever_analysis.py b/clever_analysis.py
index 99cd07b..e5b2efa 100755
--- a/clever_analysis.py
+++ b/clever_analysis.py
@@ -5,6 +5,7 @@ import matplotlib.pyplot as plt
 
 <span class="nv">FUDGE</span> <span class="o">=</span> 106
 <span class="nv">MORE_FUDGE</span> <span class="o">=</span> 2.0
+NUDGE_FUDGE <span class="o">=</span> 1.25
 
 <span class="c"># Load data from the brain</span>
 <span class="nv">data</span> <span class="o">=</span> np.loadtxt<span class="o">(</span><span class="s1">&#39;expensive_data.csv&#39;</span>, <span class="nv">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="o">)</span>
@@ -14,8 +15,8 @@ from_world, <span class="nv">from_brain</span> <span class="o">=</span> data.T
 
 <span class="c"># Process data</span>
 <span class="nv">from_brain_processed</span> <span class="o">=</span> np.log<span class="o">(</span>from_brain<span class="o">)</span> * FUDGE * np.e ** np.pi
-# Apply the new factor
-from_brain_processed <span class="o">=</span> from_brain_processed / MORE_FUDGE
+# Apply the new factor<span class="o">(</span>s<span class="o">)</span>
+from_brain_processed <span class="o">=</span> from_brain_processed / MORE_FUDGE / NUDGE_FUDGE
 
 <span class="c"># Make plot</span>
 plt.plot<span class="o">(</span>from_world, from_brain_processed, <span class="s1">&#39;r:&#39;</span><span class="o">)</span>
</pre></div>
</div>
<p>Finally regenerate <code class="docutils literal"><span class="pre">fancy_figure.png</span></code>, or download the updated copy
<a class="reference download internal" href="_downloads/fancy_figure1.png"><code class="xref download docutils literal"><span class="pre">from</span> <span class="pre">here</span></code></a>.</p>
<p>What will git status show now?</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git status
On branch master
Changes not staged <span class="k">for</span> commit:
  <span class="o">(</span>use <span class="s2">&quot;git add &lt;file&gt;...&quot;</span> to update what will be committed<span class="o">)</span>
  <span class="o">(</span>use <span class="s2">&quot;git checkout -- &lt;file&gt;...&quot;</span> to discard changes in working directory<span class="o">)</span>

	modified:   clever_analysis.py
	modified:   fancy_figure.png

Untracked files:
  <span class="o">(</span>use <span class="s2">&quot;git add &lt;file&gt;...&quot;</span> to include in what will be committed<span class="o">)</span>

	references.bib

no changes added to commit <span class="o">(</span>use <span class="s2">&quot;git add&quot;</span> and/or <span class="s2">&quot;git commit -a&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>Git has not previously seen a file called <code class="docutils literal"><span class="pre">references.bib</span></code> so this file is
&#8220;untracked&#8221;.  Git has seen <code class="docutils literal"><span class="pre">clever_analysis.py</span></code> and <code class="docutils literal"><span class="pre">fancy_figure.png</span></code>, so
these files are tracked, and git sees that they are modified compared to the
copy that the staging area knows about.</p>
<p>Before we add our changes, we confirm that they are as we expect with:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git diff
diff --git a/clever_analysis.py b/clever_analysis.py
index 99cd07b..e5b2efa 100755
--- a/clever_analysis.py
+++ b/clever_analysis.py
@@ -5,6 +5,7 @@ import matplotlib.pyplot as plt
 
 <span class="nv">FUDGE</span> <span class="o">=</span> 106
 <span class="nv">MORE_FUDGE</span> <span class="o">=</span> 2.0
+NUDGE_FUDGE <span class="o">=</span> 1.25
 
 <span class="c"># Load data from the brain</span>
 <span class="nv">data</span> <span class="o">=</span> np.loadtxt<span class="o">(</span><span class="s1">&#39;expensive_data.csv&#39;</span>, <span class="nv">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="o">)</span>
@@ -14,8 +15,8 @@ from_world, <span class="nv">from_brain</span> <span class="o">=</span> data.T
 
 <span class="c"># Process data</span>
 <span class="nv">from_brain_processed</span> <span class="o">=</span> np.log<span class="o">(</span>from_brain<span class="o">)</span> * FUDGE * np.e ** np.pi
-# Apply the new factor
-from_brain_processed <span class="o">=</span> from_brain_processed / MORE_FUDGE
+# Apply the new factor<span class="o">(</span>s<span class="o">)</span>
+from_brain_processed <span class="o">=</span> from_brain_processed / MORE_FUDGE / NUDGE_FUDGE
 
 <span class="c"># Make plot</span>
 plt.plot<span class="o">(</span>from_world, from_brain_processed, <span class="s1">&#39;r:&#39;</span><span class="o">)</span>
diff --git a/fancy_figure.png b/fancy_figure.png
index 81fc437..d1f40df 100644
Binary files a/fancy_figure.png and b/fancy_figure.png differ
</pre></div>
</div>
<p>Notice that git does not try and show the line-by-line differences between the
old and new figures, guessing correctly that this is a binary and not a text
file.</p>
<p>Now we have reviewed the changes, we add them to the staging area and commit:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git add references.bib
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git add clever_analysis.py
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git add fancy_figure.png
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git commit -m <span class="s2">&quot;Change analysis and add references&quot;</span>
<span class="o">[</span>master 8c1ff7e<span class="o">]</span> Change analysis and add references
 <span class="m">3</span> files changed, <span class="m">13</span> insertions<span class="o">(</span>+<span class="o">)</span>, <span class="m">2</span> deletions<span class="o">(</span>-<span class="o">)</span>
 rewrite fancy_figure.png <span class="o">(</span>89%<span class="o">)</span>
 create mode <span class="m">100644</span> references.bib
</pre></div>
</div>
<p>The branch bookmark has moved to point to the new commit:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git branch -v
* master 8c1ff7e Change analysis and add references
</pre></div>
</div>
</div>
<div class="section" id="undoing-a-commit-with-git-reset">
<h3>Undoing a commit with <code class="docutils literal"><span class="pre">git</span> <span class="pre">reset</span></code><a class="headerlink" href="#undoing-a-commit-with-git-reset" title="Permalink to this headline">¶</a></h3>
<p>As you found in the SAP story, this last commit doesn&#8217;t look quite right,
because the commit message refers to two different types of changes.  With
more git experience, you will likely find that you like to break your changes
into commits where the changes have a particular theme or purpose.  This makes
it easier to see what happened when you look over the history and the commit
messages with <code class="docutils literal"><span class="pre">git</span> <span class="pre">log</span></code>.</p>
<p>So, as in the SAP story, you decide to undo the last commit, and replace it
with two commits:</p>
<ul class="simple">
<li>One commit to add the changes to the script and figure;</li>
<li>Another commit on top of the first, to add the references file.</li>
</ul>
<p>In the SAP story, you had to delete a snapshot directory manually, and reset
the staging area directory to have the contents of the previous commit.  In
git, all we have to do is reset the current <code class="docutils literal"><span class="pre">master</span></code> branch bookmark to
point to the previous commit.  By default, git will also reset the staging
area for us.  The command to move the branch bookmark is <code class="docutils literal"><span class="pre">git</span> <span class="pre">reset</span></code>.</p>
</div>
<div class="section" id="pointing-backwards-in-history">
<h3>Pointing backwards in history<a class="headerlink" href="#pointing-backwards-in-history" title="Permalink to this headline">¶</a></h3>
<p>The commit that we want the branch to point to is the previous commit in our
commit history.  We can use <code class="docutils literal"><span class="pre">git</span> <span class="pre">log</span></code> to see that this commit has hash
<code class="docutils literal"><span class="pre">f253e97</span></code>.  So, we could do our reset with <code class="docutils literal"><span class="pre">git</span> <span class="pre">reset</span></code>
<code class="docutils literal"><span class="pre">f253e97</span></code>.  There is a simpler and more readable way to write this
common idea, of one commit back in history, and that is to add <code class="docutils literal"><span class="pre">~1</span></code> to a
reference.  For example, to refer to the commit that is one step back in the
history from the commit pointed to by the <code class="docutils literal"><span class="pre">master</span></code> branch, you can write
<code class="docutils literal"><span class="pre">master~1</span></code>.  Because <code class="docutils literal"><span class="pre">master</span></code> points to commit <code class="docutils literal"><span class="pre">8c1ff7e</span></code>, you could
also append the <code class="docutils literal"><span class="pre">~1</span></code> to <code class="docutils literal"><span class="pre">8c1ff7e</span></code>.  You can imagine that <code class="docutils literal"><span class="pre">master~2</span></code>
will point two steps back in the commit history, and so on.</p>
<p>So, a readable reset command for our purpose is:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git reset master~1
Unstaged changes after reset:
M	clever_analysis.py
M	fancy_figure.png
</pre></div>
</div>
<p>Notice that the branch pointer now points to the previous commit:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git branch -v
* master f253e97 Add another fudge factor
</pre></div>
</div>
<p>Remember in SAP that your procedure for breaking up the snapshot was to 1)
delete the old snapshot and 2) reset the staging area to reflect the previous
commit.  After you did this, the working tree contains your changes, but the
staging area does not.  You could make your new commits in the usual way, by
adding to the staging area, and doing the commits.</p>
<p>Notice that <code class="docutils literal"><span class="pre">git</span> <span class="pre">reset</span></code> has done the same thing.  It has reset the staging
area to the state as of the older commit, but it has left the working tree
alone.  That means that <code class="docutils literal"><span class="pre">git</span> <span class="pre">status</span></code> will show us the changes in the working
tree compared to the commit we have just reset to:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git status
On branch master
Changes not staged <span class="k">for</span> commit:
  <span class="o">(</span>use <span class="s2">&quot;git add &lt;file&gt;...&quot;</span> to update what will be committed<span class="o">)</span>
  <span class="o">(</span>use <span class="s2">&quot;git checkout -- &lt;file&gt;...&quot;</span> to discard changes in working directory<span class="o">)</span>

	modified:   clever_analysis.py
	modified:   fancy_figure.png

Untracked files:
  <span class="o">(</span>use <span class="s2">&quot;git add &lt;file&gt;...&quot;</span> to include in what will be committed<span class="o">)</span>

	references.bib

no changes added to commit <span class="o">(</span>use <span class="s2">&quot;git add&quot;</span> and/or <span class="s2">&quot;git commit -a&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>We have the changes from our original fourth commit in our working tree, but
we have not staged them.  We are ready to make our new separate commits.</p>
</div>
<div class="section" id="a-new-fourth-commit">
<h3>A new fourth commit<a class="headerlink" href="#a-new-fourth-commit" title="Permalink to this headline">¶</a></h3>
<p>As we planned, we make a commit by adding only the changes from the script and
figure:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git add clever_analysis.py
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git add fancy_figure.png
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git commit -m <span class="s2">&quot;Change parameters of analysis&quot;</span>
<span class="o">[</span>master cd5feb3<span class="o">]</span> Change parameters of analysis
 <span class="m">2</span> files changed, <span class="m">3</span> insertions<span class="o">(</span>+<span class="o">)</span>, <span class="m">2</span> deletions<span class="o">(</span>-<span class="o">)</span>
 rewrite fancy_figure.png <span class="o">(</span>89%<span class="o">)</span>
</pre></div>
</div>
<p>Notice that git status now tells us that we still have untracked (and
therefore not staged) changes in our working tree:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git status
On branch master
Untracked files:
  <span class="o">(</span>use <span class="s2">&quot;git add &lt;file&gt;...&quot;</span> to include in what will be committed<span class="o">)</span>

	references.bib

nothing added to commit but untracked files present <span class="o">(</span>use <span class="s2">&quot;git add&quot;</span> to track<span class="o">)</span>
</pre></div>
</div>
</div>
<div class="section" id="the-fifth-commit">
<h3>The fifth commit<a class="headerlink" href="#the-fifth-commit" title="Permalink to this headline">¶</a></h3>
<p>To finish our work splitting the fourth commit into two, we add and commit the
<code class="docutils literal"><span class="pre">references.bib</span></code> file:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git add references.bib
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git commit -m <span class="s2">&quot;Add references&quot;</span>
<span class="o">[</span>master 3a666f1<span class="o">]</span> Add references
 <span class="m">1</span> file changed, <span class="m">10</span> insertions<span class="o">(</span>+<span class="o">)</span>
 create mode <span class="m">100644</span> references.bib
</pre></div>
</div>
</div>
<div class="section" id="getting-a-file-from-a-previous-commit-git-checkout">
<h3>Getting a file from a previous commit – <code class="docutils literal"><span class="pre">git</span> <span class="pre">checkout</span></code><a class="headerlink" href="#getting-a-file-from-a-previous-commit-git-checkout" title="Permalink to this headline">¶</a></h3>
<p>In the SAP story, we found that the first version of the analysis script was
correct, and we made a new commit after restoring this version from the first
snapshot.</p>
<p>As you can imagine, git allows us to do that too.  The command to do this is
<code class="docutils literal"><span class="pre">git</span> <span class="pre">checkout</span></code></p>
<p>If you have a look at <code class="docutils literal"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">--help</span></code> you will see that git checkout
has two roles, described in the help as &#8220;Checkout a branch or paths to the
working tree&#8221;.  We will see checking out a branch later, but here we are using
checkout in its second role, to restore files to the working tree.</p>
<p>We do this by telling git checkout which version we want, and what file we
want.  We want the version of <code class="docutils literal"><span class="pre">clever_analysis.py</span></code> as of the first commit.
To find the first commit, we can use git log.  To make git log a bit less
verbose, I&#8217;ve added the <code class="docutils literal"><span class="pre">--oneline</span></code> flag, to print out one line per commit:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git log --oneline
3a666f1 Add references
cd5feb3 Change parameters of analysis
f253e97 Add another fudge factor
de82e02 Add first draft of paper
adbb65e First backup of my amazing idea
</pre></div>
</div>
<p>Now we have the abbreviated commit hash for the first commit, we can checkout
that version to the working tree:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git checkout adbb65e clever_analysis.py
</pre></div>
</div>
<p>We also want the previous version of the figure:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git checkout adbb65e fancy_figure.png
</pre></div>
</div>
<p>Notice that the checkout also added the files to the staging area:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git status
On branch master
Changes to be committed:
  <span class="o">(</span>use <span class="s2">&quot;git reset HEAD &lt;file&gt;...&quot;</span> to unstage<span class="o">)</span>

	modified:   clever_analysis.py
	modified:   fancy_figure.png
</pre></div>
</div>
<p>We are ready for our sixth commit:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git commit -m <span class="s2">&quot;Revert to original script &amp; figure&quot;</span>
<span class="o">[</span>master 09e59b6<span class="o">]</span> Revert to original script <span class="p">&amp;</span> figure
 <span class="m">2</span> files changed, <span class="m">1</span> insertion<span class="o">(</span>+<span class="o">)</span>, <span class="m">5</span> deletions<span class="o">(</span>-<span class="o">)</span>
 rewrite fancy_figure.png <span class="o">(</span>97%<span class="o">)</span>
</pre></div>
</div>
</div>
<div class="section" id="using-bookmarks-git-branch">
<h3>Using bookmarks – <code class="docutils literal"><span class="pre">git</span> <span class="pre">branch</span></code><a class="headerlink" href="#using-bookmarks-git-branch" title="Permalink to this headline">¶</a></h3>
<p>We are at the stage in the SAP story where Josephine goes away to the
conference.</p>
<p>Let us pretend that we are Josephine, and that we have taken a copy of the
working directory to the conference.</p>
<p>We as Josephine don&#8217;t want to change the previous bookmark, which is
<code class="docutils literal"><span class="pre">master</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git branch -v
* master 09e59b6 Revert to original script <span class="p">&amp;</span> figure
</pre></div>
</div>
<p>We would like to use our own bookmark, so we can make changes without
affecting anyone else.  To do this we use <code class="docutils literal"><span class="pre">git</span> <span class="pre">branch</span></code> with arguments:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git branch josephines-branch master
</pre></div>
</div>
<p>The first argument is the name of the branch we want to create.  The second is
the commit at which the branch should start.  Now we have a new branch, that
currently points to the same commit as <code class="docutils literal"><span class="pre">master</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git branch -v
  josephines-branch 09e59b6 Revert to original script <span class="p">&amp;</span> figure
* master            09e59b6 Revert to original script <span class="p">&amp;</span> figure
</pre></div>
</div>
<p>The new branch is nothing but a text file pointing to the commit:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>cat .git/refs/heads/josephines-branch
09e59b6f7e062183b9d4ef45f093d0d2e46937a0
</pre></div>
</div>
<p>Now we have two branches, git needs to know which branch we are working on.
The asterisk next to <code class="docutils literal"><span class="pre">master</span></code> in the output of <code class="docutils literal"><span class="pre">git</span> <span class="pre">branch</span></code> means that we
are working on <code class="docutils literal"><span class="pre">master</span></code> at the moment.  If we make another commit, it will
update the <code class="docutils literal"><span class="pre">master</span></code> bookmark.</p>
<p>Git stores the current branch in the file <code class="docutils literal"><span class="pre">.git/HEAD</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>cat .git/HEAD
ref: refs/heads/master
</pre></div>
</div>
<p>Git commands often allow you to write <code class="docutils literal"><span class="pre">HEAD</span></code> meaning &#8220;the branch or commit
you are currently working on&#8221;.  For example, <code class="docutils literal"><span class="pre">git</span> <span class="pre">log</span> <span class="pre">HEAD</span></code> means &#8220;show the
log starting at the branch or commit you are currently working on&#8221;.  In fact,
this is also the default behavior of <code class="docutils literal"><span class="pre">git</span> <span class="pre">log</span></code>.</p>
<p>We now want to make <code class="docutils literal"><span class="pre">josephines-branch</span></code> current, so any new commits will
update <code class="docutils literal"><span class="pre">josephines-branch</span></code> instead of <code class="docutils literal"><span class="pre">master</span></code>.</p>
</div>
<div class="section" id="changing-the-current-branch-with-git-checkout">
<h3>Changing the current branch with <code class="docutils literal"><span class="pre">git</span> <span class="pre">checkout</span></code><a class="headerlink" href="#changing-the-current-branch-with-git-checkout" title="Permalink to this headline">¶</a></h3>
<p>We previously saw that <code class="docutils literal"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">&lt;commit&gt;</span> <span class="pre">&lt;filename&gt;</span></code> will get the
file <code class="docutils literal"><span class="pre">&lt;filename&gt;</span></code> as of commit <code class="docutils literal"><span class="pre">&lt;commit&gt;</span></code>, and restore it to the working
tree.  This was the second of the two uses of <code class="docutils literal"><span class="pre">git</span> <span class="pre">checkout</span></code>.  We now come
to the first and most common use of <code class="docutils literal"><span class="pre">git</span> <span class="pre">checkout</span></code>, which is to:</p>
<ul class="simple">
<li>change the current branch to a given branch or commit;</li>
<li>restore the working tree and staging area to the file versions from the
given commit.</li>
</ul>
<p>We are about to do <code class="docutils literal"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">josephines-branch</span></code>.  When we do this, we
are only going to see the first of these two effects, because <code class="docutils literal"><span class="pre">master</span></code> and
<code class="docutils literal"><span class="pre">josephines-branch</span></code> point to the same commit, and so have the same file
contents:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git checkout josephines-branch
Switched to branch <span class="s1">&#39;josephines-branch&#39;</span>
</pre></div>
</div>
<p>The asterisk has now moved to <code class="docutils literal"><span class="pre">josephines-branch</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git branch -v
* josephines-branch 09e59b6 Revert to original script <span class="p">&amp;</span> figure
  master            09e59b6 Revert to original script <span class="p">&amp;</span> figure
</pre></div>
</div>
<p>This is because the file <code class="docutils literal"><span class="pre">HEAD</span></code> now points to <code class="docutils literal"><span class="pre">josephines-branch</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>cat .git/HEAD
ref: refs/heads/josephines-branch
</pre></div>
</div>
<p>If we do a commit, git will update <code class="docutils literal"><span class="pre">josephines-branch</span></code>, not <code class="docutils literal"><span class="pre">master</span></code>.</p>
</div>
<div class="section" id="making-commits-on-branches">
<h3>Making commits on branches<a class="headerlink" href="#making-commits-on-branches" title="Permalink to this headline">¶</a></h3>
<p>Josephine did some edits to the paper.  If you are typing along, make these
changes to <code class="docutils literal"><span class="pre">nobel_prize.md</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre>[desktop]$ git diff
diff --git a/nobel_prize.md b/nobel_prize.md
index 3ef5df2..19fd4c5 100644
--- a/nobel_prize.md
+++ b/nobel_prize.md
@@ -5,6 +5,12 @@
 The brain thinks in straight lines once you do some poorly-motivated
 corrections on some brain recordings.
 
+Other people have done brain recordings and claimed that they were
+interesting, but they are not as interesting as our recordings.
+
+In our previous work, we have done some other brain recordings, that were also
+interesting, but in a different way.
+
 == Methods
 
 We took some recordings of someone&#39;s brain while we showed them stuff
</pre></div>
</div>
<p>As usual, we add the file to the staging area, and check the status of the
working tree:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git add nobel_prize.md
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git status
On branch josephines-branch
Changes to be committed:
  <span class="o">(</span>use <span class="s2">&quot;git reset HEAD &lt;file&gt;...&quot;</span> to unstage<span class="o">)</span>

	modified:   nobel_prize.md
</pre></div>
</div>
<p>Finally we make the commit:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git commit -m <span class="s2">&quot;Expand the introduction&quot;</span>
<span class="o">[</span>josephines-branch 740d747<span class="o">]</span> Expand the introduction
 <span class="m">1</span> file changed, <span class="m">6</span> insertions<span class="o">(</span>+<span class="o">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">master</span></code> branch has not changed, but <code class="docutils literal"><span class="pre">josephines-branch</span></code> changed to
point to the new commit:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git branch -v
* josephines-branch 740d747 Expand the introduction
  master            09e59b6 Revert to original script <span class="p">&amp;</span> figure
</pre></div>
</div>
<p>Now we go back to being ourselves, working in the lab.  We change back to the
<code class="docutils literal"><span class="pre">master</span></code> branch:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git checkout master
Switched to branch <span class="s1">&#39;master&#39;</span>
</pre></div>
</div>
<p>The asterisk now points at <code class="docutils literal"><span class="pre">master</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git branch -v
  josephines-branch 740d747 Expand the introduction
* master            09e59b6 Revert to original script <span class="p">&amp;</span> figure
</pre></div>
</div>
<p>If you look at the contents of <code class="docutils literal"><span class="pre">nobel_prize.md</span></code> in the working directory,
you will see that we are back to the contents before Josephine&#8217;s changes.
This is because <code class="docutils literal"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">master</span></code> reverted the files to their state as
of the last commit on the <code class="docutils literal"><span class="pre">master</span></code> branch.</p>
<p>Now we make our own changes to the script and figure. Here are the changes to
the script:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git diff
diff --git a/clever_analysis.py b/clever_analysis.py
index 6560135..cf163af 100755
--- a/clever_analysis.py
+++ b/clever_analysis.py
@@ -4,6 +4,7 @@ import numpy as np
 import matplotlib.pyplot as plt
 
 <span class="nv">FUDGE</span> <span class="o">=</span> 42
+HOT_FUDGE <span class="o">=</span> 1.707
 
 <span class="c"># Load data from the brain</span>
 <span class="nv">data</span> <span class="o">=</span> np.loadtxt<span class="o">(</span><span class="s1">&#39;expensive_data.csv&#39;</span>, <span class="nv">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="o">)</span>
@@ -13,6 +14,7 @@ from_world, <span class="nv">from_brain</span> <span class="o">=</span> data.T
 
 <span class="c"># Process data</span>
 <span class="nv">from_brain_processed</span> <span class="o">=</span> np.log<span class="o">(</span>from_brain<span class="o">)</span> * FUDGE * np.e ** np.pi
+from_brain_processed <span class="o">=</span> from_brain_processed / HOT_FUDGE
 
 <span class="c"># Make plot</span>
 plt.plot<span class="o">(</span>from_world, from_brain_processed, <span class="s1">&#39;r:&#39;</span><span class="o">)</span>
</pre></div>
</div>
<p>If you are typing along, then you will also want to regenerate the figure with
<code class="docutils literal"><span class="pre">python</span> <span class="pre">clever_analysis.py</span></code> or <a class="reference download internal" href="_downloads/fancy_figure2.png"><code class="xref download docutils literal"><span class="pre">download</span> <span class="pre">the</span> <span class="pre">new</span> <span class="pre">version</span></code></a>.</p>
<p>This gives:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git status
On branch master
Changes not staged <span class="k">for</span> commit:
  <span class="o">(</span>use <span class="s2">&quot;git add &lt;file&gt;...&quot;</span> to update what will be committed<span class="o">)</span>
  <span class="o">(</span>use <span class="s2">&quot;git checkout -- &lt;file&gt;...&quot;</span> to discard changes in working directory<span class="o">)</span>

	modified:   clever_analysis.py
	modified:   fancy_figure.png

no changes added to commit <span class="o">(</span>use <span class="s2">&quot;git add&quot;</span> and/or <span class="s2">&quot;git commit -a&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>As usual, we add the files and do the commit:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git add clever_analysis.py
<span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git add fancy_figure.png
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git commit -m <span class="s2">&quot;More fun with fudge&quot;</span>
<span class="o">[</span>master 191c946<span class="o">]</span> More fun with fudge
 <span class="m">2</span> files changed, <span class="m">2</span> insertions<span class="o">(</span>+<span class="o">)</span>
 rewrite fancy_figure.png <span class="o">(</span>96%<span class="o">)</span>
</pre></div>
</div>
<p>Because <code class="docutils literal"><span class="pre">HEAD</span></code> currently current points to <code class="docutils literal"><span class="pre">master</span></code>, git updated the
<code class="docutils literal"><span class="pre">master</span></code> branch with the new commit:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git branch -v
  josephines-branch 740d747 Expand the introduction
* master            191c946 More fun with fudge
</pre></div>
</div>
</div>
<div class="section" id="merging-lines-of-development-with-git-merge">
<h3>Merging lines of development with <code class="docutils literal"><span class="pre">git</span> <span class="pre">merge</span></code><a class="headerlink" href="#merging-lines-of-development-with-git-merge" title="Permalink to this headline">¶</a></h3>
<p>We next want to get Josephine&#8217;s changes into the <code class="docutils literal"><span class="pre">master</span></code> branch.</p>
<p>We do this with <code class="docutils literal"><span class="pre">git</span> <span class="pre">merge</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git merge josephines-branch
Merge made by the <span class="s1">&#39;recursive&#39;</span> strategy.
 nobel_prize.md <span class="p">|</span> <span class="m">6</span> ++++++
 <span class="m">1</span> file changed, <span class="m">6</span> insertions<span class="o">(</span>+<span class="o">)</span>
</pre></div>
</div>
<p>This commit has the changes we just made to the script and figure, and the
changes the Josephine made to the paper.</p>
<p>The commit has two parents, which are the two commits from which we merged:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git log --oneline --parents
5d2ca89 191c946 740d747 Merge branch <span class="s1">&#39;josephines-branch&#39;</span>
740d747 09e59b6 Expand the introduction
191c946 09e59b6 More fun with fudge
09e59b6 3a666f1 Revert to original script <span class="p">&amp;</span> figure
3a666f1 cd5feb3 Add references
cd5feb3 f253e97 Change parameters of analysis
f253e97 de82e02 Add another fudge factor
de82e02 adbb65e Add first draft of paper
adbb65e First backup of my amazing idea
</pre></div>
</div>
</div>
<div class="section" id="the-commit-parents-make-the-development-history-into-a-graph">
<h3>The commit parents make the development history into a graph<a class="headerlink" href="#the-commit-parents-make-the-development-history-into-a-graph" title="Permalink to this headline">¶</a></h3>
<p>As you saw in your SAP system, we can think of the commits as nodes in a
graph.  Each commit stores the identity of its parent commit(s).  The pointers
from each commit back to its parent(s) link the commits (nodes) to form edges.</p>
<p>It is common to see a git history shown as a graph, and it is often useful to
think of this graph when we are working with a git repository.</p>
<p>There are a lot of graphical tools to show the git history as a graph, but
<code class="docutils literal"><span class="pre">git</span> <span class="pre">log</span></code> has a useful flag called <code class="docutils literal"><span class="pre">--graph</span></code> which shows the commits as a
graph using text characters:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git log --oneline --graph
*   5d2ca89 Merge branch <span class="s1">&#39;josephines-branch&#39;</span>
<span class="p">|</span><span class="se">\ </span> 
<span class="p">|</span> * 740d747 Expand the introduction
* <span class="p">|</span> 191c946 More fun with fudge
<span class="p">|</span>/  
* 09e59b6 Revert to original script <span class="p">&amp;</span> figure
* 3a666f1 Add references
* cd5feb3 Change parameters of analysis
* f253e97 Add another fudge factor
* de82e02 Add first draft of paper
* adbb65e First backup of my amazing idea
</pre></div>
</div>
<p>This kind of display is so useful that many of us have a shortcut to this
command, that we use instead of the standard git log.  You can make customized
shortcuts to git commands by setting <code class="docutils literal"><span class="pre">alias</span></code> entries using <code class="docutils literal"><span class="pre">git</span> <span class="pre">config</span></code>.
For example, you may want to set up an alias like this:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git config --global alias.slog <span class="s2">&quot;log --oneline --graph&quot;</span>
</pre></div>
</div>
<p>Now you can use the command <code class="docutils literal"><span class="pre">git</span> <span class="pre">slog</span></code> to mean <code class="docutils literal"><span class="pre">git</span> <span class="pre">log</span> <span class="pre">--oneline</span>
<span class="pre">--graph</span></code>.  Because of the <code class="docutils literal"><span class="pre">--global</span></code> flag, this command sets up the
<code class="docutils literal"><span class="pre">slog</span></code> alias as the default for your user account, so you can use <code class="docutils literal"><span class="pre">git</span>
<span class="pre">slog</span></code> whenever you are using git as this user on this computer.</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="o">[</span>desktop<span class="o">]</span><span class="nv">$ </span>git slog
*   5d2ca89 Merge branch <span class="s1">&#39;josephines-branch&#39;</span>
<span class="p">|</span><span class="se">\ </span> 
<span class="p">|</span> * 740d747 Expand the introduction
* <span class="p">|</span> 191c946 More fun with fudge
<span class="p">|</span>/  
* 09e59b6 Revert to original script <span class="p">&amp;</span> figure
* 3a666f1 Add references
* cd5feb3 Change parameters of analysis
* f253e97 Add another fudge factor
* de82e02 Add first draft of paper
* adbb65e First backup of my amazing idea
</pre></div>
</div>
</div>
<div class="section" id="other-commands-you-need-to-know">
<h3>Other commands you need to know<a class="headerlink" href="#other-commands-you-need-to-know" title="Permalink to this headline">¶</a></h3>
<p>This tutorial gives you the basics on working with files on your own computer,
and on your own repository.</p>
<p>You will also need to know about:</p>
<ul class="simple">
<li>git remotes – making backups; working with other people.  See
<a class="reference internal" href="curious_remotes.html"><em>git remotes - working with other people, making backups</em></a>;</li>
<li>tags – making static bookmarks to commits;</li>
</ul>
<p>You will probably also find use for:</p>
<ul class="simple">
<li><a class="reference external" href="http://www.kernel.org/pub/software/scm/git/docs/git-reflog.html">git reflog</a> –
show a list of previous commits that you have made;</li>
<li><a class="reference external" href="http://www.kernel.org/pub/software/scm/git/docs/git-rebase.html">git rebase</a> –
rewrite the development history by altering or transplanting commits.  See
<a class="reference internal" href="rebase_without_tears.html"><em>Rebase without tears</em></a>.</li>
</ul>
</div>
</div>
<div class="section" id="git-are-you-ready">
<h2>Git: are you ready?<a class="headerlink" href="#git-are-you-ready" title="Permalink to this headline">¶</a></h2>
<p>If you followed this tutorial, you now have a good knowledge of how git works.
This will make it much easier to understand why git commands do what they do,
and what to do when things go wrong.  You know all the main terms that the git
manual pages use, so git&#8217;s own help will be more useful to you.  You will
likely lead a long life of deep personal fulfillment.</p>
</div>
<div class="section" id="git-resources">
<h2>Git resources<a class="headerlink" href="#git-resources" title="Permalink to this headline">¶</a></h2>
<p>As you&#8217;ve seen, this tutorial makes the bold assumption that you&#8217;ll be able to
understand how git works by seeing how it is <em>built</em>. These documents take a
similar approach to varying levels of detail:</p>
<ul class="simple">
<li>This <a class="reference external" href="http://www.ralfebert.de/blog/tools/visual_git_tutorial_1">visual git tutorial</a> gives a nice
visual idea of git at work.</li>
<li><a class="reference external" href="http://www.sbf5.com/~cduan/technical/git">Understanding Git Conceptually</a> gives another review of how
the ideas behind git.</li>
<li>For more detail, see the start of the excellent <a class="reference external" href="http://progit.org/book">Pro Git</a> online book, or similarly the early parts of the
<a class="reference external" href="http://book.git-scm.com">Git community book</a>. Pro Git&#8217;s chapters are
very short and well illustrated; the community book tends to have more
detail and has nice screencasts at the end of some sections.</li>
<li>The <a class="reference external" href="http://tom.preston-werner.com/2009/05/19/the-git-parable.html">Git parable</a> by Tom
Preston-Werner.</li>
<li><a class="reference internal" href="foundation.html"><em>Git foundations</em></a></li>
</ul>
<p>You might also try:</p>
<ul class="simple">
<li>For windows users, <a class="reference external" href="http://nathanj.github.com/gitguide/tour.html">an Illustrated Guide to Git on Windows</a> is useful in that it
contains also some information about handling SSH (necessary to interface
with git hosted on remote servers when collaborating) as well as screenshots
of the Windows interface.</li>
<li><a class="reference external" href="http://www.gitready.com">Git ready</a> A great website of posts on specific
git-related topics, organized by difficulty.</li>
<li><a class="reference external" href="http://sourceforge.net/projects/qgit/">QGit</a>: an excellent Git GUI Git
ships by default with gitk and git-gui, a pair of Tk graphical clients to
browse a repo and to operate in it. I personally have found <a class="reference external" href="http://sourceforge.net/projects/qgit/">qgit</a> to be nicer and easier to use. It
is available on modern Linux distros, and since it is based on Qt, it should
run on OSX and Windows.</li>
<li><a class="reference external" href="http://www-cs-students.stanford.edu/~blynn/gitmagic/index.html">Git Magic</a> : Another
book-size guide that has useful snippets.</li>
<li>The <a class="reference external" href="http://learn.github.com">learning center</a> at Github Guides on a
number of topics, some specific to github hosting but much of it of general
value.</li>
<li>A <a class="reference external" href="http://cworth.org/hgbook-git/tour">port</a> of the Hg book&#8217;s beginning
The <a class="reference external" href="http://hgbook.red-bean.com">Mercurial book</a> has a reputation for
clarity, so Carl Worth decided to <a class="reference external" href="http://cworth.org/hgbook-git/tour">port</a> its introductory chapter to Git. It&#8217;s
a nicely written intro, which is possible in good measure because of how
similar the underlying models of Hg and Git ultimately are.</li>
<li><a class="reference external" href="http://andyjeffries.co.uk/articles/25-tips-for-intermediate-git-users">Intermediate tips</a>: A
set of tips that contains some very valuable nuggets, once you&#8217;re past the
basics.</li>
</ul>
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="list-figure" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td>Would I get the same hash for the directory listing if I had
had a different figure?  No – because the figure hash would be
different, the directory listing would contain this different hash, and so
the hash for the directory listing must be different.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="commit-figure" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td>Would the commit hash value change if the figure changed?
Yes, because the change in the figure would cause a different hash for the
figure; this would cause a different hash for the directory listing, and
this hash in turn appears in the commit contents, causing a different hash
for the commit.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="no-parents" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[3]</a></td><td>Why are the output of <code class="docutils literal"><span class="pre">git</span> <span class="pre">log</span></code> and <code class="docutils literal"><span class="pre">git</span> <span class="pre">log</span> <span class="pre">--parents</span></code>
the same in this case?  They are the same because this is the first commit,
and the first commit has no parents.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="git-object-dir" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[4]</a></td><td>When git stores a file in the <code class="docutils literal"><span class="pre">.git/objects</span></code> directory,
it makes a hash from the file, takes the first two digits of the hash to
make a directory name, and then stores a file in this directory with a
filename from the remaining hash digits.  For example, when adding a file
with hash <code class="docutils literal"><span class="pre">d92d079af6a7f276cc8d63dcf2549c03e7deb553</span></code> git will create
<code class="docutils literal"><span class="pre">.git/objects/d9</span></code> directory if it doesn&#8217;t exist, and stores the file
contents as <code class="docutils literal"><span class="pre">.git/objects/d9/2d079af6a7f276cc8d63dcf2549c03e7deb553</span></code>.  It
does this so that the number of files in any one directory stay in a
reasonable range.  If git had to store hash filenames for every object in
one flat directory, the directory would soon have a very large number of
files.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="tag-other-objects" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[5]</td><td>You might have guessed by now that a tag can refer to
any git object, not just a commit.  For example a tag can refer to a tree
(directory listing) or blob (file) object, although in practice tags almost
always refer to commits.</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">The curious coder&#8217;s guide to git</a><ul>
<li><a class="reference internal" href="#git-love-hate">git - love - hate</a><ul>
<li><a class="reference internal" href="#the-one-thing-about-git-you-really-need-to-understand">The one thing about git you really need to understand</a></li>
</ul>
</li>
<li><a class="reference internal" href="#a-familiar-story">A familiar story</a><ul>
<li><a class="reference internal" href="#the-story-so-far">The story so far...</a></li>
<li><a class="reference internal" href="#the-dog-ate-my-results">The dog ate my results</a></li>
<li><a class="reference internal" href="#deja-vu-all-over-again">Deja vu all over again</a></li>
<li><a class="reference internal" href="#gitwards-1-make-regular-snapshots">Gitwards 1: make regular snapshots</a></li>
<li><a class="reference internal" href="#gitwards-2-reminding-yourself-of-what-you-did">Gitwards 2: reminding yourself of what you did</a></li>
<li><a class="reference internal" href="#gitwards-3-breaking-up-work-into-chunks">Gitwards 3: breaking up work into chunks</a></li>
<li><a class="reference internal" href="#gitwards-4-getting-files-from-previous-commits">Gitwards 4: getting files from previous commits</a></li>
<li><a class="reference internal" href="#gitwards-5-two-people-working-at-the-same-time">Gitwards 5: two people working at the same time</a></li>
<li><a class="reference internal" href="#gitwards-6-how-should-you-name-your-commit-directories">Gitwards 6: how should you name your commit directories?</a></li>
<li><a class="reference internal" href="#a-diversion-on-cryptographic-hashes">A diversion on cryptographic hashes</a></li>
<li><a class="reference internal" href="#gitwards-7-naming-commits-from-hashes">Gitwards 7: naming commits from hashes</a></li>
<li><a class="reference internal" href="#gitwards-8-the-development-history-is-a-graph">Gitwards 8: the development history is a graph</a></li>
<li><a class="reference internal" href="#gitwards-9-saving-space-with-file-hashes">Gitwards 9: saving space with file hashes</a></li>
<li><a class="reference internal" href="#gitwards-10-making-the-commits-unique">Gitwards 10: making the commits unique</a></li>
<li><a class="reference internal" href="#gitwards-11-away-with-the-snapshot-directories">Gitwards 11: away with the snapshot directories</a></li>
<li><a class="reference internal" href="#gitwards-12-where-am-i">Gitwards 12: where am I?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#from-gitwards-to-gitworld">From gitwards to gitworld</a><ul>
<li><a class="reference internal" href="#basic-configuration">Basic configuration</a></li>
<li><a class="reference internal" href="#getting-help">Getting help</a></li>
<li><a class="reference internal" href="#initializing-the-repository-directory">Initializing the repository directory</a></li>
<li><a class="reference internal" href="#updating-terms-for-git">Updating terms for git</a></li>
<li><a class="reference internal" href="#git-add-put-stuff-into-the-staging-area">git add – put stuff into the staging area</a></li>
<li><a class="reference internal" href="#the-git-staging-area">The git staging area</a></li>
<li><a class="reference internal" href="#git-objects">Git objects</a></li>
<li><a class="reference internal" href="#hash-values-can-usually-be-abbreviated-to-seven-characters">Hash values can usually be abbreviated to seven characters</a></li>
<li><a class="reference internal" href="#git-status-showing-the-status-of-files-in-the-working-tree">git status – showing the status of files in the working tree</a></li>
<li><a class="reference internal" href="#staging-the-other-files-with-git-add">Staging the other files with git add</a></li>
<li><a class="reference internal" href="#git-commit-making-the-snapshot">git commit – making the snapshot</a></li>
<li><a class="reference internal" href="#git-log-what-are-the-commits-so-far">git log – what are the commits so far?</a></li>
<li><a class="reference internal" href="#git-branch-which-branch-are-we-on">git branch - which branch are we on?</a></li>
<li><a class="reference internal" href="#a-second-commit">A second commit</a></li>
<li><a class="reference internal" href="#git-diff-what-has-changed">git diff – what has changed?</a></li>
<li><a class="reference internal" href="#you-need-to-git-add-a-file-to-put-it-into-the-staging-area">You need to <code class="docutils literal"><span class="pre">git</span> <span class="pre">add</span></code> a file to put it into the staging area</a></li>
<li><a class="reference internal" href="#an-ordinary-day-in-gitworld">An ordinary day in gitworld</a></li>
<li><a class="reference internal" href="#commit-four">Commit four</a></li>
<li><a class="reference internal" href="#undoing-a-commit-with-git-reset">Undoing a commit with <code class="docutils literal"><span class="pre">git</span> <span class="pre">reset</span></code></a></li>
<li><a class="reference internal" href="#pointing-backwards-in-history">Pointing backwards in history</a></li>
<li><a class="reference internal" href="#a-new-fourth-commit">A new fourth commit</a></li>
<li><a class="reference internal" href="#the-fifth-commit">The fifth commit</a></li>
<li><a class="reference internal" href="#getting-a-file-from-a-previous-commit-git-checkout">Getting a file from a previous commit – <code class="docutils literal"><span class="pre">git</span> <span class="pre">checkout</span></code></a></li>
<li><a class="reference internal" href="#using-bookmarks-git-branch">Using bookmarks – <code class="docutils literal"><span class="pre">git</span> <span class="pre">branch</span></code></a></li>
<li><a class="reference internal" href="#changing-the-current-branch-with-git-checkout">Changing the current branch with <code class="docutils literal"><span class="pre">git</span> <span class="pre">checkout</span></code></a></li>
<li><a class="reference internal" href="#making-commits-on-branches">Making commits on branches</a></li>
<li><a class="reference internal" href="#merging-lines-of-development-with-git-merge">Merging lines of development with <code class="docutils literal"><span class="pre">git</span> <span class="pre">merge</span></code></a></li>
<li><a class="reference internal" href="#the-commit-parents-make-the-development-history-into-a-graph">The commit parents make the development history into a graph</a></li>
<li><a class="reference internal" href="#other-commands-you-need-to-know">Other commands you need to know</a></li>
</ul>
</li>
<li><a class="reference internal" href="#git-are-you-ready">Git: are you ready?</a></li>
<li><a class="reference internal" href="#git-resources">Git resources</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="git.html"
                        title="previous chapter">Notes and tutorials on git</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="curious_remotes.html"
                        title="next chapter">git remotes - working with other people, making backups</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/curious_git.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="curious_remotes.html" title="git remotes - working with other people, making backups"
             >next</a> |</li>
        <li class="right" >
          <a href="git.html" title="Notes and tutorials on git"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pydagogue 0.2 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="git.html" >Notes and tutorials on git</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2009-2016 - Matthew Brett.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>